[{"categories":["AI"],"content":" Gott ist totâ€¦ Wir mÃ¼ssen selbst zu GÃ¶ttern werden. ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:0:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"Intro æˆ‘ä»¬åœ¨é¢„è®­ç»ƒåï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ“…é•¿ç»­å†™çš„ AIã€‚ä½†æ˜¯å…‰æ˜¯ç»­å†™å¹¶ä¸æ˜¯ååˆ†æœ‰ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è´¹å°½æ€ prompt æ‰èƒ½å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚ä¸ºäº†æ›´å¥½çš„åº”å¯¹ä¸‹æ¸¸ä»»åŠ¡ï¼Œå¦‚ QA Chatbotï¼Œæ€»ç»“ï¼Œæ¨ç†ç­‰ï¼Œéœ€è¦åšä¸€äº›é€‚é…ã€‚ ä¸‹æ¸¸ä»»åŠ¡å¾€å¾€éœ€è¦æ¨¡å‹æœ‰ç‰¹å®šçš„å›ç­”æ¨¡å¼ï¼Œä¸»é¢˜æˆ–è€…æ˜¯æ–°çš„çŸ¥è¯†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¸å¤šæŠ€æœ¯æ¥é€‚é…ã€‚ SFT (Supervised Fine-Tuning) ï¼šé€šè¿‡åœ¨æ•°åƒæ¡â€œæç¤º-å›ç­”â€å¯¹ä¸Šç»§ç»­è®­ç»ƒï¼Œä»¥å¡‘é€ æ¨¡å‹é£æ ¼ã€æå‡æŒ‡ä»¤éµå¾ªèƒ½åŠ›å’Œè§£å†³å®‰å…¨æ€§çš„ç»å…¸æ–¹æ³•ï¼Œå°¤å…¶é€‚åˆé£æ ¼æ§åˆ¶ã€‚æ¯”è¾ƒéš¾æ³¨å…¥æ–°çŸ¥è¯†ã€‚ç›®å‰ä¹Ÿæœ‰ LoRA ç­‰æŠ€æœ¯å®ç°ä½æˆæœ¬å¾®è°ƒã€‚ RLHF (Reinforcement Learning from Human Feedback)ï¼šå› ä¸ºäººç±»åå¥½çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬å¾ˆéš¾æœ‰å®Œå–„çš„é¢„è®­ç»ƒæ•°æ®ã€‚ä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå³ä½¿æˆ‘ä»¬ä¸çŸ¥é“æ€ä¹ˆå›ç­”ï¼Œä¹Ÿå¾ˆå®¹æ˜“åˆ¤æ–­ä»€ä¹ˆæ˜¯å¥½çš„å›ç­”ã€‚å› æ­¤å°±æœ‰äº† RLHFï¼Œé€šè¿‡è®­ç»ƒä¸€ä¸ªå¥–åŠ±æ¨¡å‹æ¥å­¦ä¹ äººç±»å¯¹å›ç­”çš„åå¥½ï¼Œå†åˆ©ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆå¦‚PPOï¼‰ä¼˜åŒ–è¯­è¨€æ¨¡å‹ï¼Œä½¿å…¶ç”Ÿæˆæ›´ç¬¦åˆäººç±»æœŸæœ›ã€æ›´æµç•…ä¸”å®‰å…¨çš„è¾“å‡ºã€‚ Promptï¼šè™½ç„¶ç®€å•æœ‰æ•ˆï¼Œä½†å…¶æ•ˆæœé«˜åº¦ä¾èµ–è®¾è®¡æŠ€å·§ä¸”å¯¹å¤æ‚ä»»åŠ¡æœ‰å¤©èŠ±æ¿ã€‚ RAGï¼šé€šè¿‡ä»å¤–éƒ¨æ•°æ®åº“æŸ¥æ‰¾èµ„æ–™ï¼Œæ’å…¥ prompt ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œæœ‰æ•ˆè§£å†³äº†æ¨¡å‹çŸ¥è¯†é™ˆæ—§å’Œäº‹å®æ€§ä¸è¶³çš„é—®é¢˜ï¼Œé™ä½å¹»è§‰ã€å¢å¼ºä¸“ä¸šæ€§çš„ç»æµé«˜æ•ˆæ‰‹æ®µï¼Œå…¶æ ¸å¿ƒåœ¨äºé«˜è´¨é‡çŸ¥è¯†åº“ä¸ç²¾å‡†æ£€ç´¢ã€‚ åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨æœ‰ä¸€å¼  4090D çš„æœåŠ¡å™¨ä¸Šï¼Œä»¥ Qwen2.5-7B ä¸ºåŸºç¡€æ¨¡å‹ï¼Œå¯¹å…¶è¿›è¡Œå¾®è°ƒï¼Œå¹¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦ä¹ ç›¸å…³çŸ¥è¯†ã€‚ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:1:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"Evaluation åœ¨è¿›è¡Œä»»ä½•å¾®è°ƒä¹‹å‰ï¼Œå»ºç«‹ä¸€ä¸ªå¥å…¨çš„è¯„ä¼°æ¡†æ¶è‡³å…³é‡è¦ã€‚å¦‚æœæ²¡æœ‰è¯„ä¼°æ ‡å‡†ï¼Œæˆ‘ä»¬å°±æ— æ³•è¡¡é‡å¾®è°ƒçš„æ•ˆæœï¼Œä¹Ÿæ— æ³•åˆ¤æ–­æ¨¡å‹æ˜¯å¦åœ¨æœç€æœŸæœ›çš„æ–¹å‘æ”¹è¿›ã€‚åœ¨ä¸€èˆ¬çš„æ·±åº¦å­¦ä¹ ä»»åŠ¡ä¸­ï¼Œäº¤å‰ç†µé€šå¸¸ä½œä¸ºä¸»è¦çš„è¡¡é‡æ ‡å‡†ï¼Œä½†å¯¹äºè¯­è¨€æ¨¡å‹çš„æŸäº›èƒ½åŠ›ï¼ˆå¦‚ç»“æ„åŒ–è¾“å‡ºï¼‰ï¼Œå•çº¯ä½¿ç”¨äº¤å‰ç†µå¹¶ä¸åˆé€‚ã€‚è¯„ä¼°æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡ç‰¹å®šçš„ prompt è®©æ¨¡å‹ç”Ÿæˆè§„å®šæ ¼å¼çš„ç­”æ¡ˆï¼Œç„¶åé€šè¿‡æ–‡æœ¬è§£ææˆ–å…¶ä»–æ¨¡å‹æ¥è¯„ä»·è¿™äº›ç­”æ¡ˆçš„è´¨é‡ã€‚ åœ¨è¿›è¡Œè¯„ä¼°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©åˆé€‚çš„æ¨ç†æœåŠ¡æ¥è¿è¡Œæ¨¡å‹ã€‚ç›®å‰ä¸»æµçš„é€‰æ‹©åŒ…æ‹¬ï¼š vllmï¼šæœ€é«˜æ€§èƒ½çš„æ¨ç†æœåŠ¡ ollamaï¼šä¸“æ³¨äºä¸€é”®å¼éƒ¨ç½²ï¼Œå¯è‡ªåŠ¨åœ¨ CPU å’Œ GPU é—´å¹³è¡¡è®¡ç®— Hugging Face Transformersï¼šæä¾›æ ‡å‡†åŒ–çš„è®­ç»ƒå’Œå¾®è°ƒæ¥å£ï¼Œä½†ä¸ä¸“æ³¨äºæ¨ç†æ€§èƒ½ è€ƒè™‘åˆ°æˆ‘ä»¬çš„ 4090D åªæœ‰ 24GB æ˜¾å­˜ï¼Œåœ¨ 4096 åºåˆ—é•¿åº¦ä¸‹ä»…èƒ½å‹‰å¼ºå®¹çº³ 7B å‚æ•°æ¨¡å‹åŠå…¶ KV cacheï¼Œè€Œå¯¹äºæ›´å¤§çš„æ¨¡å‹ï¼ˆå¦‚ 32Bï¼‰åˆ™æ˜¾å­˜ä¸è¶³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ vllm ä½œä¸ºåŸºç¡€æ¨¡å‹çš„æ¨ç†æœåŠ¡ã€‚ è¯„ä¼°è¯­è¨€æ¨¡å‹é€šå¸¸æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š é¦–å…ˆæ˜¯é€šç”¨èƒ½åŠ›è¯„ä¼°ï¼Œæˆ‘ä»¬ä½¿ç”¨ MMLU (Massive Multitask Language Understanding) æ•°æ®é›†æ¥æµ‹è¯•æ¨¡å‹çš„äº‹å®æ€§çŸ¥è¯†æŒæ¡ç¨‹åº¦ã€‚è¯¥æ•°æ®é›†åŒ…å«å¤šä¸ªé¢†åŸŸçš„é€‰æ‹©é¢˜ï¼Œæ¯é¢˜æä¾› Aã€Bã€Cã€D å››ä¸ªé€‰é¡¹ã€‚æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹ç»Ÿä¸€æ ¼å¼çš„ prompt æ¥è·å–æ¨¡å‹å›ç­”ï¼š Answer the following multiple choice question about {subject}. Respond with a single sentence of the form \"The correct answer is _\", filling the blank with the letter corresponding to the correct answer (i.e., A, B, C or D). Question: {question} A. {options[0]} B. {options[1]} C. {options[2]} D. {options[3]} Answer: é€šè¿‡è§£ææ¨¡å‹è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ­£ç¡®ç‡ã€‚åœ¨æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬çš„ Qwen2.5-7B åœ¨ MMLU ä¸Šè·å¾—äº† 68.64% çš„å‡†ç¡®ç‡ã€‚ å…¶æ¬¡æ˜¯æ¨ç†èƒ½åŠ›è¯„ä¼°ï¼Œæˆ‘ä»¬é‡‡ç”¨ GSM8K æ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†åŒ…å«ä¸€ç³»åˆ—éœ€è¦å¤šæ­¥æ¨ç†çš„æ•°å­¦é—®é¢˜ï¼Œè¦æ±‚æ¨¡å‹ç»™å‡ºå…·ä½“çš„æ•°å­—ç­”æ¡ˆã€‚ä½¿ç”¨ç±»ä¼¼çš„è¯„ä¼°æ–¹æ³•ï¼Œæˆ‘ä»¬çš„ Qwen2.5-7B åœ¨ GSM8K ä¸Šçš„å¾—åˆ†ä¸º 22.52%ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸“é—¨è¯„ä¼°å¯¹è¯è´¨é‡çš„ AlpacaEval æ•°æ®é›†ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªå¼ºå¤§çš„è¯„ä¼°æ¨¡å‹æ¥å¯¹æ¯”è¢«æµ‹æ¨¡å‹ä¸å‚è€ƒæ¨¡å‹ï¼ˆé€šå¸¸æ˜¯ GPT-4 Turboï¼‰çš„è¡¨ç°ã€‚è¯„ä¼°ç»“æœç”¨è¢«æµ‹æ¨¡å‹ç›¸å¯¹äºå‚è€ƒæ¨¡å‹çš„èƒœç‡æ¥è¡¨ç¤ºã€‚ æœ€åï¼ŒSimpleSafetyTests ç”¨äºè¯„ä¼°æ¨¡å‹è¾“å‡ºçš„å®‰å…¨æ€§ï¼Œä½†åŒæ ·éœ€è¦ä¸€ä¸ªè¾ƒå¼ºçš„è¯„ä¼°æ¨¡å‹æ¥åˆ¤æ–­è¾“å‡ºæ˜¯å¦å®‰å…¨ã€‚ å—é™äºæˆ‘ä»¬ 4090D çš„è®¡ç®—èƒ½åŠ›ï¼Œä»¥åŠæˆæœ¬è€ƒè™‘ï¼Œæˆ‘ä»¬åªèƒ½è¿›è¡Œ MMLU å’Œ GSM8K è¿™ä¸¤é¡¹åŸºç¡€æµ‹è¯•æ¥è¯„ä¼°æ¨¡å‹çš„é€šç”¨èƒ½åŠ›å’Œæ¨ç†èƒ½åŠ›ã€‚ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:2:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"Supervised Fine Tune å¦‚å‰æ‰€è¿°ï¼ŒSFT æ˜¯é€šè¿‡åœ¨â€œæç¤º-å›ç­”â€å¯¹çš„æ•°æ®é›†ä¸Šç»§ç»­è®­ç»ƒé¢„è®­ç»ƒæ¨¡å‹æ¥é€‚é…ä¸‹æ¸¸ä»»åŠ¡çš„å¸¸ç”¨æ–¹æ³•ã€‚è¿™ä¸ªè¿‡ç¨‹ç›¸å¯¹ç›´æ¥ï¼Œç›®æ ‡æ˜¯è®©æ¨¡å‹å­¦ä¹ åˆ°åœ¨ç»™å®šç‰¹å®šç±»å‹çš„æç¤ºæ—¶ï¼Œç”Ÿæˆç‰¹å®šæ ¼å¼æˆ–å†…å®¹çš„å›ç­”ã€‚èƒ½å¤Ÿæ˜¾è‘—æå‡æ¨¡å‹ç†è§£å’Œæ‰§è¡ŒæŒ‡ä»¤çš„èƒ½åŠ›ã€‚ä¸è¿‡å®ƒå¾ˆéš¾å‘æ¨¡å‹æ³¨å…¥æ–°çš„äº‹å®æ€§çŸ¥è¯†ï¼Œæˆ–è€…çº æ­£é¢„è®­ç»ƒé˜¶æ®µå­¦åˆ°çš„é”™è¯¯çŸ¥è¯†ï¼Œè€Œä¸”æ¨¡å‹å¯èƒ½å­¦ä¼šäº†æ¨¡ä»¿æœŸæœ›çš„è¾“å‡ºæ ¼å¼ï¼Œä½†å¹¶æ²¡æœ‰çœŸæ­£ç†è§£ä»»åŠ¡çš„æœ¬è´¨ã€‚æœ€åï¼Œæ•°æ®éå¸¸é‡è¦ï¼Œgarbage inï¼Œgarbage outã€‚ SFT çš„æ•ˆæœåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ•°æ®çš„è´¨é‡å’Œæ•°é‡ã€‚æ•°æ®æ¥æºå¯ä»¥å¤šç§å¤šæ ·ï¼ŒåŒ…æ‹¬äººå·¥æ ‡æ³¨çš„æ•°æ®ã€å¼€æºæŒ‡ä»¤æ•°æ®é›†ï¼ˆå¦‚ Alpaca, Dolly, OpenOrca ç­‰ï¼‰ã€ç”¨æˆ·åé¦ˆæ•°æ®ç­‰ã€‚æ•°æ®é€šå¸¸éœ€è¦å¤„ç†æˆç»Ÿä¸€çš„â€œæç¤º-å›ç­”â€æ ¼å¼ã€‚ä¾‹å¦‚ï¼š { \"instruction\": \"è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é»‘æ´ã€‚\", \"output\": \"é»‘æ´æ˜¯æ—¶ç©ºå±•ç°å‡ºæç«¯å¼ºå¤§çš„å¼•åŠ›ï¼Œä»¥è‡³äºä»»ä½•å½¢å¼çš„ç‰©è´¨å’Œè¾å°„éƒ½æ— æ³•ä»ä¸­é€ƒé€¸çš„åŒºåŸŸã€‚\" } æˆ–è€…å¯¹äºå¯¹è¯æ ¼å¼ï¼š { \"messages\": [ {\"role\": \"user\", \"content\": \"ä½ å¥½ï¼Œä½ æ˜¯è°ï¼Ÿ\"}, {\"role\": \"assistant\", \"content\": \"æˆ‘æ˜¯ä¸€ä¸ªå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œç”± Llama å›¢é˜Ÿè®­ç»ƒã€‚\"} ] } æœ€ç»å…¸çš„æ–¹æ³•æ˜¯å…¨å‚æ•°å¾®è°ƒï¼Œå³æ›´æ–°æ¨¡å‹çš„æ‰€æœ‰å‚æ•°ã€‚è™½ç„¶æ•ˆæœé€šå¸¸æœ€å¥½ï¼Œä½†è®¡ç®—èµ„æºæ¶ˆè€—å¤§ï¼Œè®­ç»ƒæ—¶é—´é•¿ã€‚ä½œä¸ºæ›¿ä»£ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå‚æ•°é«˜æ•ˆå¾®è°ƒ (Parameter-Efficient Fine-Tuning - PEFT)ï¼Œåªæ›´æ–°æ¨¡å‹çš„ä¸€å°éƒ¨åˆ†å‚æ•°ï¼Œæˆ–è€…å¼•å…¥å°‘é‡é¢å¤–çš„å¯è®­ç»ƒå‚æ•°ã€‚ å¸¸è§çš„ PEFT æ–¹æ³•åŒ…æ‹¬ï¼š LoRA (Low-Rank Adaptation)ï¼šé€šè¿‡åœ¨æ¨¡å‹çš„æŸäº›å±‚ï¼ˆé€šå¸¸æ˜¯æ³¨æ„åŠ›å±‚ï¼‰æ³¨å…¥ä½ç§©é€‚é…å™¨çŸ©é˜µæ¥è¿›è¡Œå¾®è°ƒã€‚å®ƒèƒ½ä»¥æå°‘çš„é¢å¤–å‚æ•°ï¼ˆé€šå¸¸ä¸åˆ°åŸæ¨¡å‹å‚æ•°çš„1%ï¼‰è¾¾åˆ°æ¥è¿‘å…¨å‚æ•°å¾®è°ƒçš„æ•ˆæœï¼Œå¤§å¤§é™ä½äº†å¾®è°ƒçš„æˆæœ¬å’Œå­˜å‚¨éœ€æ±‚ã€‚ QLoRAï¼šæ˜¯ LoRA çš„è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œç»“åˆäº†é‡åŒ–æŠ€æœ¯ï¼Œä½¿å¾—åœ¨æ›´å°çš„ç¡¬ä»¶ä¸Šå¾®è°ƒæ›´å¤§çš„æ¨¡å‹æˆä¸ºå¯èƒ½ å…¶ä»–æ–¹æ³•ï¼šå¦‚ Adapter Tuningã€Prefix Tuningã€Prompt Tuning ç­‰ åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œå…ˆå°è¯•ä½¿ç”¨ç»å…¸çš„å…¨å‚æ•°å¾®è°ƒã€‚ä½¿ç”¨ transformers æ¡†æ¶ï¼Œå¾®è°ƒçš„ä»£ç éå¸¸ç®€å•ï¼š def main(): config = parse_args() if config.use_wandb: wandb.init(project=\"qwen-finetuning\") # Initialize model and tokenizer tokenizer = AutoTokenizer.from_pretrained(config.model_name, trust_remote_code=True) model = AutoModelForCausalLM.from_pretrained(config.model_name, trust_remote_code=True) # Create dataset train_dataset = CustomDataset(config.train_file, tokenizer, config.max_length) # Training arguments training_args = TrainingArguments( output_dir=config.output_dir, num_train_epochs=config.num_epochs, per_device_train_batch_size=config.batch_size, gradient_accumulation_steps=config.gradient_accumulation_steps, learning_rate=config.learning_rate, weight_decay=config.weight_decay, warmup_steps=config.warmup_steps, logging_steps=config.logging_steps, save_steps=config.save_steps, eval_steps=config.eval_steps, logging_dir=\"./logs\", fp16=True, report_to=\"wandb\" if config.use_wandb else None, ) # Initialize trainer trainer = Trainer( model=model, args=training_args, train_dataset=train_dataset, ) # Start training trainer.train() ä½†æ˜¯å¾ˆå¿«ï¼Œæ˜¾å­˜ä¸å¤Ÿï¼Œè®­ç»ƒè¢«è¿«ä¸­æ­¢äº†â€¦ ğŸ˜¢ é‚£ä¹ˆè®©æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å¾®è°ƒåˆ°åº•éœ€è¦å¤šå°‘æ˜¾å­˜ã€‚ç»“åˆ Building a Transformer LM ä¸ Optimize the Performance of a LM ä¸­çš„ä¼°ç®—å’Œæµ‹é‡ï¼Œæˆ‘ä»¬çŸ¥é“ 20M å‚æ•°åœ¨ FP32 ç²¾åº¦ä¸‹è®­ç»ƒæ—¶ï¼ŒåŒ…æ‹¬ä¼˜åŒ–å™¨çŠ¶æ€å’Œæ¿€æ´»å€¼åœ¨å†…ï¼Œå³°å€¼æ˜¾å­˜çº¦ä¸º 2GBã€‚ç”±äºæ˜¾å­˜å ç”¨å’Œå‚æ•°é‡æˆæ­£æ¯”ï¼Œ7B å‚æ•°çš„æ¨¡å‹ç†è®ºä¸Šéœ€è¦çº¦ 700GB æ˜¾å­˜ï¼ ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ä¼˜åŒ–æ–¹æ³•æ¥é™ä½æ˜¾å­˜éœ€æ±‚ï¼š æ··åˆç²¾åº¦è®­ç»ƒï¼šå¯ä»¥å°†æ˜¾å­˜éœ€æ±‚å‡åŠè‡³ 400GB Gradient Checkpointingï¼šé€šè¿‡é‡è®¡ç®—ä¸­é—´æ¿€æ´»å€¼ï¼Œå¯ä»¥èŠ‚çœçº¦ 70% çš„æ¿€æ´»å€¼æ˜¾å­˜ï¼ˆä»¥ 30% çš„è®¡ç®—æ—¶é—´å¼€é”€ä¸ºä»£ä»·ï¼‰ Gradient Accumulationï¼šé€šè¿‡å‡å°‘æ¯æ¬¡è®¡ç®—çš„ batch size æ¥é™ä½æ˜¾å­˜ä½¿ç”¨ å³ä¾¿é‡‡ç”¨è¿™äº›ä¼˜åŒ–ï¼Œä¼°è®¡ä¹Ÿéœ€è¦è‡³å°‘ 80GB æ˜¾å­˜ï¼Œæˆ–è€…ä½¿ç”¨ DeepSpeed ç­‰åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶å°†å‚æ•°ã€æ¿€æ´»å€¼å’Œä¼˜åŒ–å™¨çŠ¶æ€åˆ†æ•£åˆ°å¤šä¸ª GPU ä¸Šã€‚ä½†æˆ‘ä»¬åªæœ‰ä¸€å— 24GB æ˜¾å­˜çš„ 4090Dï¼Œä¼¼ä¹åªèƒ½å°è¯• 1.5B è§„æ¨¡çš„å°æ¨¡å‹äº†ã€‚ ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€æ‹› â€”â€” PEFTã€‚ä½¿ç”¨ QLoRA æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¸ç›´æ¥è°ƒæ•´åŸå§‹å‚æ•°ï¼Œè€Œæ˜¯åœ¨ç‰¹å®šå±‚æ—å¢åŠ å¹¶è°ƒèŠ‚æ–°çš„å‚æ•°ï¼ˆçº¦åŸå‚æ•°é‡çš„1%ï¼‰ï¼Œå†é…åˆ 4bit é‡åŒ–ç­‰æŠ€æœ¯ï¼Œ24GB æ˜¾å­˜å°±è¶³å¤Ÿäº†ï¼š def main(): config = parse_args() if config.use_wandb: wandb.init(project=\"qwen-finetuning\") # Configure quantization bnb_config = BitsAndBytesConfig( load_in_4bit=True, bnb_4bit_use_double_quant=True, bnb_4bit_quant_type=\"nf4\", bnb_4bit_compute_dtype=torch.bfloat16 ) # Initialize model with quantization model = AutoModelForCausalLM.from_pretrained( config.model_name, quantization_config=bnb_config, trust_remote_code=True, device_map=\"auto\" ) # Prepare model for k-bit training model = prepare_model_for_kbit_training(model) # LoRA configuration lora_config = LoraConfig( r=8, lora_alpha=32, target_modules=[\"q_proj\", \"k_proj\", \"v_proj\", \"o_proj\"], lora_dropout=0.05, bias=\"none\", task_type=\"CAUSAL_LM\" ) # Apply LoRA model = get_peft_model(model, lora_config) # Initialize tokenizer tokenizer = AutoTokenizer.from_pretrained(config.model_name, trust_remote_code=True) ... trainer.train() æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ wandbï¼ˆWeights \u0026 Biasesï¼‰æ¥ç›‘æ§è®­ç»ƒè¿‡ç¨‹ã€‚ ä½†å³ä¾¿ä½¿ç”¨äº† QLoRAï¼Œè®­ç»ƒé€Ÿåº¦ä¾ç„¶éå¸¸æ…¢ï¼ è®©æˆ‘ä»¬ä¼°ç®—ä¸€ä¸‹è®­ç»ƒæ—¶é—´ï¼šæ¯æ¡æ•°æ®å¹³å‡ 512 ä¸ª tokenï¼Œå…± 39438 æ¡å¾®è°ƒæ•°æ®ï¼Œ3 ä¸ª epochï¼Œæ€» token æ•°çº¦ä¸º 39438 * 256 * 3 â‰ˆ 30M tokensã€‚å³ä½¿æŒ‰ç…§ vllm æ¨ç†çš„é€Ÿåº¦ï¼ˆçº¦ 1000 tokens/sï¼‰æ¥ç®—ï¼Œä¹Ÿéœ€è¦å¤§çº¦ 8 å°æ—¶æ‰èƒ½å®Œæˆè®­ç»ƒã€‚ æ‰€ä»¥â€¦ä¹Ÿè®¸çŸ¥é“ç†è®ºä¸Šå¯è¡Œå°±å¥½äº†å§ï½ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:3:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"RLHF åœ¨ SFT ä¸­ï¼Œæˆ‘ä»¬è®­ç»ƒæ¨¡å‹æ¨¡ä»¿ä¸€ç»„é«˜è´¨é‡æ ·æœ¬ä¸­çš„å›ç­”ã€‚ç„¶è€Œï¼Œè¿™å¾€å¾€ä¸è¶³ä»¥æ¶ˆé™¤é¢„è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡å‹å­¦åˆ°çš„ä¸è‰¯è¡Œä¸ºã€‚ä¸ SFT ä¾èµ–å¤–éƒ¨ä¼˜è´¨æ ·æœ¬ä¸åŒï¼Œä¸ºäº†æ›´å¥½åœ°å¯¹é½è¯­è¨€æ¨¡å‹ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä»å¾…æ”¹è¿›çš„æ¨¡å‹æœ¬èº«è·å–å›ç­”ï¼Œå¹¶æ ¹æ®è¿™äº›å›ç­”çš„è´¨é‡å’Œé€‚å½“æ€§æ¥è¿›è¡Œå¥–åŠ±æˆ–æƒ©ç½šã€‚ RLHFï¼ˆåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼‰æ˜¯ä¸€ç§é€šè¿‡äººç±»åé¦ˆæ¥ä¼˜åŒ–è¯­è¨€æ¨¡å‹çš„æ–¹æ³•ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå³ä½¿æˆ‘ä»¬éš¾ä»¥ç›´æ¥ç»™å‡ºå®Œç¾çš„å›ç­”ç¤ºä¾‹ï¼Œä½†æˆ‘ä»¬é€šå¸¸èƒ½å¤Ÿåˆ¤æ–­å“ªä¸ªå›ç­”æ›´å¥½ã€‚ æœ€åˆçš„ RLHF å®ç°é‡‡ç”¨ PPO ç®—æ³•ï¼Œä½†ç›®å‰æ›´å¤šåœ°ä½¿ç”¨ DPO ç®—æ³•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç®€è¦ä»‹ç»å¼ºåŒ–å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶åœ¨æœ€åæ·±å…¥ç†è§£ DPO ç®—æ³•çš„åŸç†ï¼Œç„¶åè¿›è¡Œå®è·µæ“ä½œã€‚ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:4:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"RL Theory https://hrl.boyuai.com/chapter/intro https://spinningup.openai.com/en/latest/user/introduction.html å¦‚ä½•ç†è§£ policyï¼š https://zhuanlan.zhihu.com/p/268100059 https://awjuliani.github.io/web-rl-playground/ ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹  å¤šè‡‚è€è™æœº exploration vs. exploitation é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ key concepts MRP æ˜¯æœ‰è§£æè§£çš„ï¼ˆä½†æ±‚è§£æ—¶é—´å¤æ‚åº¦ä¸ºä¸‰æ¬¡æ–¹ï¼‰ åŒæ—¶ç»™ä¸€ä¸ª MDP å’Œä¸€ä¸ª Policyï¼Œå°±èƒ½è½¬åŒ–ä¸ºä¸€ä¸ª MRP å…¶ä»–æ±‚è§£ä»·å€¼å‡½æ•°çš„æ–¹æ³• è’™ç‰¹å¡ç½— åŠ¨æ€è§„åˆ’ åœ¨ç¡®å®š MDP æ—¶ï¼Œå ç”¨åº¦é‡å’Œç­–ç•¥ä¸€ä¸€å¯¹åº” æœ€ä¼˜ç­–ç•¥å­˜åœ¨ åŠ¨æ€è§„åˆ’ç®—æ³• ç­–ç•¥è¿­ä»£ ç­–ç•¥è¿­ä»£ä¸­çš„ç­–ç•¥è¯„ä¼°ä½¿ç”¨è´å°”æ›¼æœŸæœ›æ–¹ç¨‹æ¥å¾—åˆ°ä¸€ä¸ªç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠ¨æ€è§„åˆ’çš„è¿‡ç¨‹ é¦–å…ˆç­–ç•¥è¯„ä¼°ï¼Œè¿­ä»£è´å°”æ›¼æœŸæœ›æ–¹ç¨‹ç›´åˆ°ä¸åŠ¨ç‚¹ï¼ˆå¯è¯æ˜ï¼‰ ç­–ç•¥æå‡ï¼šè´ªå¿ƒåº”ç”¨ç­–ç•¥æç¤ºå®šç† ä»·å€¼è¿­ä»£ è€Œä»·å€¼è¿­ä»£ç›´æ¥ä½¿ç”¨è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹æ¥è¿›è¡ŒåŠ¨æ€è§„åˆ’ï¼Œå¾—åˆ°æœ€ç»ˆçš„æœ€ä¼˜çŠ¶æ€ä»·å€¼ã€‚ ä¸€ç§ç­–ç•¥è¯„ä¼°åªè¿›è¡Œäº†ä¸€è½®æ›´æ–°çš„ç­–ç•¥è¿­ä»£ç®—æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»·å€¼è¿­ä»£ä¸­ä¸å­˜åœ¨æ˜¾å¼çš„ç­–ç•¥ åŠ¨æ€è§„åˆ’çš„è¿™ä¸¤ç§å¼ºåŒ–å­¦ä¹ ç®—æ³•è¦æ±‚äº‹å…ˆçŸ¥é“ç¯å¢ƒçš„çŠ¶æ€è½¬ç§»å‡½æ•°å’Œå¥–åŠ±å‡½æ•°ã€‚å¦å¤–ï¼Œç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£é€šå¸¸åªé€‚ç”¨äºæœ‰é™é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œå³çŠ¶æ€ç©ºé—´å’ŒåŠ¨ä½œç©ºé—´æ˜¯ç¦»æ•£ä¸”æœ‰é™çš„ã€‚ æ—¶è®¸å·®åˆ†å’Œè’™ç‰¹å¡ç½—ç®—æ³• æ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸­çš„ä¸¤å¤§ç»å…¸ç®—æ³•ï¼šSarsa å’Œ Q-learningï¼Œå®ƒä»¬éƒ½æ˜¯åŸºäºæ—¶åºå·®åˆ†ï¼ˆtemporal differenceï¼ŒTDï¼‰çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚ Sarsa = æ—¶åºå·®åˆ† + ç­–ç•¥è¿­ä»£ -ã€‹åœ¨çº¿ç®—æ³• Q-Learning = æ—¶åºå·®åˆ† + ä»·å€¼è¿­ä»£ -ã€‹ç¦»çº¿ç®—æ³•ï¼ˆå’Œç¦»çº¿å¼ºåŒ–å­¦ä¹ ä¸åŒï¼‰ Dyna-Q ç®—æ³•ï¼šé€šè¿‡é‡‡æ ·ä¼°è®¡æ¨¡å‹ DQN åŸºäºç­–ç•¥çš„ç®—æ³•ï¼šç­–ç•¥å‚æ•°åŒ– REINFORCEç®—æ³•ï¼šè’™ç‰¹å¡ç½—ä¼°è®¡ Actor-Critic ç®—æ³•ï¼šä¹Ÿå­¦ä¹ å€¼å‡½æ•°ï¼Œä½†ç›®çš„æ˜¯ä¸ºäº†è¾…åŠ©ç­–ç•¥æ›´æ–° TPROç®—æ³•ï¼šä¿è¯ç­–ç•¥å­¦ä¹ çš„æ€§èƒ½å•è°ƒæ€§ PPO åŸºäº TRPO çš„æ€æƒ³ï¼Œä½†æ˜¯å…¶ç®—æ³•å®ç°æ›´åŠ ç®€å•ã€‚ PPO (Proximal Policy Optimization) æ˜¯ RLHF ä¸­æœ€å¸¸ç”¨çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚å®ƒé€šè¿‡é™åˆ¶ç­–ç•¥æ›´æ–°çš„å¹…åº¦æ¥ä¿è¯è®­ç»ƒçš„ç¨³å®šæ€§ï¼Œå¹¶é€šè¿‡å¼•å…¥ä»·å€¼å‡½æ•°æ¥å‡å°‘æ¢¯åº¦çš„æ–¹å·®ã€‚ç„¶è€Œï¼ŒPPO çš„å®ç°ç›¸å¯¹å¤æ‚ï¼Œæ¶‰åŠåˆ°å¤šä¸ªç»„ä»¶ï¼ˆActor, Critic, Reward Modelï¼‰çš„è®­ç»ƒå’Œåè°ƒï¼Œå¹¶ä¸”å¯¹è¶…å‚æ•°æ•æ„Ÿã€‚ è¿‘å¹´æ¥ï¼Œç ”ç©¶è€…ä»¬å¼€å§‹æ¢ç´¢æ›´ç®€å•ã€æ›´ç›´æ¥çš„å¯¹é½æ–¹æ³•ã€‚DPO (Direct Preference Optimization) å°±æ˜¯å…¶ä¸­ä¸€ç§å¤‡å—å…³æ³¨çš„æ–¹æ³•ã€‚ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:4:1","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"DPO in Action ä»£ç å®ç°ä»¥åŠ ","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:4:2","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":"Result","date":"2025-05-15","objectID":"/posts/adaptation-in-action/:5:0","tags":["LLM","RL"],"title":"Adaptation in Action (and RL Basic)","uri":"/posts/adaptation-in-action/"},{"categories":["AI"],"content":" Time is money. ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:0:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Intro åœ¨ Building a Transformer LM ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Pytorch æä¾›çš„åŸºç¡€ API å®ç°äº†ä¸€ä¸ªè¯­è¨€æ¨¡å‹ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬è¦ç©¿é€ Pytorch æä¾›çš„æŠ½è±¡å±‚ï¼Œçœ‹çœ‹è¯­è¨€æ¨¡å‹ç©¶ç«Ÿæ˜¯å¦‚ä½•è¿è¡Œåœ¨ç¡¬ä»¶ä¸Šçš„ï¼Œæˆ‘ä»¬åˆèƒ½é’ˆå¯¹ç¡¬ä»¶åšäº›ä»€ä¹ˆä¼˜åŒ–ã€‚åœ¨æœ€åï¼Œæˆ‘ä»¬è¿˜ä¼šç®€å•çš„ä»‹ç» scaling lawï¼Œä»¥åŠæ¨ç†å’Œéƒ¨ç½²æœåŠ¡é—®é¢˜ã€‚ ä¸»è¦å‚è€ƒèµ„æ–™ï¼š https://stanford-cs336.github.io/spring2024/ https://dlsyscourse.org/ https://hao-ai-lab.github.io/cse234-w25/ https://www.cs.cmu.edu/~15418/ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:1:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Pytorch internel åœ¨å®ç°è¯­è¨€æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨åˆ°çš„ Pytorch API ä¸»è¦æœ‰ä¸‰ç±»ï¼š åŸºæœ¬çš„ Tensor å’Œ Module API ä¼˜åŒ–å™¨ optimizer.step() è‡ªåŠ¨å¾®åˆ† loss.backward() è¯­è¨€æ¨¡å‹ç”±ç¥ç»ç½‘ç»œè¡¨ç¤ºï¼Œç¥ç»ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯é«˜ç»´å‘é‡ï¼Œä¹Ÿå°±æ˜¯ Tensor. Tensor åœ¨å†…å­˜ä¸­å³æ˜¯å¹³å¦çš„ä¸€ç»´æ•°ç»„ï¼Œä½†å¯ä»¥é€šè¿‡ shape å’Œ strides ä¸¤ä¸ª tuple å°†å…¶è¡¨ç¤ºä¸ºé«˜ç»´å‘é‡ã€‚å…¶ä¸­ shape æ˜¯è¡¨ç¤ºæ¯ä¸ªç»´åº¦çš„å¤§å°ï¼Œstrides è¡¨ç¤ºæ¯ä¸ªç»´åº¦ç›¸é‚»ä¸¤ä¸ªå…ƒç´ çš„è·ç¦»ã€‚ class NDArray: # Tensor Implementation def _init(self, other): self._shape = other._shape self._strides = other._strides self._offset = other._offset self._device = other._device self._handle = other._handle é€šè¿‡ shape-strides è¡¨ç¤ºæ³•ï¼Œè®¸å¤šæ“ä½œï¼Œå¦‚ transposeï¼Œreshape éƒ½å¯ä»¥ä¸å¿…æ“ä½œåº•å±‚å…ƒç´ è€Œç›´æ¥æ”¹å˜è¿™ä¸¤ä¸ª tuple å°±å¯ä»¥å®Œæˆã€‚ä½†æ˜¯å¯¹äºæŸäº›æ“ä½œå°±å¿…é¡»è¦å…ˆè½¬åŒ–ä¸º compat æ•°ç»„æ‰èƒ½è¿›è¡Œã€‚ æœ‰äº† Tensor ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ç¥ç»ç½‘ç»œçš„å„ç§ building block äº†ï¼Œå¦‚ Linear å±‚ï¼š class Linear(Module): def __init__( self, in_features, out_features, bias=True, device=None, dtype=\"float32\" ): super().__init__() self.in_features = in_features self.out_features = out_features self.weight = Parameter( init.kaiming_uniform(in_features, out_features, device=device, dtype=dtype)) if bias: self.bias = Parameter( init.kaiming_uniform(out_features, 1, device=device, dtype=dtype) .reshape((1, out_features))) def forward(self, X: Tensor) -\u003e Tensor: Z = X @ self.weight if not self.bias is None: Z = Z + self.bias.broadcast_to(Z.shape) return Z åŒæ—¶ï¼Œä¸ºäº†æ–¹ä¾¿åœ°ä»çˆ¶æ¨¡å‹å¾—åˆ°å­æ¨¡å‹çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº› python çš„åå°„ç‰¹æ€§ï¼Œéå†å¾—åˆ°æ‰€æœ‰ç±»å‹ä¸º Parameter çš„ fieldã€‚ æœ‰äº†å„ç§ building blockï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»ºè¯­è¨€æ¨¡å‹äº†ï¼ŒåŒæ—¶ä¹Ÿå¾ˆå®¹æ˜“å°±èƒ½å®ç°å‰å‘ä¼ æ’­ã€‚ class TransformerLM(nn.Module): def __init__( self, vocab_size: int, context_length: int, d_model: int, num_layers: int, num_heads: int, d_ff: int, attn_pdrop: float, residual_pdrop: float, **kwargs ): super().__init__() self.embed = nn.Embedding(vocab_size, d_model) self.pos_embed = nn.Parameter(torch.zeros(context_length, d_model)) self.drop = nn.Dropout(residual_pdrop) self.layers = nn.Sequential(*[TransformerBlock(d_model, num_heads, d_ff, attn_pdrop, residual_pdrop) for _ in range(num_layers)]) self.ln_f = RMSNorm(d_model) self.head = nn.Linear(d_model, vocab_size, bias=False) self.context_length = context_length def forward(self, x): x = self.embed(x) x = x + self.pos_embed[:x.size(1), :] x = self.drop(x) x = self.layers(x) x = self.ln_f(x) x = self.head(x) return x ä½†åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åå‘ä¼ æ’­ï¼Œè®¡ç®—å„ä¸ªå‚æ•°ç›¸å¯¹äº loss çš„æ¢¯åº¦ã€‚ æœ€ç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ•°å€¼å¾®åˆ†æ–¹æ³•å¾—åˆ°æ¢¯åº¦ï¼Œä½†è¿™æ ·è®¡ç®—å¤æ‚åº¦å¤ªé«˜ï¼Œå› æ­¤æˆ‘ä»¬è€ƒè™‘é‡‡å–ç¬¦å·å¾®åˆ†ã€‚è€ƒè™‘åˆ°ç¥ç»ç½‘ç»œè®¡ç®—å¯ä»¥è¡¨ç¤ºä¸ºè®¡ç®—å›¾ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªä¸­é—´å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é“¾å¼æ³•åˆ™æ¥è‡ªåŠ¨æ±‚å¾— loss ç›¸å¯¹äºæŸä¸ªå‚æ•°çš„å¾®åˆ†ï¼ˆå®é™…å®ç°æ—¶è¦ç‰¢è®°å¾®åˆ†çš„å®šä¹‰ï¼Œä»¥å…è¢«å¤æ‚çš„ Tensor è¿ç®—ææ™•ï¼‰ã€‚ æ ¹æ®åˆ©ç”¨é“¾å¼æ³•åˆ™æ±‚å¯¼æ—¶å›ºå®šå¾®åˆ†çš„æ˜¯åˆ†å­è¿˜æ˜¯åˆ†æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å®ç°å‰å‘è‡ªåŠ¨å¾®åˆ†æˆ–è€…åå‘è‡ªåŠ¨å¾®åˆ†ã€‚ä½†æ˜¾ç„¶åå‘è‡ªåŠ¨å¾®åˆ†å›ºå®šåˆ†å­ï¼Œæœ‰æ›´å¤šçš„å¯å¤ç”¨æ€§ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨å®šä¹‰ç¥ç»ç½‘ç»œæ—¶å®é™…æ„å»ºè®¡ç®—å›¾ï¼ŒåŒæ—¶ä¹Ÿå®é™…æ„å»ºåå‘ä¼ æ’­çš„è®¡ç®—å›¾ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å…ˆå¯¹è®¡ç®—å›¾è¿›è¡Œç¼–è¯‘ä¼˜åŒ–ï¼Œå†è¿è¡Œ/è®­ç»ƒç¥ç»ç½‘ç»œäº†ã€‚ Tensorflow åŸç”Ÿåœ°æ”¯æŒå…ˆå®šä¹‰è®¡ç®—å›¾ï¼Œå†è¿è¡Œã€‚åœ¨ Pytorch ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™å‡½æ•°æ·»åŠ  @torch.compile è£…é¥°å™¨ï¼Œå°†å‘½ä»¤å¼ä»£ç ä¹Ÿè½¬åŒ–ä¸ºè®¡ç®—å›¾ï¼Œç„¶åè¿›è¡Œç¼–è¯‘ä¼˜åŒ–ã€‚ æ€»ä¹‹ï¼Œé€šè¿‡ä¸€æ¬¡æ­£å‘ä¼ æ’­å’Œä¸€æ¬¡åå‘ä¼ æ’­å¾—åˆ°æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¼˜åŒ–å™¨éå†æ‰€æœ‰å‚æ•°ï¼Œé€šè¿‡ä¸€å®šçš„ä¼˜åŒ–è§„åˆ™æ›´æ–°å‚æ•°äº†ã€‚ å› ä¸ºç¥ç»ç½‘ç»œä¸­å¤§é‡çš„çŸ©é˜µè¿ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ GPU æ¥åŠ é€Ÿè¿ç®—ã€‚CPU ä¸­å¤§é‡è®¡ç®—å•å…ƒéƒ½ç”¨äºå®ç°æµæ°´çº¿ï¼Œè¶…çº¿ç¨‹ï¼ŒåŠ¨æ€å¤šå‘å°„ï¼Œä¹±åºæ‰§è¡Œï¼Œä»¥åŠ Speculation å’Œå¤æ‚çš„ç¼“å­˜æœºåˆ¶ã€‚è€Œ GPU æ²¡æœ‰è¿™ä¹ˆå¤šå¤æ‚åŠŸèƒ½ï¼Œå´æœ‰å¤§é‡ç®€å•çš„æ‰§è¡Œå•å…ƒï¼Œæˆ‘ä»¬é€šè¿‡ data-parallel model æ¥ä½¿ç”¨ GPU çš„å¤§é‡è®¡ç®—å•å…ƒç¼–ç¨‹ã€‚è¿™ä¸ª workload ä¸ç®€å•å¤§é‡çš„ Tensor è¿ç®—ååˆ†ç›¸åˆã€‚ ä¸åŒå‚å®¶çš„GPUéƒ½ç€ç›¸ä¼¼ä½†ä¸åŒçš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¹¸å¥½ï¼ŒPytorch ä¼šå¸®æˆ‘ä»¬å¤„ç†è¿™ä¸€åˆ‡ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨åˆ›å»º Tensor ä¼ å…¥ device å‚æ•°å°±å¯ä»¥äº†ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:2:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Benchmarking and profiling æˆ‘ä»¬åœ¨å­¦ä¹ åŸç†æ—¶å¾€å¾€ä¸æ³¨æ„æ€§èƒ½è€ƒé‡ï¼Œä½†åœ¨å„ç§èµ„æºæœ‰é™çš„å®è·µä¸­æ€§èƒ½å´æ˜¯éå¸¸é‡è¦çš„ã€‚å°±åƒå‡¯æ©æ–¯è¯´çš„ï¼Œâ€œç«™åœ¨é•¿å°ºåº¦ä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šæ­»â€ï¼Œæ—¶é—´å’Œè®¡ç®—èµ„æºçº¦æŸåœ¨å®è·µä¸­å¾€å¾€èµ·åˆ°å†³å®šæ€§çš„ä½œç”¨ã€‚å› æ­¤ï¼Œæ€§èƒ½ä¼˜åŒ–ä¹Ÿå°±æˆäº†ä¸€ç§å¿…é¡»ã€‚ ä½†æ˜¯ â€œPremature optimization really the root of all evilâ€ï¼Œæˆ‘ä»¬ä¸èƒ½æƒ³å½“ç„¶çš„å»ä»»æ„ä¼˜åŒ–ï¼Œåªæœ‰åœ¨ benchmark å’Œ profile åï¼Œæˆ‘ä»¬æ‰çŸ¥é“è‡ªå·±çš„å®ç°æ€§èƒ½ç©¶ç«Ÿå¦‚ä½•ï¼Œbottleneck åˆåœ¨å“ªé‡Œï¼Œè¿™æ ·æ‰èƒ½å»é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚è€Œåœ¨å½“å‰çš„ç¡¬ä»¶ä¸­ï¼Œè®¡ç®—å’Œå†…å­˜æ˜¯ä¸¤ç§æœ€ä¸»è¦çš„èµ„æºï¼Œå› æ­¤è®¡ç®—è€—æ—¶å’Œå†…å­˜å ç”¨æ˜¯æˆ‘ä»¬ä¸»è¦ profile çš„å¯¹è±¡ã€‚ åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¹‹å‰è®­ç»ƒçš„æ¨¡å‹ï¼Œå…·ä½“å‚æ•°å¦‚ä¸‹ï¼š { \"vocab_size\": 10000, \"context_length\": 256, \"d_model\": 512, \"num_layers\": 4, \"num_heads\": 16, \"d_ff\": 2048, } ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:3:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Simple Benchmark é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æˆ‘ä»¬çš„å®ç°è·‘çš„æœ‰å¤šå¿«ã€‚æˆ‘ä»¬éœ€è¦åˆ†åˆ«è€ƒè™‘å‰å‘å’Œåå‘ä¼ æ’­çš„ workloadï¼Œå‰è€…ä»£è¡¨æ¨ç†ï¼Œåè€…ä»£è¡¨è®­ç»ƒã€‚åœ¨ benchmark å¼€å§‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº› warm-up stepsï¼Œä»¥ä½¿å¾—ç³»ç»Ÿè¾¾åˆ°ç¨³å®šçŠ¶æ€ï¼ˆå¦‚å¡«å…… cacheï¼Œéƒ¨åˆ†è¯­è¨€çš„ JIT ç¼–è¯‘ï¼ŒGC è¾¾åˆ°ç¨³å®šçŠ¶æ€ç­‰ï¼‰ã€‚ def run_benchmark(model: nn.Module, input_data: torch.Tensor, device: torch.device, warmup_steps: int, timed_steps: int, pass_type: str): ... # --- Warm-up Phase --- print(\"Running warm-up steps...\") with context: for _ in range(warmup_steps): outputs = model(input_data) if pass_type == 'forward_backward': loss = outputs.sum() # Dummy loss optimizer.zero_grad(set_to_none=True) # More efficient loss.backward() optimizer.step() synchronize(device) # Synchronize after each warm-up step, beacuse cuda is calld asycnly # --- Timing Phase --- print(f\"Running {timed_steps} timed steps...\") total_elapsed_time = 0.0 with context: for i in range(timed_steps): synchronize(device) # Ensure previous work is done (esp. CUDA async) start_time = timeit.default_timer() outputs = model(input_data) if pass_type == 'forward_backward': loss = outputs.sum() # Dummy loss optimizer.zero_grad(set_to_none=True) loss.backward() optimizer.step() synchronize(device) # Ensure operation completes before stopping timer end_time = timeit.default_timer() total_elapsed_time += (end_time - start_time) avg_time_per_step = total_elapsed_time / timed_steps print(\"--- Benchmark Complete ---\") return avg_time_per_step éšæœºç”Ÿæˆé•¿åº¦ä¸º context-length çš„å‘é‡ï¼Œåœ¨æˆ‘çš„ M4 èŠ¯ç‰‡ä¸Šç»è¿‡ 5 step çš„ warm up åå† banchmark 20 step çš„åå‘ä¼ æ’­ï¼Œå¾—åˆ°ç»“æœå¦‚ä¸‹ã€‚ --- Benchmark Results --- Device: mps Pass Type: forward_backward Batch Size: 16 Average time per step: 0.482039 seconds Steps per second: 2.07 --- Benchmark Results --- Device: mps Pass Type: forward Batch Size: 16 Average time per step: 0.156253 seconds Steps per second: 6.40 æ ¹æ®ä¸Šé¢çš„åŸºå‡†æµ‹è¯•ç»“æœï¼Œå¯ä»¥å¾—å‡ºï¼š åœ¨ batch size ä¸º 16 çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹çš„æ¨ç†ååé‡ä¸º 6.40 steps/s * 16 tokens/step = 102.4 tokens/sã€‚ä½†å•æ­¥è§£ç ï¼ˆéæ‰¹å¤„ç†ï¼‰çš„é€Ÿåº¦ä»ç„¶é™åˆ¶åœ¨ 6.4 tokens/sã€‚ å¯¹äº 2GB çš„è®­ç»ƒæ•°æ®ï¼š ä¼°è®¡æ€» Token æ•°ï¼š2048 MB * 250,000 tokens/MB = 512,000,000 tokens æœ‰æ•ˆè®­ç»ƒæ ·æœ¬æ•°ï¼š512,000,000 tokens / 1024 tokens/sample â‰ˆ 500,000 samples æ¯ä¸ª Epoch æ‰€éœ€æ­¥æ•°ï¼š500,000 samples / 16 samples/step â‰ˆ 31,250 steps å•ä¸ª Epoch è®­ç»ƒæ—¶é—´ï¼š31,250 steps * 0.482039 seconds/step â‰ˆ 15,064 ç§’ï¼ˆçº¦ 4.18 å°æ—¶ï¼‰ ç›¸æ¯”ä¹‹å‰åœ¨ Building a Transformer LM ä¸­ä»…é€šè¿‡ GPU ç†è®ºååç‡è¿›è¡Œçš„ç²—ç•¥ä¼°ç®—ï¼Œè¿™æ¬¡åŸºäºå®é™…åŸºå‡†æµ‹è¯•çš„æ—¶é—´é¢„ä¼°æ˜¾ç„¶æ›´ä¸ºå‡†ç¡®ã€‚ä¸è¿‡ç»“æœè¡¨æ˜ï¼Œä½¿ç”¨ M4 èŠ¯ç‰‡è¿›è¡Œè®­ç»ƒçš„æ•ˆç‡ç¡®å®ä¸å¤ªç†æƒ³ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:3:1","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Profile Essence å…¶æ¬¡ï¼Œæˆ‘ä»¬è¦çŸ¥é“æˆ‘ä»¬çš„å®ç°ä¸ºä»€ä¹ˆè·‘è¿™ä¹ˆå¿«ï¼Œè¿™æ ·æ‰èƒ½é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚ä½†æ˜¯ benchmark å¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ç¨‹åºå…·ä½“æ¯ä¸€éƒ¨åˆ†æ‰§è¡Œçš„æ—¶é—´ã€‚è€Œè¿™å°±éœ€è¦ profiler å‡ºåœºäº†ã€‚ profile çš„åŸºæœ¬åŸç†ä¸ºåœ¨ç¨‹åºä¸­åŠ å…¥ä¸€äº›æ¢é’ˆï¼Œæ”¶é›†è¿è¡Œæ—¶çš„ä¿¡æ¯ï¼Œå°±åƒä¸­åŒ»é‡Œçš„é’ˆç¸ä¸€æ ·ã€‚æ¢é’ˆæ—¢å¯ä»¥ç¼–è¯‘æ—¶é™æ€æ·»åŠ ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ DTrace ç­‰å·¥å…·åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ ã€‚è€Œåœ¨ Python è¿™æ ·çš„è™šæ‹Ÿæœºè¯­è¨€ä¸­ï¼Œè§£é‡Šå™¨æœ¬èº«å°±æä¾›äº†ä¸€å¥— profiler å®ç°ï¼Œä¹Ÿå°±æ˜¯ cProfileã€‚æˆ‘ä»¬å¯ä»¥æ˜¯åˆ©ç”¨ Python è§£é‡Šå™¨æä¾›çš„äº‹ä»¶é’©å­ï¼ˆhooksï¼‰ã€‚é€šè¿‡ sys.setprofile() å‡½æ•°ï¼Œå¯ä»¥æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨ç‰¹å®šçš„äº‹ä»¶å‘ç”Ÿæ—¶è¢«è§£é‡Šå™¨è°ƒç”¨ã€‚callï¼Œreturn å­—èŠ‚ç æŒ‡ä»¤çš„æ‰§è¡Œéƒ½å¯ä»¥æ˜¯æˆ‘ä»¬å…³å¿ƒçš„äº‹ä»¶ã€‚ ä½† cProfile å¹¶ä¸èƒ½å¾ˆå¥½çš„é€‚é… pytorchã€‚pytorch æä¾›äº† torch.profilerï¼Œå®ƒä¼šè¿½è¸ª GPUæ‰§è¡Œï¼ŒCPUæ‰§è¡Œä»¥åŠå†…å­˜åˆ†é…ç­‰å¤šç§äº‹ä»¶ï¼Œå¹¶æŠŠæ•´åˆèµ·æ¥ã€‚å…·ä½“ä½¿ç”¨ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºã€‚ def run_profile(model: nn.Module, input_data: torch.Tensor, device: torch.device, profile_steps: int, pass_type: str, profile_memory: bool, with_stack: bool, output_dir: str = \".\"): ... # Define the step function to be profiled def profile_step(): ... profile_step() synchronize(device) print(\"Starting profiler context...\") if profile_memory and device.type == 'cuda': torch.cuda.memory._record_memory_history(max_entries=10000) with profile(activities=activities, record_shapes=True, profile_memory=profile_memory, with_stack=with_stack, schedule=torch.profiler.schedule(wait=0, warmup=0, active=1, repeat=profile_steps), experimental_config=torch._C._profiler._ExperimentalConfig(verbose=True)) as prof: # with_stack MUST be True for export_stacks for _ in range(profile_steps): profile_step() # Need to sync *inside* the step for CUDA kernel timings in profiler results # but *outside* the record_functions if you want to profile the sync itself. # Syncing after the main work is usually best for seeing kernel times. synchronize(device) prof.step() # Signal the profiler that one step is done print(\"--- Profiling Complete ---\") ... åœ¨é€šè¿‡ profile æ”¶é›†äº† rawdata ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å±•ç°ä¸ºäººç±»å¯ç†è§£çš„ä¿¡æ¯ã€‚å¦‚ï¼ŒåŸºäºäº‹ä»¶çš„æ—¶é—´çº¿è§†å›¾ Chrome Traceï¼Œæˆ–è€…åŸºäºè°ƒç”¨æ ˆæ ·æœ¬çš„èšåˆè§†å›¾ Flame Graphã€‚å‰è€…è®©æˆ‘çœ‹çš„ç¨‹åºæŒ‰æ—¶é—´é¡ºåºéƒ½åšäº†ä»€ä¹ˆï¼Œéƒ½è€—æ—¶å¤šå°‘ï¼Œåè€…å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªå‡½æ•°éƒ½è¿è¡Œäº†å¤šå°‘æ—¶é—´ã€‚ æˆ‘ä»¬ä»¥ CPU profile ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ Transformer Block ä¸­ã€‚ å…ˆçœ‹ forward passï¼Œå¾ˆæ˜æ˜¾ï¼Œå¤šå¤´æ³¨æ„åŠ›è®¡ç®—å æ®äº†ç»å¤§éƒ¨åˆ†æ—¶é—´ï¼Œè€Œå…¶ä¸­æœ€è€—æ—¶çš„åˆ™æ˜¯ softmax å’Œ Dropout æ“ä½œã€‚ å¦å¤–åå‘ä¼ æ’­è€—æ—¶ç•¥å¤§äºæ­£å‘ä¼ æ’­ï¼Œä½†æ— æ˜æ˜¾ç“¶é¢ˆã€‚ ä»ç«ç„°å›¾ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥éªŒè¯è¿™ä¸€ç‚¹ã€‚å› ä¸ºåœ¨ pytorch å®ç°ä¸­ï¼Œåå‘ä¼ æ’­ä¹Ÿé€šè¿‡è®¡ç®—å›¾å®ç°ï¼Œä¹Ÿä¼šè°ƒç”¨ forward æ–¹æ³•ï¼Œå› æ­¤ç«ç„°å›¾ä¸­çš„æ¯ä¸ªè®¡ç®—éƒ½æ˜¯ç»“åˆäº†æ­£åå‘ä¼ æ’­çš„ï¼Œ Chrome Trace è€ƒè™‘äº†æ—¶åºä¿¡æ¯ï¼Œæ›´é€‚åˆåˆ†æå“åº”æ—¶é—´ï¼Œæš‚åœæ—¶é—´ç­‰é—®é¢˜ã€‚è€Œç«ç„°å›¾è€ƒè™‘ç¨‹åºè®¡ç®—æ•´ä½“ï¼Œæ›´é€‚åˆæå‡ååé‡ï¼Œæ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆã€‚åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæ˜¾ç„¶ååé‡æ˜¯æ›´é‡è¦çš„ï¼Œå› ä¸ºç«ç„°å›¾ä¹Ÿå°±æ›´ä¸ºæ¸…æ¥šäº†ã€‚ä»ä¸‹é¢æ”¾å¤§çš„ç«ç„°å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæœ€è€—æ—¶çš„æ“ä½œä¸ºï¼š Dropout Softmax Matrix mal Linear Mask ä½†æ˜¯è¿™å¹¶æ²¡æœ‰ç»“æŸï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹ mps ç«ç„°å›¾æ—¶ï¼Œå°±ä¼šå‘ç°åœ¨ GPU ä¸Š Softmax æ“ä½œåè€Œå æ®äº†ç»å¤§éƒ¨åˆ†æ—¶é—´ã€‚ç”±æ­¤å¯è§ä¸åŒçš„è®¾å¤‡ä¸Šï¼Œç“¶é¢ˆä¹Ÿæ˜¯ä¸åŒçš„ã€‚ å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å†…å­˜è¿›è¡Œ profileï¼ˆMç³»åˆ—èŠ¯ç‰‡GPUå’ŒCPUå…±ç”¨å†…å­˜ï¼‰ï¼Œå¯ä»¥å‘ç°ï¼Œä¸æƒ³è±¡ä¸­çš„ä¸åŒï¼Œå‚æ•°åªå æ®äº†å¾ˆå°‘ä¸€éƒ¨åˆ†å†…å­˜ï¼Œç»å¤§éƒ¨åˆ†å†…å­˜éƒ½ç”¨æ¥å­˜æ”¾æ¿€æ´»å€¼ï¼Œå‰©ä¸‹çš„å°‘éƒ¨åˆ†åˆ™ä¸»è¦ä¸ºä¼˜åŒ–å™¨çŠ¶æ€ï¼ˆAdamWï¼‰ã€‚ä¹‹æ‰€ä»¥å†…å­˜æ—¶é—´å›¾æˆå±±å³°çŠ¶æ˜¯å› ä¸ºéšç€æ­£å‘è½¬æ’­ï¼Œæ¿€æ´»çš„å€¼è¶Šæ¥è¶Šå¤šã€‚è€Œåå‘ä¼ æ’­åä¸éœ€è¦çš„æ¿€æ´»å€¼ä¼šè¢«åŠæ—¶é‡Šæ”¾ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:3:2","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Single GPU Optimize æ—¢ç„¶é€šè¿‡ profile çŸ¥é“äº†å…·ä½“è¿è¡Œæƒ…å†µï¼Œæˆ‘ä»¬å°±å¯ä»¥åšè¿›ä¸€æ­¥ä¼˜åŒ–äº†ï¼ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:4:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Mixed precision é¦–å…ˆå¦‚ä½•é™ä½è€ƒè™‘å³°å€¼ 2GB çš„å¯æ€•çš„æ˜¾å­˜å ç”¨ã€‚è€ƒè™‘åˆ°æˆ‘ä»¬åœ¨å½“å‰çš„å®ç°ä¸­å…¨ç¨‹ä½¿ç”¨ 32 ä½æµ®ç‚¹æ•°ï¼Œè¿™æ˜¯ä¸€ç¬”ä¸å°çš„å†…å­˜å¼€é”€ï¼Œå¯ä»¥è€ƒè™‘åœ¨å‡†ç¡®ç‡è¿è¡ŒèŒƒå›´å†…é™ä½ç²¾åº¦ã€‚å†è€ƒè™‘åˆ°ä¸€äº› GPU è¿˜é’ˆå¯¹ä½ç²¾åº¦æµ®ç‚¹æ•°åšäº†è®¸å¤šä¼˜åŒ–ï¼Œæˆ‘ä»¬å°±æ›´å¯ä»¥è·å¾—é€Ÿåº¦ä¸Šçš„æå‡äº†ï¼NVIDIA A100 çš„è§„æ ¼è¡¨æ˜¾ç¤ºï¼Œå…¶ FP32 çš„æœ€å¤§ååé‡ä¸º 19.5 TFLOP/ç§’ï¼Œè€Œå…¶ FP16ï¼ˆåŠç²¾åº¦æµ®ç‚¹æ•°ï¼‰æˆ– BF16ï¼ˆè„‘æµ®ç‚¹æ ¼å¼ bfloat16ï¼‰çš„æœ€å¤§ååé‡åˆ™æ˜¾è‘—æ›´é«˜ï¼Œè¾¾åˆ°äº† 312 TFLOP/ç§’ã€‚ ç„¶è€Œï¼Œç®€å•åœ°å°†æˆ‘ä»¬çš„æ¨¡å‹è½¬æ¢ä¸ºè¾ƒä½ç²¾åº¦çš„æ ¼å¼å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹å‡†ç¡®ç‡ä¸‹é™ã€‚ä¾‹å¦‚ï¼Œåœ¨å®è·µä¸­ï¼Œè®¸å¤šæ¢¯åº¦å€¼å¾€å¾€è¿‡å°ï¼Œæ— æ³•ç”¨ FP16 è¡¨ç¤ºï¼Œå› æ­¤åœ¨ä½¿ç”¨ FP16 ç²¾åº¦è¿›è¡Œç®€å•è®­ç»ƒæ—¶è¿™äº›æ¢¯åº¦å€¼ä¼šå˜æˆé›¶ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨ FP16 è¿›è¡Œè®­ç»ƒæ—¶ï¼Œé€šå¸¸ä¼šé‡‡ç”¨æŸå¤±ç¼©æ”¾ï¼ˆloss scalingï¼‰æŠ€æœ¯â€”â€”å³å°†æŸå¤±å€¼ä¹˜ä»¥ä¸€ä¸ªç¼©æ”¾å› å­ï¼Œä»è€Œå¢å¤§æ¢¯åº¦çš„å¤§å°ï¼Œä»¥é˜²æ­¢å®ƒä»¬ä¸‹æº¢å½’é›¶ã€‚ åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ pytorch çš„ autocast context manager å°±å¯ä»¥ï¼Œå¦‚ï¼š with autocast(device_type=device.type, dtype=torch.float16, enabled=(device.type == 'cuda')): outputs = model(dummy_data) loss = criterion(outputs, dummy_labels) ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:4:1","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Fused Kernel å› ä¸º Softmax æ˜¯æˆ‘ä»¬çš„ç“¶é¢ˆä¹‹ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘ä¼˜åŒ– Softmaxã€‚ç›®å‰çš„ Softmax å®ç°å¦‚ä¸‹ã€‚ def softmax(x, dim): max_vals = torch.max(x, dim=dim, keepdim=True).values shifted_x = x - max_vals x_exp = torch.exp(shifted_x) x_exp_sum = torch.sum(x_exp, dim=dim, keepdim=True) return x_exp / x_exp_sum è€ƒè™‘åˆ°åœ¨ Python é—´ä¼ å€¼æ•ˆç‡è¾ƒä½ï¼Œå¤šä¸ªè®¡ç®—æ­¥éª¤èåˆ (fuse) åˆ°äº†ä¸€ä¸ªå•ä¸€çš„ GPU Kernelï¼ˆå†…æ ¸ç¨‹åºï¼‰ä¸­æ‰§è¡Œã€‚ å¦‚åŒå†™ä¸€èˆ¬ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ±‡ç¼–ï¼Œå¯ä»¥ç”¨ cï¼Œä¹Ÿå¯ä»¥ç”¨ Pythonã€‚å†™ kernelï¼ˆé’ˆå¯¹CUDAï¼‰ æˆ‘ä»¬ä¹Ÿæœ‰ SASSï¼ŒCUDAï¼ŒTriton å‡ ç§é€‰é¡¹ã€‚ ä½†æ˜¯ Trtion æ˜¯æ—¶é—´æŠ•å…¥æœ‰é™æ—¶æ€§ä»·æ¯”æœ€é«˜çš„ä¸€ç§ã€‚å¦‚åŒ Cython ä¸€æ ·ï¼ŒTriton è¯­è¨€æ˜¯åˆ©ç”¨äº† Python çš„è£…é¥°å™¨æœºåˆ¶ï¼Œæ½œå…¥äº† Python è¯­è¨€ä¹‹ä¸­ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ•´åˆè¿›ä¸€èˆ¬ Python ç¨‹åºã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ Triton å†™çš„ fused softmax kernelã€‚ @triton.jit def softmax_kernel( output_ptr, input_ptr, input_row_stride, output_row_stride, n_cols, BLOCK_SIZE_N: tl.constexpr, ): row_idx = tl.program_id(axis=0) row_start_ptr_input = input_ptr + (row_idx * input_row_stride) row_start_ptr_output = output_ptr + (row_idx * output_row_stride) col_offsets = tl.arange(0, BLOCK_SIZE_N) input_mask = col_offsets \u003c n_cols row_data = tl.load(row_start_ptr_input + col_offsets, mask=input_mask, other=-float('inf')) row_max = tl.max(row_data, axis=0) numerator = row_data - row_max numerator = tl.exp(numerator) denominator = tl.sum(numerator, axis=0) softmax_output = numerator / denominator tl.store(row_start_ptr_output + col_offsets, softmax_output, mask=input_mask) # --- Wrapper function to launch the kernel --- def softmax(x: torch.Tensor): if not x.is_cuda: print(\"è¾“å…¥å¼ é‡å¿…é¡»åœ¨ CUDA è®¾å¤‡ä¸Šã€‚æ­£åœ¨ç§»è‡³ CUDA...\") x = x.to('cuda') x = x.contiguous() n_rows, n_cols = x.shape output = torch.empty_like(x) BLOCK_SIZE_N = triton.next_power_of_2(n_cols) if BLOCK_SIZE_N \u003e 16384 and n_cols \u003c= 16384 : BLOCK_SIZE_N = triton.next_power_of_2(n_cols) if n_cols \u003e 0 else 1 elif n_cols == 0: return output grid = (n_rows,) softmax_kernel[grid]( output, x, x.stride(0), output.stride(0), n_cols, BLOCK_SIZE_N=BLOCK_SIZE_N, ) return output é™¤äº†ç®€å•çš„ Fused Kernelï¼Œæˆ‘ä»¬è¿˜æœ‰æ›´æ·±å…¥çš„ä¼˜åŒ–æ‰‹æ®µã€‚è€ƒè™‘åˆ° Attention ä¸­çš„æ³¨æ„åŠ›çŸ©é˜µå æ®äº†ç»å¤§éƒ¨åˆ†å†…å­˜ï¼Œè€Œä¸” Softmax çš„é€Ÿåº¦ç“¶é¢ˆä¹Ÿæ˜¯ç”±äºè¿™ä¸ªåºå¤§çš„æ³¨æ„åŠ›çŸ©é˜µé€ æˆçš„ã€‚å½“ Cache æ— æ³•å®Œå…¨å®¹çº³æ³¨æ„åŠ›çŸ©é˜µæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ Tiling æ–¹æ³•å°†å…¶åˆ†å—è®¡ç®—ï¼Œä»¥æœ€å¤§åŒ–åœ°å¤ç”¨ Cacheã€‚åŒæ—¶ï¼Œå¯ä»¥é‡‡ç”¨ Online Softmax ç®—æ³•æ¥æ›¿ä»£ä¼ ç»Ÿ Softmaxï¼Œé¿å…è¯»å–æ•´è¡Œæ•°æ®çš„å¼€é”€ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä»æ•°æ®ã€è®¡ç®—ã€å†…å­˜ç­‰å¤šä¸ªè§’åº¦å‡ºå‘çš„ä¼˜åŒ–æ–¹æ³•ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:4:2","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Distributed data parallel training æ€§èƒ½æ˜¯ç¨‹åºå®é™…è¿è¡Œä¸­çš„æŸç§åº¦é‡ï¼Œä½†å› ä¸ºç³»ç»Ÿå’Œç›®æ ‡çš„å¤æ‚æ€§ï¼Œä¼˜åŒ–æ‰‹æ®µå¹¶æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æŠ½è±¡çš„åˆ†ç±»ä½“ç³»ã€‚åªæœ‰ä¸€äº›ç»éªŒæ€§çš„æ€è·¯å’Œå…·ä½“çš„ toolboxã€‚ åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­ï¼Œå¸¸è§çš„æ€è·¯æœ‰ï¼š å‡å°‘ä¸å¿…è¦çš„å·¥ä½œï¼ˆå¦‚ç¼–è¯‘ä¼˜åŒ–ä¸­çš„å†—ä½™æ¶ˆé™¤ï¼Œè¿‘ä¼¼è®¡ç®—ï¼ŒLazy Evaluationï¼‰ æé«˜åŸå­æ“ä½œçš„æ•ˆç‡ï¼ˆå¦‚é‡‡ç”¨ç¡¬ä»¶ä¼˜åŒ–ï¼Œé‡‡ç”¨é«˜æ•ˆçš„ç®—æ³•ï¼‰ å¹¶è¡ŒåŒ–ï¼ˆä»»åŠ¡åˆ†è§£ï¼Œæµæ°´çº¿ï¼Œå¼‚æ­¥ç¼–ç¨‹ï¼‰ å‡å°‘èµ„æºè®¿é—®å»¶è¿Ÿï¼ˆCacheï¼Œæ‰¹å¤„ç†ï¼Œæ•°æ®å±€éƒ¨æ€§ï¼‰ æœ‰æ•ˆç®¡ç†å’Œåˆ©ç”¨èµ„æºï¼ˆçº¿ç¨‹æ± ï¼Œè´Ÿè½½å‡è¡¡ï¼Œèµ„æºè°ƒåº¦ï¼‰ è¯†åˆ«å…³é”®è·¯å¾„å’Œç“¶é¢ˆï¼ˆfast pathï¼Œslow pathï¼‰ æ˜æ™ºæƒè¡¡ï¼ˆå¦‚åŒæ ·æ˜¯æ€§èƒ½çš„ååé‡å’Œå»¶è¿Ÿé—´çš„æƒè¡¡ï¼Œæ€§èƒ½å’Œå…¶ä»–è´¨é‡å±æ€§é—´çš„æƒè¡¡ï¼‰ æµ‹é‡ï¼Œåˆ†æï¼Œè¿­ä»£ è€Œåœ¨æ‘©å°”å®šå¾‹ç»ˆç»“ä¹‹åï¼Œå¹¶è¡ŒåŒ–æˆä¸ºäº†æå‡æ€§èƒ½æœ€æ˜¾è‘—çš„æ–¹æ³•ä¹‹ä¸€ã€‚å¯¹äºè®¡ç®—ä¾èµ–è¾ƒå°çš„è®¡ç®—å¯†é›†å‹ç¨‹åºï¼Œæ€§èƒ½å‡ ä¹å¯ä»¥éšç¡¬ä»¶æ•°é‡çº¿æ€§æå‡ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•åœ¨æ·±åº¦å­¦ä¹ ä¸­è¿ç”¨å¹¶è¡ŒåŒ–æ–¹æ³•æ¥ä¼˜åŒ–æ€§èƒ½ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:5:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Data Parallelism å°±å¦‚åŒä¸€èˆ¬å¹¶è¡ŒåŒ–æ–¹æ³•ä¸­çš„å‡½æ•°å¹¶è¡Œå’Œæ•°æ®å¹¶è¡Œä¸€æ ·ï¼Œç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥ä¾é è¿™ç§æ€è·¯å¹¶è¡ŒåŒ–ã€‚é¦–å…ˆå°±æ˜¯æ•°æ®å¹¶è¡Œï¼Œæœ€ç›´è§‚çš„æƒ³æ³•å°±æ˜¯å°†ä¸€ä¸ª batch åˆ†æˆå¤šåˆ†ï¼Œåˆ†åˆ«åœ¨å„ä¸ª CPU ä¸Šå‰å‘ï¼Œåå‘ä¼ æ’­å¹¶è®¡ç®—æ¢¯åº¦ï¼Œä¹‹åå†èšåˆæ¢¯åº¦å¹¶æ›´æ–°å‚æ•°ã€‚ åœ¨èšåˆæ¢¯åº¦æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰å¤šç§é€‰æ‹©ï¼š Parameter Serverï¼šä½¿ç”¨ä¸€ä¸ªå‚æ•°æœåŠ¡å™¨é›†ä¸­ç®¡ç†æ‰€æœ‰å‚æ•° ä½†æ˜¯å‚æ•°æœåŠ¡å™¨å°±ä¼šå˜æˆç“¶é¢ˆ AllReduceï¼šè®©å„ä¸ªè®¾å¤‡ä¹‹é—´è‡ªè¡ŒåŒæ­¥æ¢¯åº¦ï¼Œæ ¹æ®äº¤æµçš„æ‹“æ‰‘ï¼Œåˆå¯åˆ†ä¸º Ring AllReduce, Tree AllReduce, Butterfly AllReduce ç­‰ã€‚ æˆ‘ä»¬ä¸€èˆ¬éƒ½é‡‡ç”¨ Ring AllReduceï¼Œå› ä¸ºå…¶åœ¨å»¶è¿Ÿï¼Œè´Ÿè½½å‡è¡¡å’Œæ‰©æ‹“å±•æ€§ä¸Šéƒ½æ¯”è¾ƒå¥½ã€‚ æ­¤å¤–ï¼Œå› ä¸ºåœ¨ Data Parallelism ä¸­ï¼Œæ¯ä¸ª GPU éƒ½ä¿å­˜äº†ä¸€ä»½å®Œæ•´çš„æ¨¡å‹ï¼Œæ‰€ä»¥éš¾ä»¥è®­ç»ƒè¶…è¿‡ GPU æ˜¾å­˜çš„æ¨¡å‹ã€‚å› æ­¤ï¼ŒDeepspeed åˆ›é€ äº† ZeRO æ¡†æ¶æ¥ä¼˜åŒ–æ˜¾å­˜å ç”¨ï¼Œå°†ä¼˜åŒ–å™¨çŠ¶æ€ï¼Œæ¢¯åº¦å’Œå‚æ•°åˆ†æ•£åœ¨å„ä¸ª GPU ä¸Šã€‚å½“ç„¶ ZeRO ä¹Ÿä¸å¯é¿å…åœ°å¢åŠ äº†é€šä¿¡å¼€é”€ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:5:1","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Model \u0026 Pipeline Parallelism å¯¹åº”å‡½æ•°å¹¶è¡Œçš„æ˜¯ Model \u0026 Pipeline Parallelismã€‚è¿™ç§æ–¹æ³•å°†æ¨¡å‹çœ‹ä½œä¸€ä¸ªå‡½æ•°ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªå­å›¾å¹¶åˆ†æ•£åˆ°ä¸åŒçš„ GPU ä¸Šã€‚æ¯ä¸ªå­å›¾å¯ä»¥çœ‹ä½œä¸€ä¸ªå­å‡½æ•°ï¼Œç”šè‡³å•ä¸ªçŸ©é˜µä¹˜æ³•æ“ä½œä¹Ÿå¯ä»¥åˆ†æ•£åˆ°å¤šä¸ª GPU ä¸Šè¿›è¡Œè®¡ç®—ã€‚ å‡½æ•°å¹¶è¡Œä¸€æ–¹é¢å¯ä»¥å’Œæ•°æ®å¹¶è¡Œç»“åˆï¼Œè®­ç»ƒæ›´å¤§çš„æ¨¡å‹ã€‚ä½†æ›´ä¸ºé‡è¦çš„æ˜¯å¯ä»¥é€šè¿‡æ‹†åˆ†å‡½æ•°å¼•å…¥æµæ°´çº¿ï¼Œè¿›ä¸€æ­¥æé«˜ååç‡ã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:5:2","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Scaling Scaling Law ä¸»è¦ç”¨æ¥å›ç­”è¿™æ ·çš„é—®é¢˜ï¼šåœ¨ç®—åŠ›æœ‰é™çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•æƒè¡¡æ¨¡å‹å¤§å°å’Œè®­ç»ƒæ•°æ®é‡ï¼Œä»¥è¾¾åˆ°æœ€ä½çš„ lossï¼Œå¯ä»¥æ•°å­¦è¡¨ç¤ºä¸ºä¸‹é¢çš„å…¬å¼ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä»¥å°è§å¤§ã€‚ Scaling Law çš„ä¸€ä¸ªçµæ„Ÿæ¥è‡ªäºä¼ ç»Ÿ ML ä¸­çš„ Data Scaling Lawã€‚ Data Scaling Law æ˜¯é€šè¿‡è®­ç»ƒæ•°æ®é‡ä¼°è®¡é«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„lossï¼Œlog(Error) = âˆ’ log(n) + 2 log(Ïƒ) ã€‚ä½†è¯­è¨€æ¨¡å‹å´æ²¡æœ‰è¿™æ ·ç®€æ˜çš„æ•°å­¦å…¬å¼å¯ä»¥æ¨å¯¼å‡ºæ¥ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½æŒ‰ç…§ç‰©ç†å­¦çš„æ–¹æ³•ï¼Œæ”¶é›†å®éªŒæ•°æ®å¹¶æå‡ºå‡è®¾ã€‚ DeepMind åœ¨å…¶åä¸º â€œChinchillaâ€ çš„æ¨¡å‹ç ”ç©¶æå‡ºäº†æˆ‘ä»¬å¸¸è¯´çš„ Scaling Lawï¼š æ€»è€Œè¨€ä¹‹å°±æ˜¯ï¼Œæ¨¡å‹å‚æ•°é‡å’Œè®­ç»ƒæ•°æ®åº”è¯¥åŒæ­¥ç¼©æ”¾ï¼Œä»¥è¾¾åˆ°æœ€ä½ lossã€‚ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:6:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"Inference and Serving åœ¨æ¶‰åŠåˆ°æ¨¡å‹çš„æ¨ç†å’Œéƒ¨ç½²æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å»¶è¿Ÿã€ååé‡å’Œå‡†ç¡®ç‡ä¹‹é—´å–å¾—å¹³è¡¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ä¼˜åŒ–æ–¹æ³•ï¼š æ¨¡å‹å‹ç¼© é‡åŒ–ï¼šé™ä½æ•°å€¼ç²¾åº¦ï¼Œå‡å°‘å†…å­˜å’Œè®¡ç®—å¼€é”€ å‰ªæï¼šç§»é™¤ä¸é‡è¦çš„ç½‘ç»œè¿æ¥ çŸ¥è¯†è’¸é¦ï¼šå°†å¤§æ¨¡å‹çŸ¥è¯†è¿ç§»åˆ°å°æ¨¡å‹ æ³¨æ„åŠ›æœºåˆ¶ä¼˜åŒ– PagedAttentionï¼šå€Ÿé‰´æ“ä½œç³»ç»Ÿåˆ†é¡µæœºåˆ¶ï¼Œå®ç° KV Cache çš„åŠ¨æ€å†…å­˜ç®¡ç† æ”¯æŒéè¿ç»­æ˜¾å­˜åˆ†é…ï¼Œè§£å†³é•¿åºåˆ—æ¨ç†æ—¶çš„æ˜¾å­˜ç¢ç‰‡é—®é¢˜ æ¨ç†é˜¶æ®µä¼˜åŒ– Chunked Prefillï¼šå°†é•¿è¾“å…¥åˆ†å—å¤„ç†ï¼Œé™ä½æ˜¾å­˜å‹åŠ› è®¡ç®—è§£ç åˆ†ç¦»ï¼šå°†è®¡ç®—å¯†é›†çš„é¢„å¡«å……å’Œå†…å­˜å¯†é›†çš„è§£ç åˆ†é…åˆ°ä¸åŒç¡¬ä»¶ Speculative Decodingï¼šä½¿ç”¨å°æ¨¡å‹é¢„æµ‹ï¼Œå¤§æ¨¡å‹éªŒè¯ï¼Œå‡å°‘çº¦ 30% è§£ç æ­¥éª¤ æ‰¹å¤„ç†ç­–ç•¥ Continuous Batchingï¼šé€šè¿‡åŠ¨æ€è°ƒåº¦å®ç°â€‹â€‹ç»†ç²’åº¦è¯·æ±‚ç®¡ç†ï¼Œå¦‚æ¯ä¸ªè§£ç æ­¥éª¤ï¼ˆç”Ÿæˆ1ä¸ªtokenï¼‰é‡æ–°è¯„ä¼°æ‰¹æ¬¡ç»„æˆï¼Œæ–°è¯·æ±‚å¯ç«‹å³åŠ å…¥ï¼Œå®Œæˆè¯·æ±‚åŠæ—¶é€€å‡º Adaptive Batchingï¼šæ ¹æ®åºåˆ—é•¿åº¦åŠ¨æ€è°ƒæ•´æ‰¹æ¬¡å¤§å° Delayed Batchingï¼šå¼•å…¥å›ºå®šå»¶è¿Ÿçª—å£ä»¥ç§¯ç´¯æ›´å¤šè¯·æ±‚ï¼Œæå‡æ•´ä½“ååé‡ ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:7:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["AI"],"content":"LLM API and SSE æˆ‘ä»¬åœ¨è°ƒç”¨ LLM API æ—¶ï¼Œå¸¸å¸¸ä¼šä½¿ç”¨ SSEï¼ˆServer-Sent Eventsï¼‰åè®®ï¼Œè¯¥åè®®æ”¯æŒæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å•å‘æ¨é€æ•°æ®ï¼Œéå¸¸é€‚åˆå¤§æ¨¡å‹è¿™æ ·çš„æµå¼æ–‡æœ¬è¾“å‡ºã€‚ä¸€ä¸ªç®€å•çš„ client-server ä¾‹å­å¦‚ä¸‹ï¼š const eventSource = new EventSource('/api/stream'); eventSource.onmessage = (event) =\u003e { const data = JSON.parse(event.data); document.getElementById('output').innerHTML += data.token; }; eventSource.addEventListener('end', () =\u003e { eventSource.close(); }); event: message data: {\"token\": \"æ˜¥\", \"finished\": false} event: end data: {\"finished\": true} from fastapi import Request import openai import asyncio @app.get(\"/api/stream\") async def stream_response(request: Request): async def event_generator(): response = await openai.ChatCompletion.acreate( model=\"gpt-4\", messages=[{\"role\": \"user\", \"content\": \"å†™ä¸€ä¸ªé€’å½’çš„å¿«é€Ÿæ’åºå‡½æ•°\"}], stream=True ) async for chunk in response: token = chunk.choices[0].delta.get(\"content\", \"\") yield f'data: {{\"token\": \"{token}\"}}\\n\\n' yield \"event: end\\ndata: {}\\n\\n\" return EventResponse(event_generator()) ","date":"2025-05-10","objectID":"/posts/optimize-the-performance-of-a-lm/:8:0","tags":["LLM","Code","Performance"],"title":"Optimize the Performance of a LM","uri":"/posts/optimize-the-performance-of-a-lm/"},{"categories":["Instinct"],"content":" æœ¬æ–‡ç”± Gemini è¾…åŠ©ç”Ÿæˆ åœ¨ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘ä»¬æ¯å¤©éƒ½ä¼šæ¥è§¦åˆ°æµ·é‡çš„æ•°æ®å’Œæ•°å­—ã€‚ä»å›½å®¶è´¢æ”¿é¢„ç®—çš„ä¸‡äº¿ï¼Œåˆ°ç—…æ¯’å¤§å°çš„çº³ç±³ï¼Œå†åˆ°è®¡ç®—æœºæ¨¡å‹çš„æ•°åäº¿å‚æ•°ï¼Œè¿™äº›æ•°å­—è·¨è¶Šäº†æå…¶å¹¿é˜”çš„èŒƒå›´ã€‚ç„¶è€Œï¼Œå¯¹äºè¿™äº›å·¨å¤§æˆ–å¾®å°çš„æ•°å­—ï¼Œæˆ‘ä»¬å¸¸å¸¸ç¼ºä¹ç›´è§‚çš„æ„Ÿå—ï¼Œéš¾ä»¥ç†è§£å®ƒä»¬çœŸå®çš„å«ä¹‰å’Œç›¸å¯¹å¤§å°ã€‚ åŸ¹å…»â€œæ•°å­—ç›´è§‰â€â€”â€”ä¹Ÿå°±æ˜¯å¯¹æ•°å­—å¤§å°å’Œæ¯”ä¾‹çš„å¿«é€Ÿã€å‡†ç¡®çš„æ„ŸçŸ¥èƒ½åŠ›â€”â€”å¯¹äºæˆ‘ä»¬ç†è§£ä¸–ç•Œã€åšå‡ºåˆ¤æ–­è‡³å…³é‡è¦ã€‚è¿™ç¯‡åšå®¢æ—¨åœ¨é€šè¿‡æ¢³ç†ä¸åŒé¢†åŸŸçš„æ•°å­—å°ºåº¦ï¼Œå¹¶ç»“åˆå¯è§†åŒ–æ–¹æ³•ï¼Œå¸®åŠ©æˆ‘ä»¬å»ºç«‹èµ·è¿™ç§ç›´è§‰ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:0:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"1. æ•°å­—çš„è¡¨ç¤ºä¸å•ä½ï¼šä»â€œä¸ªâ€åˆ°â€œæ— é‡å¤§æ•°â€ ç†è§£æ•°å­—çš„åŸºç¡€æ˜¯æŒæ¡å…¶è¡¨ç¤ºæ–¹æ³•å’Œå•ä½ã€‚æˆ‘ä»¬å¸¸ç”¨çš„åè¿›åˆ¶ç³»ç»Ÿï¼Œé…åˆä¸åŒçš„å•ä½ï¼Œå¯ä»¥æè¿°ä»æå°åˆ°æå¤§çš„æ•°å€¼ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:1:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"1.1 å¸¸ç”¨è‹±æ–‡ä¸ä¸­æ–‡å•ä½å¯¹ç…§ ç°ä»£ç§‘å­¦å’Œå›½é™…äº¤æµä¸­ï¼Œè‹±æ–‡å•ä½ï¼ˆå¦‚ Million, Billion, Trillionï¼‰å’Œç§‘å­¦è®¡æ•°æ³• ($10^n$) æ˜¯æ ‡å‡†ã€‚ä¸­æ–‡å•ä½åˆ™æœ‰å…¶ç‹¬ç‰¹çš„ä½“ç³»ï¼Œå°¤å…¶æ˜¯åœ¨å¤§æ•°å’Œå°æ•°ä¸Šã€‚äº†è§£å®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»æ˜¯å»ºç«‹æ•°å­—ç›´è§‰çš„ç¬¬ä¸€æ­¥ã€‚ è‹±æ–‡å•ä½ ä¸­æ–‡å•ä½ é˜¿æ‹‰ä¼¯æ•°å­— ç§‘å­¦è®¡æ•°æ³• å›½é™…å•ä½åˆ¶è¯å¤´ One ä¸ª 1 $10^0$ â€” Ten å 10 $10^1$ Deca (da) Hundred ç™¾ 100 $10^2$ Hecto (h) Thousand åƒ 1,000 $10^3$ Kilo (k) Ten thousand ä¸‡ 10,000 $10^4$ â€” Hundred thousand åä¸‡ 100,000 $10^5$ â€” Million ç™¾ä¸‡ 1,000,000 $10^6$ Mega (M) Ten million åƒä¸‡ 10,000,000 $10^7$ â€” Hundred million äº¿ 100,000,000 $10^8$ â€” Billion åäº¿ 1,000,000,000 $10^9$ Giga (G) Ten billion ç™¾äº¿ 10,000,000,000 $10^{10}$ â€” Hundred billion åƒäº¿ 100,000,000,000 $10^{11}$ â€” Trillion ä¸‡äº¿ï¼ˆå…†ï¼‰ 1,000,000,000,000 $10^{12}$ Tera (T) ä¸€äº›ç¤ºä¾‹ï¼š åœ°çƒäººå£å¤§çº¦æ˜¯ 8 Billion äººï¼Œå³ $8 \\times 10^9$ äººï¼Œæˆ– 80 äº¿äººã€‚ ä¸€ä¸ªå¤§å‹è·¨å›½å…¬å¸çš„å¹´æ”¶å…¥å¯èƒ½æ˜¯ 100 Billion ç¾å…ƒï¼Œå³ $10^{11}$ ç¾å…ƒï¼Œæˆ– 1000 äº¿ç¾å…ƒã€‚ å…¨çƒæ¯å¹´çš„ç»æµæ€»é‡ï¼ˆGDPï¼‰æ¥è¿‘ 100 Trillion ç¾å…ƒï¼Œå³ $10^{14}$ ç¾å…ƒï¼Œæˆ– 100 ä¸‡äº¿ç¾å…ƒã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:1:1","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"1.2 å°æ•°å•ä½ä¸ä¼ ç»Ÿä¸­æ–‡å•ä½ å¯¹äºå°äº1çš„æ•°å­—ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç›¸åº”çš„å•ä½ã€‚ è‹±æ–‡å•ä½ ä¸­æ–‡å•ä½ é˜¿æ‹‰ä¼¯æ•°å­— ç§‘å­¦è®¡æ•°æ³• å›½é™…å•ä½åˆ¶è¯å¤´ Thousandth æ¯« 0.001 $10^{-3}$ Milli (m) Millionth å¾® 0.000001 $10^{-6}$ Micro (Î¼) Billionth çº³ 0.000000001 $10^{-9}$ Nano (n) Trillionth çš® 0.000000000001 $10^{-12}$ Pico (p) ä¼ ç»Ÿä¸­æ–‡å•ä½åœ¨å¤§æ•°å’Œå°æ•°ä¸Šæœ‰ç€æ›´ä¸°å¯Œçš„å±‚çº§ï¼š å¤§æ•°ï¼š ä¸‡ï¼ˆ$10^4$ï¼‰â†’ äº¿ï¼ˆ$10^8$ï¼‰ â†’ å…†ï¼ˆ$10^{12}$ï¼‰ â†’ äº¬ï¼ˆ$10^{16}$ï¼‰ â†’ â€¦ â†’ æ— é‡å¤§æ•°ï¼ˆ$10^{68}$ï¼‰ å°æ•°ï¼š åˆ†ï¼ˆ$10^{-1}$ï¼‰â†’ å˜ï¼ˆ$10^{-2}$ï¼‰â†’ æ¯«ï¼ˆ$10^{-3}$ï¼‰â†’ ä¸ï¼ˆ$10^{-4}$ï¼‰â†’ å¿½ï¼ˆ$10^{-5}$ï¼‰â†’ å¾®ï¼ˆ$10^{-6}$ï¼‰â†’ çº¤ï¼ˆ$10^{-7}$ï¼‰â†’ æ²™ï¼ˆ$10^{-8}$ï¼‰â†’ å°˜ï¼ˆ$10^{-9}$ï¼‰â†’ åŸƒï¼ˆ$10^{-10}$ï¼‰ ä¸€äº›ç¤ºä¾‹ï¼š äººç±»å¤´å‘çš„ç›´å¾„å¤§çº¦æ˜¯ 50-100 å¾®ç±³ï¼Œå³ $50 \\times 10^{-6}$ ç±³ åˆ° $100 \\times 10^{-6}$ ç±³ã€‚ ä¸€ä¸ªæ°´åˆ†å­çš„ç›´å¾„å¤§çº¦æ˜¯ 0.3 çº³ç±³ï¼Œå³ $0.3 \\times 10^{-9}$ ç±³ã€‚ ç¡…åŸå­çš„ç›´å¾„å¤§çº¦æ˜¯ 0.2 çº³ç±³ï¼Œå³ $0.2 \\times 10^{-9}$ ç±³ã€‚ ä¼ ç»Ÿçš„â€œä¸€åŸƒâ€ç­‰äº $10^{-10}$ ç±³ï¼Œå¸¸ç”¨äºæè¿°åŸå­å°ºåº¦ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:1:2","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"2. ç‰©ç†ä¸–ç•Œçš„å°ºåº¦ï¼šä»åŸå­åˆ°å®‡å®™ ç‰©ç†ä¸–ç•Œæ¶µç›–äº†ä»å¾®è§‚ç²’å­åˆ°æµ©ç€šå®‡å®™çš„å¹¿é˜”å°ºåº¦ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:2:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"2.1 é•¿åº¦çš„å°ºåº¦ é‡çº² å…¸å‹å€¼ ç§‘å­¦è®¡æ•°æ³• æµ‹é‡æ–¹æ³•/è¯´æ˜ åŸå­ç›´å¾„ é›¶ç‚¹ä¸€åˆ°é›¶ç‚¹äº”çº³ç±³ (Zero point one to zero point five nanometers) $10^{-10}$ m æ‰«æéš§é“æ˜¾å¾®é•œ (STM) DNA åŒèºæ—‹ç›´å¾„ ä¸¤çº³ç±³ (Two nanometers) $2 \\times 10^{-9}$ m Xå°„çº¿è¡å°„ ç—…æ¯’å¤§å° äºŒååˆ°ä¸‰ç™¾çº³ç±³ (Twenty to three hundred nanometers) $10^{-8}$ m ç”µå­æ˜¾å¾®é•œ ç»†èŒå¤§å° é›¶ç‚¹äº”åˆ°äº”å¾®ç±³ (Zero point five to five micrometers) $10^{-6}$ m å…‰å­¦æ˜¾å¾®é•œ äººç±»å¤´å‘ç›´å¾„ äº”ååˆ°ä¸€ç™¾å¾®ç±³ (Fifty to one hundred micrometers) $10^{-5}$ m å…‰å­¦æ˜¾å¾®é•œ ç°å°˜é¢—ç²’å¤§å° ä¸€åˆ°ä¸€ç™¾å¾®ç±³ (One to one hundred micrometers) $10^{-5}$ m å…‰å­¦æ˜¾å¾®é•œ èš‚èšé•¿åº¦ ä¸€æ¯«ç±³åˆ°ä¸¤å˜ç±³ (One millimeter to two centimeters) $10^{-3}$ m ç›´æ¥æµ‹é‡ äººçš„èº«é«˜ ä¸€ç‚¹äº”åˆ°ä¸¤ç±³ (One point five to two meters) $10^0$ m ç›´æ¥æµ‹é‡ ç ç©†æœ—ç›å³°é«˜ å…«åƒå…«ç™¾å››åå…«ç±³ (Eight thousand eight hundred forty-eight meters) $8.8 \\times 10^3$ m æµ‹é‡ åœ°å£³åšåº¦ äº”åˆ°ä¸ƒååƒç±³ (Five to seventy kilometers) $10^4$ m åœ°éœ‡æ³¢èµ°æ—¶åˆ†æ å¹³æµå±‚é«˜åº¦ åäº”åˆ°äº”ååƒç±³ (Fifteen to fifty kilometers) $10^4$ m æ°”è±¡æ¢æµ‹ åœ°çƒåŠå¾„ å…­åƒä¸‰ç™¾ä¸ƒåä¸€åƒç±³ (Six thousand three hundred seventy-one kilometers) $6.4 \\times 10^6$ m åœ°éœ‡æ³¢èµ°æ—¶åˆ†æ åœ°æœˆè·ç¦» ä¸‰åå…«ä¸‡å››åƒå››ç™¾åƒç±³ (Three hundred eighty-four thousand four hundred kilometers) $3.8 \\times 10^8$ km æ¿€å…‰æµ‹è· åœ°çƒç»•å¤ªé˜³è½¨é“åŠå¾„ ä¸€ç‚¹äº”äº¿åƒç±³ (One hundred fifty million kilometers) $1.5 \\times 10^{11}$ km å¤©æ–‡æµ‹é‡ å¤ªé˜³ç³»ç›´å¾„ çº¦ä¸€ç™¾å¤©æ–‡å•ä½ (Approximately one hundred astronomical units) $1.5 \\times 10^{13}$ m ä¼°ç®— ($1 , \\text{AU} = \\text{åœ°çƒåˆ°å¤ªé˜³è·ç¦»}$) ç¦»å¤ªé˜³æœ€è¿‘çš„æ’æ˜Ÿï¼ˆæ¯”é‚»æ˜Ÿï¼‰è·ç¦» å››ç‚¹äºŒå…‰å¹´ (Four point two light-years) $4 \\times 10^{16}$ m è§†å·®æ³• é“¶æ²³ç³»ç›´å¾„ çº¦åä¸‡å…‰å¹´ (Approximately one hundred thousand light-years) $10^{21}$ m å¤©æ–‡è§‚æµ‹ å¯è§‚æµ‹å®‡å®™ç›´å¾„ çº¦ä¹ç™¾ä¸‰åäº¿å…‰å¹´ (Approximately ninety-three billion light-years) $9 \\times 10^{26}$ m å®‡å®™å­¦æ¨¡å‹ ä¸€äº›ç¤ºä¾‹ï¼š ä¸€ä¸ªå…¸å‹çš„ç»†èŒ ($10^{-6}$ m) æ¯”äººç±»å¤´å‘ ($10^{-5}$ m) å°çº¦ 10 å€ã€‚ åœ°çƒçš„åŠå¾„ ($6.4 \\times 10^6$ m) å¤§çº¦æ˜¯ç ç©†æœ—ç›å³°é«˜åº¦ ($8.8 \\times 10^3$ m) çš„ 700 å¤šå€ã€‚ ä»åœ°çƒåˆ°æœ€è¿‘çš„æ’æ˜Ÿï¼ˆæ¯”é‚»æ˜Ÿï¼‰çš„è·ç¦» ($4 \\times 10^{16}$ m) æ˜¯åœ°æœˆè·ç¦» ($3.8 \\times 10^8$ km) çš„çº¦ 100 ä¸‡äº¿å€ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:2:1","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"2.2 æ—¶é—´çš„å°ºåº¦ é‡çº² å…¸å‹å€¼ ç§‘å­¦è®¡æ•°æ³• è¯´æ˜/äº‹ä»¶ å…‰é€Ÿç©¿è¿‡åŸå­æ‰€éœ€æ—¶é—´ åçš„è´Ÿåå…«æ¬¡æ–¹ç§’ (Ten to the power of minus eighteen seconds) $10^{-18}$ s é˜¿ç§’ (Attosecond) ç‰©ç†å­¦é¢†åŸŸ åŸå­æ ¸ååº”æ—¶é—´ åçš„è´Ÿåäº”æ¬¡æ–¹ç§’ (Ten to the power of minus fifteen seconds) $10^{-15}$ s é£ç§’ (Femtosecond) åŒ–å­¦ååº”å°ºåº¦ åˆ†å­æŒ¯åŠ¨å‘¨æœŸ åçš„è´ŸåäºŒæ¬¡æ–¹ç§’ (Ten to the power of minus twelve seconds) $10^{-12}$ s çš®ç§’ (Picosecond) æ™¶ä½“ç®¡å¼€å…³æ—¶é—´ åçš„è´Ÿä¹æ¬¡æ–¹ç§’ / ä¸€çº³ç§’ (Ten to the power of minus nine seconds / One nanosecond) $10^{-9}$ s çº³ç§’ (Nanosecond) è®¡ç®—æœºCPUæ—¶é’Ÿå‘¨æœŸ äººç±»çœ¨çœ¼æ—¶é—´ é›¶ç‚¹ä¸€åˆ°é›¶ç‚¹å››ç§’ (Zero point one to zero point four seconds) $10^{-1}$ s ä¸€å¤© å…«ä¸‡å…­åƒå››ç™¾ç§’ (Eighty-six thousand four hundred seconds) $8.6 \\times 10^4$ s ä¸€å¹´ ä¸‰ç‚¹ä¸€äº”ä¹˜ä»¥åçš„ä¸ƒæ¬¡æ–¹ç§’ (Three point one five times ten to the power of seven seconds) $3.15 \\times 10^7$ s äººç±»å¹³å‡å¯¿å‘½ çº¦å…«åå¹´ (Approximately eighty years) $2.5 \\times 10^9$ s æœ‰æ–‡å­—è®°è½½çš„å†å² çº¦äº”åƒå¹´ (Approximately five thousand years) $1.6 \\times 10^{11}$ s å†œä¸šæ–‡æ˜å² çº¦ä¸€ä¸‡å¹´ (Approximately ten thousand years) $3.15 \\times 10^{11}$ s æ™ºäººå‡ºç°æ—¶é—´ çº¦äºŒåä¸‡å¹´ (Approximately two hundred thousand years) $6.3 \\times 10^{12}$ s æ—§çŸ³å™¨æ—¶ä»£å¼€å§‹ çº¦ä¸¤ç™¾ä¸‡å¹´ (Approximately two million years) $6.3 \\times 10^{13}$ s æé¾™ç­ç»æ—¶é—´ å…­åƒå…­ç™¾ä¸‡å¹´ (Sixty-six million years) $2.1 \\times 10^{15}$ s æ–°ç”Ÿä»£å¼€å§‹ å¯’æ­¦çºªå¤§çˆ†å‘ äº”ç‚¹å››äº¿å¹´ (Five hundred forty million years) $1.7 \\times 10^{16}$ s æ˜¾ç”Ÿå®™å¼€å§‹ åœ°çƒå½¢æˆæ—¶é—´ å››åäº”äº¿å¹´ (Four point five billion years) $1.4 \\times 10^{17}$ s å†¥å¤å®™å¼€å§‹ å®‡å®™å¹´é¾„ ä¸€ç™¾ä¸‰åå…«äº¿å¹´ (Thirteen point eight billion years) $4.3 \\times 10^{17}$ s ä¸€äº›ç¤ºä¾‹ï¼š äººç±»çœ¨çœ¼çš„æ—¶é—´ ($10^{-1}$ s) æ¯”è®¡ç®—æœºCPUçš„ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ ($10^{-9}$ s) æ…¢çº¦ 1 äº¿å€ã€‚ ä»æé¾™ç­ç»åˆ°ç°åœ¨ ($2.1 \\times 10^{15}$ s) çš„æ—¶é—´å¤§çº¦æ˜¯äººç±»å¹³å‡å¯¿å‘½ ($2.5 \\times 10^9$ s) çš„ 80 å¤šä¸‡å€ã€‚ å®‡å®™çš„å¹´é¾„ ($4.3 \\times 10^{17}$ s) æ˜¯åœ°çƒå¹´é¾„ ($1.4 \\times 10^{17}$ s) çš„çº¦ 3 å€ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:2:2","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"3. ç¤¾ä¼šä¸ç»æµçš„å°ºåº¦ ç¤¾ä¼šå’Œç»æµé¢†åŸŸä¹Ÿå……æ»¡äº†å¤§å¤§å°å°çš„æ•°å­—ï¼Œåæ˜ ç€äººç±»æ´»åŠ¨çš„è§„æ¨¡å’Œå¤æ‚æ€§ã€‚ é‡çº² å…¸å‹å€¼ ç§‘å­¦è®¡æ•°æ³• è¯´æ˜/æ¥æº ä¸–ç•Œäººå£ çº¦å…«åäº¿äºº (Approximately eight billion people) $8 \\times 10^9$ äºº Worldometer: ä¸–ç•Œäººå£ ä¸­å›½äººå£ çº¦åå››äº¿äºº (Approximately one point four billion people) $1.4 \\times 10^9$ äºº å›½å®¶ç»Ÿè®¡å±€ å…¨çƒ GDP çº¦ä¸€ç™¾ä¸‡äº¿ç¾å…ƒ (Approximately one hundred trillion US dollars) $10^{14}$ ç¾å…ƒ ä¸–ç•Œé“¶è¡Œ ç¾å›½å¹´åº¦è´¢æ”¿é¢„ç®— çº¦å…­ä¸‡äº¿ç¾å…ƒ (Approximately six trillion US dollars) $6 \\times 10^{12}$ ç¾å…ƒ USA.gov: ç¾å›½è´¢æ”¿é¢„ç®— æŸå¤§å‹å…¬å¸å¸‚å€¼ çº¦ä¸¤ä¸‡äº¿ç¾å…ƒ (Approximately two trillion US dollars) $2 \\times 10^{12}$ ç¾å…ƒ æŸåŸå¸‚äººå£ çº¦ä¸€åƒä¸‡äºº (Approximately ten million people) $10^7$ äºº æŸå¤§å­¦å­¦ç”Ÿæ•° çº¦äº”ä¸‡äºº (Approximately fifty thousand people) $5 \\times 10^4$ äºº æŸäº§å“å¹´é”€é‡ çº¦ä¸€ç™¾ä¸‡ä»¶ (Approximately one million units) $10^6$ ä»¶ ä¸€äº›ç¤ºä¾‹ï¼š å…¨çƒäººå£ ($8 \\times 10^9$) å¤§çº¦æ˜¯ä¸­å›½äººå£ ($1.4 \\times 10^9$) çš„ 5 å€å¤šã€‚ å…¨çƒ GDP ($10^{14}$ ç¾å…ƒ) æ˜¯ç¾å›½å¹´åº¦è´¢æ”¿é¢„ç®— ($6 \\times 10^{12}$ ç¾å…ƒ) çš„çº¦ 16 å€ã€‚ ä¸€ä¸ªæ‹¥æœ‰ $10^7$ äººå£çš„åŸå¸‚çš„äººå£æ˜¯ä¸€ä¸ªæ‹¥æœ‰ $5 \\times 10^4$ å­¦ç”Ÿçš„å¤§å­¦çš„ 200 å€ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:3:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"4. è®¡ç®—æœºä¸ä¿¡æ¯çš„å°ºåº¦ åœ¨è®¡ç®—æœºå’Œä¿¡æ¯é¢†åŸŸï¼Œæˆ‘ä»¬å¤„ç†ç€ä»å­—èŠ‚åˆ°æ‹å­—èŠ‚ï¼Œä»ä»£ç è¡Œæ•°åˆ°æ¨¡å‹å‚æ•°é‡çš„å„ç§æ•°å­—ã€‚ é‡çº² å…¸å‹å€¼ ç§‘å­¦è®¡æ•°æ³• è¯´æ˜/æ¥æº ä¸€ä¸ªå­—èŠ‚ (Byte) å…«æ¯”ç‰¹ (Eight bits) $8 \\times 10^0$ bit å­˜å‚¨ä¸€ä¸ªå­—ç¬¦æ‰€éœ€ç©ºé—´ ä¸€åƒå­—èŠ‚ (KB) ä¸€åƒå­—èŠ‚ (One kilobyte) $10^3$ Bytes ä¸€ä¸ªå°æ–‡æœ¬æ–‡ä»¶å¤§å° ä¸€å…†å­—èŠ‚ (MB) ä¸€å…†å­—èŠ‚ (One megabyte) $10^6$ Bytes ä¸€å¼ é«˜æ¸…å›¾ç‰‡å¤§å° ä¸€å‰å­—èŠ‚ (GB) ä¸€å‰å­—èŠ‚ (One gigabyte) $10^9$ Bytes ä¸€éƒ¨ç”µå½±å¤§å° ä¸€å¤ªå­—èŠ‚ (TB) ä¸€å¤ªå­—èŠ‚ (One terabyte) $10^{12}$ Bytes ä¸ªäººç”µè„‘ç¡¬ç›˜å®¹é‡ ä¸€æ‹å­—èŠ‚ (PB) ä¸€æ‹å­—èŠ‚ (One petabyte) $10^{15}$ Bytes å¤§å‹æ•°æ®ä¸­å¿ƒå­˜å‚¨å®¹é‡ Linux å†…æ ¸ä»£ç è¡Œæ•° çº¦ä¸‰åƒä¸‡è¡Œ (Approximately thirty million lines) $3 \\times 10^7$ è¡Œ TIOBE Index Windows æ“ä½œç³»ç»Ÿä»£ç è¡Œæ•° çº¦äº”åƒä¸‡è¡Œ (Approximately fifty million lines) $5 \\times 10^7$ è¡Œ ä¼°ç®— æŸå¤§å‹è½¯ä»¶é¡¹ç›®ä»£ç è¡Œæ•° çº¦ä¸€ç™¾ä¸‡è¡Œ (Approximately one million lines) $10^6$ è¡Œ Information is Beautiful: Million Lines of Code GPT-2 Small æ¨¡å‹å‚æ•°é‡ ä¸€ç‚¹äºŒäº”äº¿ (One hundred twenty-five million parameters) $1.25 \\times 10^8$ Information is Beautiful: The Rise of Generative AI GPT-3 æ¨¡å‹å‚æ•°é‡ ä¸€åƒä¸ƒç™¾äº”åäº¿ (One hundred seventy-five billion parameters) $1.75 \\times 10^{11}$ æŸå¤§å‹AIæ¨¡å‹å‚æ•°é‡ ä¸€ä¸‡äº¿ (One trillion parameters) $10^{12}$ ä¸€äº›ç¤ºä¾‹ï¼š ä¸€ä¸ª $GB$ ($10^9$ Bytes) å¤§çº¦æ˜¯ä¸€ä¸ª $KB$ ($10^3$ Bytes) çš„ 100 ä¸‡å€ã€‚ Linux å†…æ ¸ä»£ç è¡Œæ•° ($3 \\times 10^7$) å¤§çº¦æ˜¯æŸå¤§å‹è½¯ä»¶é¡¹ç›® ($10^6$) çš„ 30 å€ã€‚ GPT-3 æ¨¡å‹å‚æ•°é‡ ($1.75 \\times 10^{11}$) æ˜¯ GPT-2 Small æ¨¡å‹ ($1.25 \\times 10^8$) å‚æ•°é‡çš„çº¦ 1400 å€ã€‚ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:4:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["Instinct"],"content":"5. æ€»ç»“ï¼šåŸ¹å…»ä½ çš„æ•°å­—ç›´è§‰ é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒé¢†åŸŸçš„æ•°å­—è·¨åº¦ä¹‹å¤§ã€‚ä»å¾®è§‚çš„åŸå­å°ºåº¦åˆ°å®è§‚çš„å®‡å®™å°ºåº¦ï¼Œä»ä¸ªäººè´¢å¯Œåˆ°å›½å®¶ç»æµï¼Œä»ä¸€è¡Œä»£ç åˆ°å¤§å‹AIæ¨¡å‹ï¼Œæ•°å­—æ— å¤„ä¸åœ¨ï¼Œå¹¶ä»¥æƒŠäººçš„æ¯”ä¾‹å˜åŒ–ç€ã€‚ åŸ¹å…»æ•°å­—ç›´è§‰å¹¶éè¦æ±‚è®°ä½æ¯ä¸€ä¸ªç²¾ç¡®çš„æ•°å­—ï¼Œè€Œæ˜¯è¦å»ºç«‹èµ·å¯¹ä¸åŒæ•°é‡çº§çš„æ¦‚å¿µæ€§ç†è§£ã€‚å½“ä½ å¬åˆ°â€œåäº¿â€æ—¶ï¼Œè„‘æµ·ä¸­èƒ½å¦æµ®ç°å‡ºå®ƒå¤§çº¦æ˜¯å¤šå°‘ä¸ªâ€œç™¾ä¸‡â€ï¼Ÿå½“ä½ çœ‹åˆ°â€œçº³ç±³â€æ—¶ï¼Œèƒ½å¦æƒ³è±¡å®ƒä¸â€œå¾®ç±³â€æˆ–â€œæ¯«ç±³â€çš„ç›¸å¯¹å¤§å°ï¼Ÿ è¿™ç§ç›´è§‰èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£æ–°é—»æŠ¥é“ã€åˆ†ææ•°æ®ã€è¯„ä¼°é£é™©ï¼Œå¹¶åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ã€‚ æ•°å­—å°ºåº¦äº¤äº’æ•°è½´ ","date":"2025-04-19","objectID":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/:5:0","tags":["CheatSheet"],"title":"æ•°å­—ç›´è§‰","uri":"/posts/%E6%95%B0%E5%AD%97%E7%9B%B4%E8%A7%89/"},{"categories":["AI"],"content":" Once upon a time, there was a mountain. è¾“å…¥æç¤º âœ Once upon a time, there was a mountain. ç”Ÿæˆç»“æœ âœ Once upon a time, there was a mountain. In the sky, there was a big, round ball. A little boy named Tim and his mom went to the park to play. The sun was shining, and the sky was blue. In the park, Tim saw a big tree. He wanted to play near it. His mom said, â€œOkay, but be careful.â€ Tim was happy. He played near the tree. He got up and down. While playing, Tim saw a small bird. The bird was sad. Tim said, â€œThe bird has a hurt wing. Can you help me?â€ The bird said, â€œYes, I can help you.â€ Tim took the bird to his mom. He gave her a magic rock. The bird said, â€œThank you, Tim. You are a good friend.â€ Now, Tim and the bird were friends. They played together every day. ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:0:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Intro è‡ªä» 2022 å¹´ ChatGPT å‘å¸ƒåï¼ŒLLM å¼€å§‹å¸­å·ä¸–ç•Œï¼Œä¿¨ç„¶æœ‰ä¸€æ¬¡æ–°çš„ç§‘æŠ€æµªæ½®ä¹‹åŠ¿ã€‚å¤§æ¨¡å‹èµ„æœ¬å¸‚åœºä»¥æ¯å¹´è¿‘ 40% çš„é€Ÿåº¦ç‹‚é£™çªè¿›ï¼Œåœ¨ 2025 å¹´åˆå·²æ¥è¿‘ 77 äº¿ç¾å…ƒï¼Œä¸”é¢„è®¡åœ¨ 2034 å¹´å¯è¾¾åƒäº¿çº§åˆ«ï¼Œä¸ä¹‹ç›¸æ¯”ï¼Œè¾ƒä¸ºæˆç†Ÿä½†åº”ç”¨é¢†åŸŸç•¥çª„çš„çš„è®¡ç®—æœºè§†è§‰å¸‚åœºè§„æ¨¡ä¹Ÿæœ‰ 250 äº¿ç¾å…ƒã€‚ èµ„æœ¬å¸‚åœºçš„ç«çƒ­ä¸å¦åœ¨äºåº”ç”¨çš„å‰æ™¯ï¼Œè€Œå¤§æ¨¡å‹çš„åº”ç”¨å‰æ™¯ä¹Ÿæ˜¾ç„¶ååˆ†å¹¿é˜”ã€‚ç°åœ¨è®¸å¤š app å·²æ¥å…¥ AIï¼Œ å¢å¼ºåŠŸèƒ½ï¼Œè€Œ RAG, Agent ç­‰æŠ€æœ¯ä¹Ÿæ­£åœ¨è¿…é€Ÿå‘å±•ï¼Œæ›´ä½•å†µæœªæ¥è¿˜æœ‰å¤§æ¨¡å‹è¾…åŠ©æ™ºèƒ½åˆ¶é€ çš„å¹¿é˜”çš„åœºæ™¯ã€‚ åº”ç”¨å‰æ™¯å¼•æ¥èµ„æœ¬æŠ•èµ„ï¼Œèµ„æœ¬æŠ•èµ„å¼•èµ·ç¡¬ä»¶ï¼Œç®—æ³•ï¼Œä»¥åŠç³»ç»Ÿçš„å…¨æ–¹é¢å‘å±•ã€‚åœ¨æ‘©å°”å®šå¾‹å¤±æ•ˆä¹‹åï¼Œé¢†åŸŸä¸“ç”¨ç¡¬ä»¶æˆä¸ºäº†æå‡è®¡ç®—åŠ›çš„ç»å¦™æ³•é—¨ã€‚è‹±ä¼Ÿè¾¾çš„ GPU é’ˆå¯¹è®­ç»ƒå’Œæ¨ç†åšäº†è®¸å¤šä¼˜åŒ–ï¼Œåä¸ºï¼ŒGoogle ä¹Ÿæ¨å‡ºäº†è®¸å¤šæ·±åº¦å­¦ä¹ ä¸“ç”¨è®¡ç®—è®¾å¤‡ã€‚ç®—æ³•å±‚é¢ï¼Œæ¨¡å‹ç»“æ„å’Œå‚æ•°é‡ä¹Ÿéƒ½åœ¨ä¸æ–­æ¼”åŒ–ã€‚è€Œç³»ç»Ÿå±‚é¢ï¼Œä¹Ÿä¸æ–­æœ‰æ–°æŠ€æœ¯å’Œæ–°é¡¹ç›®æ¥é€‚åº”æ–°çš„æ¨¡å‹å’Œç¡¬ä»¶ã€‚åœ¨è¿™å‡ è€…çš„å…±åŒåä½œä¸‹ï¼Œå³ä½¿ç§‘æŠ€æ ‘ç‚¹åäº†ï¼Œå…¶æ¢ç´¢ä¹‹æ·±ä¹Ÿè¶³ä»¥æ”¹å˜ä¸–ç•Œäº†ã€‚ åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œæ— è®ºæ˜¯å‡ºäºå¥½å¥‡è¿˜æ˜¯åŠŸåˆ©ï¼Œå­¦ä¹ å¤§æ¨¡å‹ï¼Œç†è§£å…¶åŸºæœ¬åŸç†å°±æ˜¾å¾—æœ‰å¿…è¦äº†ã€‚å› æ­¤ï¼Œæˆ‘å‚è€ƒcs336è¯¾ç¨‹,ï¼Œè¯•ç€ build a transformer-language model from scratchã€‚åœ¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¹Ÿå¤§é‡å‚è€ƒäº† Umar Jamil çš„ live coding ä»¥åŠæå®æ¯…çš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ã€‚ æœ€ç»ˆæˆ‘ä½¿ç”¨ TinyStory æ•°æ®é›†ï¼Œåœ¨ä¸€å¼  4090 æ˜¾å¡ä¸ŠèŠ±è´¹ä¸€ä¸ªåŠå°æ—¶è®­ç»ƒå‡ºäº†ä¸€ä¸ªè®²æ•…äº‹æ¨¡å‹ï¼Œä¸”ç§°ä¹‹ä¸º StoryLMã€‚æ–‡ç« å¼€å¤´çš„æ•…äº‹ç»­å†™å°±ç”± StoryLM ç”Ÿæˆã€‚ è¿™ç¯‡æ–‡ç« ä»‹ç»è¯¥æ¨¡å‹æ„å»ºçš„å…¨è¿‡ç¨‹ï¼Œå¹¶è§£é‡Šç›¸å…³æ¦‚å¿µã€‚ç›®æ ‡è¯»è€…æ˜¯æœ‰ä¸€äº›æ·±åº¦å­¦ä¹ åŸºç¡€çš„è®¡ç®—æœºä¸“ä¸šå­¦ç”Ÿï¼ˆä¹Ÿå°±æ˜¯å¹´åˆçš„æˆ‘ï¼‰ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:1:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Architecture é¦–å…ˆï¼Œä»å®è§‚ä¸Šæ¥ä»‹ç»å¤§æ¨¡å‹çš„ç»“æ„ä»¥åŠå…¶ç”Ÿå‘½å‘¨æœŸã€‚ å°±åƒä»»ä½•æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸€æ ·ï¼Œå¤§æ¨¡å‹çš„è®­ç»ƒç¦»ä¸å¼€æ¨¡å‹ç»“æ„ï¼Œä¼˜åŒ–å™¨ï¼ŒæŸå¤±å‡½æ•°ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ã€‚ä¼˜åŒ–å™¨ä¸€èˆ¬ä¸ºå¸¸è§çš„ AdamWï¼ŒæŸå¤±å‡½æ•°ä¸ºåˆ†ç±»ä»»åŠ¡å¸¸ç”¨çš„äº¤å‰ç†µï¼Œè€Œå‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹çš„ç»“æ„éƒ½åŸºäº Transformerã€‚Transformer å¯åˆ†ä¸ºç¼–ç å™¨å’Œè§£ç å™¨ä¸¤éƒ¨åˆ†ï¼Œæœ€åˆç”¨äºè¯­è¨€ç¿»è¯‘ç­‰ä»»åŠ¡ã€‚ç¼–ç å™¨ç†è§£æºè¯­è¨€ï¼Œè‡ªå›å½’è§£ç å™¨ç”Ÿæˆç›®æ ‡è¯­è¨€ã€‚è€Œåœ¨ç”Ÿæˆå¼è¯­è¨€æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ä»…ä»…ä¿ç•™è§£ç å™¨å³å¯ã€‚ åœ¨å®é™…è®­ç»ƒä¸­ï¼Œä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ï¼Œè®­ç»ƒéš¾ä»¥è¿›è¡Œä¸‰ä¸ªé—®é¢˜ï¼Œä¼šå¯¹ä¸Šé¢ä¸‰ä¸ªç»„æˆéƒ¨åˆ†åšè¯¸å¤šè°ƒæ•´ é™¤äº†ä¸Šé¢ä¸‰è€…ä¹‹å¤–ï¼Œè®­ç»ƒæ•°æ®ä¹Ÿéœ€è¦åšä¸€äº›å¤„ç†ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ Tokenizer åŠ ä¸Šè¯åµŒå…¥æŠŠå¥å­å˜ä¸ºæ¨¡å‹èƒ½å¤Ÿç†è§£çš„å½¢å¼ã€‚å…·ä½“å¯è§ Tokenizer å’Œ Model ä¸¤å°èŠ‚ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä¸€ä¸ªå¥å­ä¼šè¢«åˆ‡åˆ†æˆè®¸å¤š tokenï¼Œæ¯ä¸ª token ä¼šè¢«è½¬åŒ–ä¸ºä¸€ä¸ªè¯å‘é‡ã€‚è¾“å…¥ä¸€ä¸ªå¥å­åï¼Œæ¨¡å‹ä¼šè¾“å‡ºä¸€ä¸ªè¡¨ç¤ºæ¥åœ¨è¯¥å¥å­åå¯èƒ½çš„ token çš„æ¦‚ç‡åˆ†å¸ƒã€‚ StoryLM çš„è®­ç»ƒæ•°æ®åªæœ‰2GBï¼Œè€ŒçœŸå®ä¸–ç•Œå¤§æ¨¡å‹çš„è®­ç»ƒæ•°æ®åŠ¨è¾„æ•°TBï¼Œä¸ºäº†çˆ¬å–å¹¶æ¸…æ´—å¾—åˆ°è¿™äº›è®­ç»ƒæ•°æ®ï¼ŒçœŸå®çš„ LLM system ä¹ŸåŒ…å«äº†è®¸å¤šæ•°æ®å¤„ç†ç›¸å…³æŠ€æœ¯ã€‚æœ¬æ–‡æš‚æ—¶ä¸æ¶‰åŠã€‚ åŒæ—¶ StoryLM çš„å‚æ•°é‡ä»…ä¸º 22Mï¼Œè€ŒçœŸå®çš„å¤§æ¨¡å‹å‚æ•°é‡å‡ä¸º Billion ä»¥ä¸Šï¼Œå› æ­¤å…¶è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹çš„æ€§èƒ½ä¼˜åŒ–ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚æˆ‘ä¼šåœ¨åç»­æ–‡ç« ä»‹ç»ç›¸å…³ä¼˜åŒ–ã€‚ æœ€åï¼Œé€šè¿‡å¤§é‡è¯­æ–™è¿›è¡Œçš„è‡ªç›‘ç£è®­ç»ƒåªæ˜¯é¢„è®­ç»ƒï¼Œå¾—åˆ°çš„æ˜¯åŸºåº§æ¨¡å‹ï¼Œåªå…·æœ‰ç»­å†™èƒ½åŠ›ã€‚ä¸ºäº†ä½¿æ¨¡å‹æ›´åƒè¯­è¨€åŠ©æ‰‹ï¼Œè¿˜éœ€è¦è¿›è¡Œç›‘ç£å¾®è°ƒä¸ RLHFã€‚ä¸è¿‡æˆ‘ä»¬ç°åœ¨åªè€ƒè™‘è®­ç»ƒåŸºåº§æ¨¡å‹ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:2:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Tokenizer ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:3:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Byte-Pair Encoding Tokenizer çš„ç›®çš„æ˜¯æŠŠå¥å­è½¬åŒ–ä¸º Token åºåˆ—ï¼Œæ¯ä¸ª Token éƒ½å¯ä»¥ç”¨ä¸€ä¸ªæ•°å­—è¡¨ç¤ºï¼Œä»¥ä¾¿äºæ¨¡å‹å¤„ç†ã€‚ä¸€ä¸ªæœ€ç®€å•çš„æƒ³æ³•æ˜¯ word-level tokenizerï¼Œä½†æ˜¯ word å¤ªå¤šä¼šå¯¼è‡´è¯æ±‡è¡¨è¿‡å¤§ï¼Œé™ä½è®¡ç®—æ•ˆç‡ã€‚è€Œä¸”ä¼šå°†å¦‚ â€œplayedâ€ â€œplayingâ€ ç¼–ç ä¸ºå®Œå…¨ä¸åŒçš„ä¸¤ä¸ªTokenï¼Œæ²¡èƒ½è€ƒè™‘åˆ°ä¸¤è€…ä¹‹é—´å…³ç³»ã€‚å› æ­¤ï¼Œå°±æœ‰äº†ç¬¬äºŒä¸ªæƒ³æ³•â€”â€” byte-level tokenizerï¼šæ—¢ç„¶æ‰€æœ‰è¯­è¨€åœ¨è®¡ç®—æœºä¸­çš„è¡¨ç¤ºéƒ½æ˜¯å­—èŠ‚åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠå­—èŠ‚åºåˆ—é€ç»™æ¨¡å‹å°±å¥½äº†ï¼ä½†æ˜¯å®ƒä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™ç§ç¼–ç æ–¹å¼æœ‰å¤ªå¤šå†—ä½™ï¼Œword level ä¸­çš„ä¸€ä¸ª Token å¯èƒ½åœ¨ byte level ä¸­å°±å¯¹åº”äº†å¥½å‡ ä¸ª Tokenï¼Œè¿™æ ·ä¹Ÿä¼šé™ä½è®¡ç®—æ•ˆç‡ã€‚ è€Œ Byte Pair Encoding æ˜¯ä¸€ç§æŠ˜ä¸­çš„ç®—æ³•ï¼šé¦–å…ˆåŸºäº byte-level tokenizerï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å¾ˆå°çš„è¯æ±‡è¡¨å¤„ç†å„ç§è¯­è¨€äº†ï¼Œä½†åŒæ—¶ä¸ºäº†é˜²æ­¢ Token æ•°ç›®è¿‡å¤šï¼ŒBPE ä¼šä¸æ–­å°†æœ€å¸¸è§çš„ Token Pair åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„ Tokenï¼Œç›´åˆ°è¾¾åˆ°é¢„è®¾çš„è¯æ±‡è¡¨æ•°ç›®ä¸Šé™ï¼Œä»¥å‹ç¼© Token é•¿åº¦ã€‚ åœ¨å®è·µä¸­ï¼ŒBEPæœ‰è®­ç»ƒå’Œè¿è¡Œä¸¤ä¸ªè¿‡ç¨‹ã€‚è®­ç»ƒé˜¶æ®µä¼šå­¦ä¹ åˆ°å“ªäº› Token å¯ä»¥åˆå¹¶ï¼Œæ„å»ºè¯æ±‡è¡¨ã€‚è€Œè¿è¡Œé˜¶æ®µæ¥å—ä¸€ä¸ªå¥å­ï¼Œæ ¹æ®è®­ç»ƒå¥½çš„è¯æ±‡è¡¨å°†å…¶ç¼–ç ä¸º Token æ•°ç»„ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:3:1","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"BPE Implementation Train BPE é¦–å…ˆè€ƒè™‘è®­ç»ƒã€‚è®­ç»ƒæ—¶æˆ‘ä»¬è¦ä¸æ–­è¯†åˆ«æœ€é¢‘ç¹å‡ºç°çš„ Token-Pair å¹¶å°†å…¶åˆå¹¶ã€‚æœ€ç®€å•çš„æš´åŠ›ç®—æ³•å°±æ˜¯æ¯æ¬¡åˆå¹¶æ—¶éƒ½æ‰«æä¸€éï¼Œæ‰¾åˆ°æœ€å‡ºç°æœ€å¤šçš„ Pairã€‚å‡è®¾ n ä¸ºè¯­æ–™é•¿åº¦ï¼Œm ä¸ºè¯æ±‡è¡¨å¤§å°ä¸Šé™ã€‚æ˜¾ç„¶è¿™ä¸ª O(mn) çš„ç®—æ³•å¼€é”€å¤ªå¤§ã€‚ ä½†æ˜¯è€ƒè™‘åˆ°æ¯åˆå¹¶ä¸€ä¸ª Pair åï¼Œåªæœ‰ä¸è¿™ä¸ª Pair ç›¸é‚»çš„ Pair æ•°ç›®æ‰äº§ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾è®¡ç¨‹åºï¼š æ•°æ®ç»“æ„ï¼š å°† Pair ä¸å…¶å¯¹åº” count å­˜åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ PairCounter ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é¢‘ç‡æœ€é«˜çš„ Pairï¼Œå¹¶æ–¹ä¾¿åœ°è¿›è¡Œå¢åˆ æŸ¥æ”¹ æ¯”å¦‚ å­˜å‚¨å­æ ‘æœ€å€¼çš„å¹³è¡¡æœç´¢æ ‘ æ”¯æŒO(logn)åˆ é™¤çš„å † å»¶è¿Ÿåˆ é™¤æ³•ï¼ˆåŸå †+åˆ é™¤å †ï¼‰ å³æ—¶åˆ é™¤æ³•ï¼ˆå“ˆå¸Œè¡¨è®°å½•å…ƒç´ ç´¢å¼•ï¼‰ è®­ç»ƒè¯­æ–™è½¬åŒ–è€Œæ¥çš„ Token é“¾è¡¨ï¼ŒL ä¸€ä¸ªä» Pair åˆ°å…¶å‡ºç°ä½ç½®çš„ mapï¼ŒM ç®—æ³•ï¼š æ¯æ¬¡è·å–æœ€é¢‘ç¹ Pair å¢åŠ åˆ°è¯æ±‡è¡¨ä¸­ é€šè¿‡ M ä¿®æ”¹ Token é“¾è¡¨ L é€šè¿‡ Token é“¾è¡¨ L ä¿¡æ¯æ›´æ–° PairCounter å’Œ M ä½†è€ƒè™‘åˆ°å¤§éƒ¨åˆ†è¯­è¨€ä¸­å¸¸è§å•è¯åªä¸ºå‡ åƒä¸ªï¼Œå¦‚æœå¿½ç•¥è·¨è¯ Pairï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘æŠŠ Token é“¾è¡¨ L æ›¿æ¢ä¸ºä¸€ä¸ª ä»å•è¯åˆ°è¯¥å•è¯ Token é“¾çš„ map åŠ ä¸Šä¸€ä¸ªä»å•è¯åˆ°è¯¥å•è¯åœ¨è®­ç»ƒé›†ä¸­å‡ºç°æ•°ç›®çš„mapã€‚è¿™æ ·ï¼Œå¹¶æŠŠ M ä¿®æ”¹ ä» Pair åˆ°å…¶å‡ºç°çš„å•è¯çš„ mapã€‚è¿™æ ·ï¼Œåˆèƒ½å¤§å¤§é™ä½å®é™…è®¡ç®—çš„å¼€é”€ã€‚ è¿™æ ·ï¼Œå‡è®¾k1ä¸ºæœ€å¤§ Pair æ•°ç›®ï¼Œk2ä¸ºæœ€å¤§å•è¯æ•°ç›®ï¼Œè¯¥ç®—æ³•å°±å¯ä»¥åœ¨O(n + mlogk1 + mk2)çš„æ—¶é—´å†…å®Œæˆè®­ç»ƒã€‚ æ­¤å¤–ï¼Œè¿™ä¸ªç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œå®ç°æ—¶è¦æ³¨æ„ï¼š åŠæ—¶æŠŠå¤§å‡½æ•°æ‹†åˆ†ä¸ºå°å‡½æ•°ï¼Œæ–¹ä¾¿ç†è§£ é‡‡ç”¨ OOP çš„è®¾è®¡æ–¹æ³•ï¼ŒæŠŠæ•°æ®ç»“æ„å’Œå¯¹å…¶æ“ä½œçš„æ–¹æ³•ç»“åˆèµ·æ¥ Run BPE è®­ç»ƒå®Œæˆåï¼Œå®é™…è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬è¦ç¼–ç çš„è¯­æ–™æ›´å¤šï¼Œå› æ­¤æ›´è¦è€ƒè™‘æ€§èƒ½é—®é¢˜ã€‚ é¦–å…ˆæ˜¯ç®—æ³•ä¸Šçš„æ€§èƒ½ã€‚ å‡è®¾è¯­æ–™é•¿åº¦ä¸ºnï¼Œè¯æ±‡è¡¨é•¿åº¦ä¸ºmï¼Œç®€å•çš„æš´åŠ›ç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¾ç„¶ä¸º O(mn)ã€‚ è€ƒè™‘åˆ°æˆ‘ä»¬åœ¨è®­ç»ƒæ—¶ï¼Œåˆå¹¶çš„ Pair éƒ½å¤„äºä¸€ä¸ªå•è¯å†…ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·è®¾è®¡ç¨‹åºï¼š æ•°æ®ç»“æ„ï¼š ä¸€ä¸ªä»£è¡¨åŸè¯­æ–™çš„å•è¯ ID List ä¸€ä¸ªä»å•è¯ ID åˆ°è¯¥å•è¯ Token é“¾çš„ mapï¼ŒM ä¸€ä¸ªä» Pair åˆ°å…¶å‡ºç°çš„å•è¯çš„ map ç®—æ³•ï¼š ä»¿ç…§è®­ç»ƒè¿‡ç¨‹ï¼Œåˆå§‹åŒ–è¿™äº›æ•°æ®ç»“æ„ æ ¹æ®è®­ç»ƒè¿‡ç¨‹å¾—åˆ°çš„è¯æ±‡è¡¨ï¼Œä¸æ–­è¿›è¡Œ Pair åˆå¹¶ æ ¹æ®å•è¯ ID List å’Œ M å¾—åˆ°æœ€ç»ˆç¼–ç ç»“æœ å‡è®¾kä¸ºæœ€å¤§å•è¯æ•°ç›®ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸º O(n + mk) å…¶æ¬¡æ˜¯å·¥ç¨‹ä¸Šçš„æ€§èƒ½ã€‚ è€ƒè™‘åˆ° TinyStory è¯­æ–™æ–‡ä»¶åœ¨ GB çº§åˆ«ï¼Œæˆ‘ä»¬æ²¡åŠæ³•ä¸€æ¬¡æŠŠæ‰€æœ‰å†…å®¹éƒ½æ”¾åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤åªèƒ½process incrementally, save incrementallyã€‚ è€ƒè™‘åˆ°ç¼–ç æ—¶ä¼šåœ¨è¯æ±‡è¡¨ä¸­æŒ‡å®šä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œè€Œ Pair æ˜¯ä¸èƒ½è·¨åˆ†éš”ç¬¦çš„ã€‚æˆ‘ä»¬å°±å¯ä»¥æ¯æ¬¡ä»æºæ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ª chunkï¼Œæ‰¾åˆ°è·æœ«å°¾æœ€è¿‘çš„åˆ†éš”ç¬¦ï¼Œå¹¶å°†ä¹‹åçš„å†…å®¹æ”¾è¿› bufferã€‚ç„¶åå¤„ç†è¯¥ chunk å¹¶å†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚å¤„ç†ç¬¬äºŒä¸ª chunk å‰å…ˆåœ¨å®ƒä¹‹å‰åŠ ä¸Š buffer ä¸­å†…å®¹ã€‚ def encode_file(self, file_path: str, out_path: str): with open(file_path, \"r\") as f: encoded = [] i = 0 while True: chunk = f.read(self.chunk_size) if not chunk: break i += 1 encoded_chunk = self._process_chunk(chunk) encoded.extend(encoded_chunk) # å¢é‡ä¿å­˜ï¼ˆæ¯å¤„ç†100ä¸ªåˆ†å—å†™å…¥ä¸€æ¬¡ï¼‰ if len(encoded) \u003e 100*self.chunk_size: self._save_incrementally(encoded, out_path) encoded = [] # å¤„ç†æœ€ç»ˆç¼“å†²åŒºçš„å‰©ä½™æ•°æ® if self.buffer: final_tokens = self._process_chunk(\"\") encoded.extend(final_tokens) self._save_incrementally(encoded, out_path) ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:3:2","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Model å½“ Tokenizer æŠŠè¾“å…¥è½¬åŒ–ä¸º int æ•°ç»„åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠè¯¥æ•°ç»„è¾“å…¥æ¨¡å‹ï¼Œå¹¶å¾—åˆ° logit äº†ã€‚ ä¸‹å›¾æ˜¯ TinyStory çš„æ¨¡å‹ç»“æ„ï¼š ä¸‹é¢æ˜¯å…¶ä»£ç å®ç°ï¼š class TransformerLM(nn.Module): def __init__( self, vocab_size: int, context_length: int, d_model: int, num_layers: int, num_heads: int, d_ff: int, attn_pdrop: float, residual_pdrop: float, **kwargs ): super().__init__() self.embed = nn.Embedding(vocab_size, d_model) self.pos_embed = nn.Parameter(torch.zeros(context_length, d_model)) self.drop = nn.Dropout(residual_pdrop) self.layers = nn.Sequential(*[TransformerBlock(d_model, num_heads, d_ff, attn_pdrop, residual_pdrop) for _ in range(num_layers)]) self.ln_f = RMSNorm(d_model) self.head = nn.Linear(d_model, vocab_size, bias=False) self.context_length = context_length def forward(self, x): # x (batch_size, context_length) x = self.embed(x) x = x + self.pos_embed[:x.size(1), :] x = self.drop(x) x = self.layers(x) x = self.ln_f(x) x = self.head(x) return x å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡å‹åŸºæœ¬ç”± Embeddingï¼ŒAttentionï¼ŒFFNï¼ŒLinear ä»¥åŠè´Ÿè´£æŠŠå‡½æ•°å˜å¹³æ»‘çš„ Normï¼ŒDropout å’Œ Residual Connection ç»„æˆã€‚ä¸åŒçš„å¤§æ¨¡å‹ç»“æ„ä¹Ÿå¤§ä½“ç±»ä¼¼ã€‚ Embedding å±‚è´Ÿè´£ç”Ÿæˆè¯å‘é‡ï¼ŒTransformerBlock æ˜¯ä¸»è¦è®¡ç®—å‘ç”Ÿçš„åœ°æ–¹ï¼Œè€Œæœ€åçš„ Linear å±‚è´Ÿè´£ç”Ÿæˆä¸‹ä¸€ä¸ª Token çš„æ¦‚ç‡åˆ†å¸ƒã€‚ ä¸‹é¢åˆ†åˆ«ä»‹ç»æ¯ä¸ªå±‚ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:4:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Positional Embedding è¿™ä¸ª layer è´Ÿè´£å°† Token è½¬åŒ–ä¸ºè¯å‘é‡ï¼ˆWord Vectorï¼‰ï¼Œå¹¶åœ¨é™„åŠ ä¸Šä½ç½®ä¿¡æ¯ã€‚ è¯å‘é‡å¤„äºä¸€ä¸ªé«˜ç»´è¯­ä¹‰ç©ºé—´ä¸­ï¼Œä¸¤ä¸ªå‘é‡é—´çš„ä½ç½®å…³ç³»å³å¯è¡¨ç¤ºä»–ä»¬çš„è¯­ä¹‰å…³ç³»ã€‚å¦‚ V(æ³•å›½)-V(å·´é») = V(å¾·å›½)-V(æŸæ—)ã€‚ å…·ä½“çš„è¯å‘é‡ä¿¡æ¯æˆ‘ä»¬åœ¨ç¥ç»ç½‘ç»œä¸­å­¦ä¹ å³å¯ã€‚æˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯æŠŠ Token è½¬åŒ–ä¸ºé«˜ç»´å‘é‡ã€‚è¿™ä¸ªåŠŸèƒ½ç”± nn.Embeding å®ç°ã€‚è¯¥å±‚ä¼šç»´æŠ¤ä¸€ä¸ªå½¢çŠ¶ä¸º (num_embeddings, embedding_dim) çš„æŸ¥æ‰¾è¡¨ï¼ŒæŠŠæ¯ä¸€ä¸ª Token éƒ½æ˜ å°„ä¸ºé«˜ç»´å‘é‡ã€‚å…·ä½“çš„å‚æ•°åœ¨æ¢¯åº¦ä¸‹é™æ—¶æ›´æ–°ã€‚ é™¤äº†è¯åµŒå…¥å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®°å½• Token çš„ä½ç½®ä¿¡æ¯ï¼Œè¿™ä¸ªåŠŸèƒ½ç”± Positional Embedding å®Œæˆã€‚ Positional Embedding å±‚ä¼šç»™æ¯ä¸ªä¸åŒä½ç½®çš„è¯éƒ½ç”Ÿæˆä¸€ä¸ªè¡¨ç¤ºä½ç½®çš„å‘é‡ï¼Œè¯¥å‘é‡ä¸ Token Embedding ç”Ÿæˆçš„å‘é‡ç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¯å‘é‡ã€‚ Positional Embedding å­˜åœ¨å¤šç§å®ç°æ–¹æ³•ï¼Œå…¶ä¸­æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPEï¼‰å·²è¢«è¯æ˜æ•ˆæœæœ€ä¼˜ã€‚ä½†é‰´äºå…¶å®ç°å¤æ‚åº¦è¾ƒé«˜ï¼Œæˆ‘ä»¬é€‰æ‹©é‡‡ç”¨åŸºç¡€çš„ Absolute Positional Embeddingsã€‚å…·ä½“å®ç°æ–¹å¼ä¸ºï¼šåˆ›å»ºä¸€ä¸ªå¯è®­ç»ƒçš„ä½ç½®åµŒå…¥çŸ©é˜µï¼Œå…¶è¡Œæ•°è®¾ç½®ä¸ºé¢„å®šä¹‰çš„ä¸Šä¸‹æ–‡æœ€å¤§é•¿åº¦ï¼ˆcontext_lengthï¼‰ã€‚åœ¨æ¨¡å‹å‰å‘ä¼ æ’­æ—¶ï¼Œæ ¹æ®å®é™…è¾“å…¥åºåˆ—é•¿åº¦å¯¹çŸ©é˜µè¿›è¡ŒåŠ¨æ€æˆªå–ï¼Œå¹¶ä¸è¯åµŒå…¥å‘é‡è¿›è¡Œé€å…ƒç´ ç›¸åŠ ã€‚å…¶ä¼˜ç‚¹æ˜¯ä½ç½®ç¼–ç å¯ä»¥ç”±å­¦ä¹ å¾—åˆ°ï¼Œæ•ˆæœå¥½ï¼Œç¼ºç‚¹æ˜¯ä¸èƒ½å¤„ç†é•¿åº¦è¶…å‡º context_length çš„å¥å­ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:4:1","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"TransformerBlock ä¸Šå›¾æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ Transformerï¼Œå…¶æ ¸å¿ƒç»„ä»¶ç”±ä¸¤ä¸ªï¼ŒSelf-Attention å’Œ FFNã€‚Attention è´Ÿè´£æ•æ‰åºåˆ—ä¿¡æ¯ï¼Œå°†å•ç‹¬çš„è¯å‘é‡å˜ä¸ºè¯­å¢ƒä¸­çš„è¯å‘é‡ï¼ˆçœŸæ­£çš„èƒ½æŒ‡ï¼‰ï¼›è€Œ FFN è´Ÿè´£å­˜å‚¨çŸ¥è¯†ä¿¡æ¯ï¼Œæ˜¯æ•´ä¸ª LM ä¸­å‚æ•°é‡æœ€å¤šçš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯è®­ç»ƒæ¨ç†æ—¶è®¡ç®—é‡æœ€å¤§çš„åœ°æ–¹ã€‚ Attention å¯¹äºå˜é•¿åºåˆ—ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ç§åŠæ³•æ¥è€ƒè™‘åºåˆ—ä¿¡æ¯ã€‚åœ¨ attention ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ RNN æ¥å®Œæˆè¿™ç‚¹ã€‚RNN ä¼šå¼•å…¥éšçŠ¶æ€ï¼Œæ¯ä¸ª Token çš„è®¡ç®—éƒ½ä¼šä¾èµ–å‰ä¸€ä¸ª Token çš„éšçŠ¶æ€ï¼Œå¹¶é‡æ–°å†™å…¥éšçŠ¶æ€ï¼Œä»¥æ­¤æ¥ä¼ é€’åºåˆ—ä¿¡æ¯ã€‚ ä½†æ˜¯å› ä¸ºéšçŠ¶æ€çš„ç›¸é‚»ä¾èµ–å…³ç³»ï¼ŒRNN éš¾ä»¥å¹¶è¡ŒåŒ–ï¼Œä¸”éš¾ä»¥æ•æ‰é•¿è·ç¦»ä¾èµ–ï¼Œå› æ­¤å°±æœ‰äº† self-attentionã€‚æœ€åˆçš„ attention çš„åœ¨ RNN è¯­è¨€æ¨¡å‹çš„ input åºåˆ—å’Œ output åºåˆ—é—´ä¼ é€’ä¿¡æ¯ï¼Œä½†æ˜¯ Transformer çš„ç ”ç©¶è€…å‘ç°è®©åºåˆ—è‡ªå·±åš self-attentionï¼Œå°±å¯ä»¥å–ä»£ RNN äº†ã€‚ è™½ç„¶ RNN æœ‰ç€ä¸Šè¿°ç¼ºç‚¹ï¼Œä½†æ˜¯å› ä¸ºå…¶æ’å®šæ¨ç†æˆæœ¬å’Œåœ¨çŸ­åºåˆ—ä¸­çš„ä½æˆæœ¬ï¼Œä¹Ÿè¢«å¹¿æ³›ä½¿ç”¨ã€‚ åœ¨ attention æœºåˆ¶ä¸­ï¼Œæˆ‘ä»¬æœ‰ Q, K, V ä¸‰ä¸ªå¯å­¦ä¹ çŸ©é˜µã€‚æ¯ä¸ªè¯å‘é‡åˆ†åˆ«ä¹˜ç€ä¸‰ä¸ªçŸ©é˜µå¾—åˆ° qï¼Œkï¼Œv ä¸‰ä¸ªå‘é‡ã€‚æ¯ä¸ªè¯çš„ q å‘é‡å’Œå…¶ä»–è¯çš„ k å‘é‡å…ˆç‚¹ç§¯å†åš softmaxï¼Œå¾—åˆ°æ³¨æ„åŠ›åˆ†æ•°ã€‚å†æ ¹æ®æ³¨æ„åŠ›åˆ†æ•°å¯¹æ‰€æœ‰ v åšåŠ æƒå’Œï¼Œå¾—åˆ° attention å€¼ã€‚æ­¤æ—¶çš„ attention å€¼å°±åŒ…æ‹¬äº†å¥ä¸­å…¶ä»–è¯çš„ä¿¡æ¯ã€‚ ä¸Šè¿°è¿‡ç¨‹å†™æˆçŸ©é˜µçš„å½¢å¼å¦‚ä¸‹ï¼š ä¸‹é¢æ˜¯å›¾ç¤ºï¼š ä½†åœ¨ decoder-only LM ä¸­ï¼Œæˆ‘ä»¬è¦é¢„æµ‹ä¸‹ä¸€ä¸ª Tokenï¼Œå› æ­¤è®¡ç®— attention æ—¶ï¼Œä¸€ä¸ª Token çš„ q åªèƒ½äºå®ƒä¹‹å‰çš„ Token çš„ k åšè®¡ç®—ï¼Œå¦åˆ™åœ¨è®­ç»ƒæ—¶å°±æå‰æ³„éœ²äº†æœªæ¥ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°æ—¶è¦åŠ ä¸Šæ©ç ï¼Œä¸éœ€è¦çš„åˆ†æ•°è®¾ç½®ä¸ºä¸€ä¸ªæå°å€¼ï¼Œè¿™æ · softmax åå…¶æ¦‚ç‡å°±æ¥è¿‘ä¸º 0 äº†ã€‚ ä¸€ä¸ª attention å¤´ï¼ˆå³ä¸€ç»„ Q,K,Vï¼‰å¯ä»¥å­¦ä¹ ä¸€ç§å…³è”æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç»„ attention å¤´æ¥å®ç°å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆMulti-Head Attentionï¼‰ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¤šå¤´æ³¨æ„åŠ›å°±æ˜¯ä½¿ç”¨å¤šä¸ª Q,K,Vè®¡ç®—å¤šä¸ª attention å€¼ï¼Œç„¶åæŠŠæ‰€æœ‰çš„ attention å€¼è¿åœ¨ä¸€èµ·ï¼Œç»è¿‡ä¸€ä¸ª Linear å±‚å¾—åˆ°æœ€åçš„ attentionã€‚ åœ¨å®é™…å®ç°ä¸­ï¼Œå¤šä¸ª Q K V å¯ä»¥æ‹¼æˆä¸€ä¸ªçŸ©é˜µï¼Œä¸€èµ·è¿ç®—ï¼Œè¿™æ ·å°±å‡å°‘äº†è®¡ç®—å¼€é”€ã€‚ def scaled_dot_product_attention(K, Q, V, mask=None, pdrop=None): # K, Q (batch_size, [num_heads,] seq_len, k_dim) # V (batch_size, [num_heads,] seq_len, v_dim) # attn_scores (batch_size, [num_heads,] seq_len, seq_len) attn_scores = torch.matmul(Q, K.transpose(-2, -1)) attn_scores = attn_scores / math.sqrt(K.shape[-1]) if mask is not None: attn_scores = attn_scores.masked_fill(mask, -1e9) attn_scores = softmax(attn_scores, dim=-1) attn_scores = attn_scores.masked_fill(mask, 0.0) else: attn_scores = softmax(attn_scores, dim=-1) if pdrop is not None: attn_scores = nn.Dropout(pdrop)(attn_scores) return torch.matmul(attn_scores, V) class MultiHeadSelfAttention(nn.Module): def __init__(self, d_model: int, num_heads: int, dropout: Optional[float] = None): super().__init__() assert d_model % num_heads == 0 self.num_heads = num_heads self.d_model = d_model self.d_k = d_model // num_heads self.w_q = nn.Linear(d_model, d_model, bias=False) self.w_k = nn.Linear(d_model, d_model, bias=False) self.w_v = nn.Linear(d_model, d_model, bias=False) self.w_o = nn.Linear(d_model, d_model, bias=False) self.dropout = dropout def forward( self, in_features: torch.FloatTensor, ): Q = self.w_q(in_features) K = self.w_k(in_features) V = self.w_v(in_features) batch_size, seq_len, _ = Q.size() Q = Q.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2) K = K.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2) V = V.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2) mask = torch.triu(torch.ones(seq_len, seq_len, device=K.device), diagonal=1).bool() attn_scores = scaled_dot_product_attention(K, Q, V, mask, self.dropout) attn_scores = attn_scores.transpose(1, 2).contiguous().view(batch_size, seq_len, -1) return self.w_o(attn_scores) FFN FFN å±‚æ˜¯ Transformer ä¸­è®¡ç®—æœ€å¤šçš„åœ°æ–¹ã€‚è¿™é‡Œå¯ä»¥æ§åˆ¶çš„å˜é‡æœ‰ï¼š éšè—å±‚çš„ç»´åº¦ æ¿€æ´»å‡½æ•°çš„é€‰æ‹© class PointwiseFeedForward(nn.Module): def __init__(self, d_model: int, d_ff: int): super().__init__() self.w1 = nn.Linear(d_model, d_ff, bias=False) self.w2 = nn.Linear(d_ff, d_model, bias=False) def forward(self, x): return self.w2(gelu(self.w1(x))) æ­¤å¤–ï¼Œç°åœ¨è®¸å¤š LLM åœ¨ FFN å±‚é‡‡ç”¨ MoE æ¶æ„ã€‚å…³é”®åœ¨äºï¼ŒæŠŠ FFN æ‹†æˆè®¸å¤šå° FFNï¼Œè¿è¡Œæ—¶é€‰æ‹©ä¸€ä¸ª FFN ï¼ˆä¸“å®¶/exportï¼‰ä¼ æ’­ã€‚è¿™æ ·å°±èƒ½ä¿è¯æ¨¡å‹å‚æ•°çš„åŒæ—¶æå‡æ¨ç†é€Ÿåº¦ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:4:2","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Others æ¨¡å‹å‰©ä¸‹çš„ç»„ä»¶è¿˜åŒ…æ‹¬ï¼ŒRMSNormï¼ŒResidual Connectionï¼Œä»¥åŠ Dropoutã€‚ RMSNorm å’Œ Residual Connection éƒ½å¯ä»¥é¿å…æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼Œä¿è¯å‡½æ•°çš„ Lipschitz è¿ç»­æ€§è´¨ã€‚ è€Œ Dropout å±äºä¸€ç§æ­£åˆ™åŒ–æ–¹æ³•ï¼Œé€šè¿‡éšæœºå°†æŸäº›å‚æ•°ç½®ä¸º 0ï¼Œæ¥é¿å…æ¨¡å‹è¿‡åˆ†ä¾èµ–æŸäº›å‚æ•°ï¼Œä»è€Œä¿è¯äº†å…¶æ³›åŒ–æ€§ã€‚ æ­¤å¤–ï¼Œæ¨¡å‹å‚æ•°çš„åˆå§‹åŒ–ä¹Ÿååˆ†é‡è¦ã€‚æœ‰è®¸å¤šå®éªŒè¡¨ç¤ºåˆå§‹åŒ–çš„å¥½åå¯¹äºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹æœ‰å¾ˆå¤§å½±å“ï¼Œå¹¶ä¸”è®­ç»ƒç»“æœä¸åˆå§‹åŒ–åå·®å¹¶ä¸å¤§ã€‚é€šè¿‡åˆç†çš„åˆå§‹åŒ–ï¼ˆæ¯”å¦‚å¯¹äºæ–¹å·®ï¼Œå‡å€¼çš„è°ƒæ•´ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¾—å‡½æ•°æ›´æ˜“äºè®­ç»ƒã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:4:3","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Train æ·±åº¦å­¦ä¹ é™¤äº†ä½œä¸º hypothesis çš„æ¨¡å‹ç»“æ„ï¼ŒæŸå¤±å‡½æ•°å’Œä¼˜åŒ–æ–¹æ³•ä¹Ÿæ˜¯è®­ç»ƒæ—¶ä¸å¯æˆ–ç¼ºçš„ç»„æˆéƒ¨åˆ†ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Cross-entropy loss åœ¨ç†µçš„å…¬å¼ä¸­ï¼Œç†µè¶Šå¤§ï¼Œåˆ†å¸ƒè¶Šå‡åŒ€ï¼ˆä¸ç¡®å®šæ€§è¶Šé«˜ï¼‰ï¼›ç†µè¶Šå°ï¼Œåˆ†å¸ƒè¶Šé›†ä¸­ï¼ˆç¡®å®šæ€§è¶Šé«˜ï¼‰ã€‚ äº¤å‰ç†µè¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼Œå¯¹äºçœŸå®åˆ†å¸ƒ p å’Œæ¨¡å‹é¢„æµ‹åˆ†å¸ƒ qï¼Œäº¤å‰ç†µçš„å…¬å¼ä¸ºï¼š è‹¥ q(x) ä¸ p(x) å®Œå…¨ä¸€è‡´ï¼Œåˆ™äº¤å‰ç†µç­‰äºç†µ H(p)ï¼Œå¦åˆ™ H(p,q)\u003eH(p)ã€‚ åœ¨è®­ç»ƒä¸­ p(x) ä¸€èˆ¬ä¸ºçœŸå®æ ‡ç­¾çš„ one-hot åˆ†å¸ƒï¼ˆä»…æ­£ç¡®ç±»åˆ«ä¸º1ï¼Œå…¶ä»–ä¸º0ï¼‰ï¼Œå› æ­¤åªç”¨è€ƒè™‘æ­£ç¡®ç±»åˆ«ã€‚å› æ­¤ï¼ŒLLM ä¸­ä½¿ç”¨çš„äº¤å‰ç†µå…¬å¼å¦‚ä¸‹ï¼š å¯¹äº one-hot åˆ†å¸ƒï¼Œç†µä¸º0ï¼Œå› æ­¤äº¤å‰ç†µçš„æœ€å°å€¼ä¹Ÿä¸º0ã€‚ åœ¨è®­ç»ƒè¯­è¨€æ¨¡å‹æ—¶ï¼Œå‡è®¾åˆå§‹çŠ¶æ€ä¸ºå‡åŒ€åˆ†å¸ƒï¼Œæ”¶æ•›çŠ¶æ€é¢„æµ‹æ­£ç¡® token æ¦‚ç‡ä¸º 0.9ï¼Œåˆ™äº¤å‰ç†µåœ¨åŒºé—´ [0.1,10.82] å†…ã€‚ ä»£ç å®ç°å¦‚ä¸‹ï¼š def cross_entropy_loss(inputs, target): max_vals = torch.max(inputs, dim=-1, keepdim=True).values shifted_inputs = inputs - max_vals exp_inputs = torch.exp(shifted_inputs) exp_inputs_sum = torch.sum(exp_inputs, dim=-1, keepdim=True) log_softmax_inputs = shifted_inputs - torch.log(exp_inputs_sum) loss = -log_softmax_inputs[torch.arange(target.shape[0]), target] return torch.mean(loss) ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:1","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"AdamW ç¥ç»ç½‘ç»œæœ€ç»å…¸çš„ä¼˜åŒ–ç®—æ³•ä¸ºéšæœºæ¢¯åº¦ä¸‹é™æ³•ã€‚AdamW åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†ï¼š ä¸€é˜¶çŸ© åŠ¨é‡ mï¼šå¯ä»¥å‡å°éšæœºbatchå¸¦æ¥çš„éœ‡è¡ äºŒé˜¶çŸ© è‡ªé€‚åº”å­¦ä¹ ç‡ vï¼šä¸åŒå‚æ•°çš„æ¢¯åº¦æ•°å€¼å¤§å°ä¸åŒï¼Œé€šè¿‡é™¤äºŒé˜¶çŸ©çš„å¼€æ”¾æ¥ä½¿å¾—æ¢¯åº¦ç¨³å®šï¼Œé¿å…å¤§æ¢¯åº¦çˆ†ç‚¸ï¼Œå°æ¢¯åº¦æ¶ˆå¤± ç¬¬å››æ­¥å¯¹å­¦ä¹ ç‡çš„è°ƒæ•´å®é™…ä¸Šæ˜¯ä¸ºäº†åº”å¯¹ä¸€å¼€å§‹ m å’Œ v å¤ªå°çš„æƒ…å†µ weight decayï¼šå‡å»å‚æ•°ï¼Œå¢å¼ºæ³›åŒ–æ€§ L2 æ­£åˆ™ä¸­ï¼Œæ­£åˆ™é¡¹æ¢¯åº¦ä¼šè¢«è‡ªé€‚åº”å­¦ä¹ ç‡ç¼©æ”¾ï¼Œå¯¼è‡´å®é™…è¡°å‡å¼ºåº¦ä¸å­¦ä¹ ç‡è€¦åˆï¼Œå½±å“æ­£åˆ™åŒ–æ•ˆæœã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:2","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Learning rate scheduling å­¦ä¹ ç‡è°ƒæ•´çš„æ ¸å¿ƒä½œç”¨æœ‰ï¼š åŠ é€ŸåˆæœŸæ”¶æ•›ï¼šè®­ç»ƒåˆæœŸä½¿ç”¨è¾ƒå¤§å­¦ä¹ ç‡ï¼Œå¿«é€Ÿé€¼è¿‘æœ€ä¼˜è§£åŒºåŸŸã€‚ é¿å…åæœŸéœ‡è¡ï¼šåæœŸé€æ­¥é™ä½å­¦ä¹ ç‡ï¼Œé˜²æ­¢åœ¨æœ€ä¼˜è§£é™„è¿‘éœ‡è¡ã€‚ é€ƒç¦»å±€éƒ¨æå°å€¼ï¼šå‘¨æœŸæ€§æˆ–çªå˜çš„è°ƒæ•´ç­–ç•¥ï¼ˆå¦‚é‡å¯ï¼‰å¯å¸®åŠ©è·³å‡ºå±€éƒ¨æœ€ä¼˜ã€‚ é€šè¿‡ä½™å¼¦å‡½æ•°å¹³æ»‘åœ°å°†å­¦ä¹ ç‡ä»åˆå§‹å€¼ï¼ˆÎ·maxï¼‰é™ä½åˆ°æœ€å°å€¼ï¼ˆÎ·minï¼‰ï¼Œå½¢æˆä¸€ä¸ªå‘¨æœŸæ€§çš„é€€ç«è¿‡ç¨‹ã€‚å…¶ç‰¹ç‚¹æ˜¯å¹³æ»‘è¿‡æ¸¡ï¼Œé¿å…å­¦ä¹ ç‡çªå˜å¯¼è‡´çš„è®­ç»ƒä¸ç¨³å®šã€‚ ä»£ç å®ç°å¦‚ä¸‹ï¼š def get_lr_cosine_schedule(t: int, alpha_max: float, alpha_min: float, Tw: int, Tc: int) -\u003e float: if t \u003c Tw and Tw \u003e 0: return alpha_max * (t / Tw) if Tw \u003c= t \u003c= Tc: ratio = (t - Tw) / (Tc - Tw) # Progress through cosine phase cosine_decay = 0.5 * (1 + math.cos(math.pi * ratio)) return alpha_min + (alpha_max - alpha_min) * cosine_decay return alpha_min ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:3","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Gradient clipping æ¢¯åº¦è£å‰ªç”¨äºæ§åˆ¶æ¢¯åº¦çš„å¤§å°ï¼Œé˜²æ­¢è®­ç»ƒè¿‡ç¨‹ä¸­å› æ¢¯åº¦çˆ†ç‚¸å¯¼è‡´çš„æ•°å€¼ä¸ç¨³å®šã€‚å®ƒé€šè¿‡é™åˆ¶æ¢¯åº¦çš„æœ€å¤§å€¼æˆ–èŒƒæ•°ï¼Œç¡®ä¿å‚æ•°æ›´æ–°æ­¥é•¿åˆç†ï¼Œä»è€Œæå‡æ¨¡å‹è®­ç»ƒçš„ç¨³å®šæ€§å’Œæ”¶æ•›æ€§ã€‚ ä»£ç å®ç°å¦‚ä¸‹ï¼š def clip_gradient(parameters, max_norm: float, eps: float = 1e-6): grads = [p.grad for p in parameters if p.grad is not None] if not grads: return device = grads[0].device total_norm = torch.norm( torch.stack([torch.norm(g.detach(), 2) for g in grads]), 2 ).to(device) scaling_factor = max_norm / (total_norm + eps) if total_norm \u003e max_norm: for grad in grads: grad.mul_(scaling_factor) ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:4","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Resource accounting ä¸€ä¸ªç®€å•çš„èµ„æºä¼°ç®—ï¼š åŸºæœ¬æƒ³æ³•ï¼šè€ƒè™‘ Y = WXï¼Œåå‘ä¼ æ’­æ—¶éœ€è¦åˆ†åˆ«å¯¹ W å’Œ X æ±‚å¯¼ï¼Œå› æ­¤åå‘ä¼ æ’­è®¡ç®—é‡çº¦ä¸ºæ­£å‘ä¼ æ’­çš„ä¸¤å€ã€‚ ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:5","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Train in Practice æŠŠä¸Šé¢æ‰€æœ‰ç»„ä»¶ç»„åˆåœ¨ä¸€èµ·åï¼Œå°±å¯ä»¥è¿›è¡Œè®­ç»ƒäº†ã€‚ å®é™…è®­ç»ƒæ—¶çš„å‚æ•°é…ç½®å¦‚ä¸‹ï¼š { // æ¨¡å‹è¶…å‚æ•° \"vocab_size\": 10000, \"context_length\": 256, \"d_model\": 512, \"num_layers\": 4, \"num_heads\": 16, \"d_ff\": 2048, \"attn_pdrop\": 0.1, \"residual_pdrop\": 0.1, // ä¼˜åŒ–å™¨è¶…å‚æ•° \"learning_rate\": 0.001, \"beta1\": 0.9, \"beta2\": 0.95, \"epsilon\": 1e-8, \"weight_decay\": 0.01, // è®­ç»ƒè¿‡ç¨‹è¶…å‚ \"batch_size\": 64, \"epochs\": 10, // å…¶ä»–è®­ç»ƒç›¸å…³å‚æ•° \"save_every\": 1000, \"save_path\": \"checkpoints/\", \"train_data\": \"valid.npy\", \"valid_data\": \"valid.npy\", \"result_model\": \"model/model.pth\", \"log_path\": \"logs/log.txt\" } å®é™…è®­ç»ƒæ—¶ï¼Œåœ¨ä¸€å¼  4090 æ˜¾å¡ä¸Šè¿è¡Œäº† 1h30minã€‚ è®­ç»ƒæ—¶å‡ºäº†è®¸å¤š bugï¼ˆæ¯”å¦‚å¥‡å¥‡æ€ªæ€ªçš„ cuda æŠ¥é”™ï¼‰ï¼Œcheckpoint éå¸¸å®ç”¨ã€‚ ä¸‹å›¾æ˜¯ loss æ›²çº¿ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ 10000 ä¸ªè¿­ä»£å loss æ›²çº¿å°±ä¸æ€åŠ¨äº†ã€‚æœ€ç»ˆ loss ä¸º 0.9105ã€‚ å¯èƒ½å› ä¸ºæ¯éš” 100 ä¸ªè¿­ä»£æ‰è®°å½•ä¸€æ¬¡å­¦ä¹ ç‡ï¼Œæ‰€ä»¥ä»å›¾ä¸­çœ‹ä¸å‡ºå‘¨æœŸæ€§ åŒæ—¶ï¼ŒTc å¯èƒ½è®¾ç½®è¿‡å°ï¼Œå¯¼è‡´åæœŸ loss é™ä¸ä¸‹å» ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:5:6","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["AI"],"content":"Run æ¨¡å‹è®­ç»ƒå¥½ä¹‹åï¼Œå°±æ˜¯æ¨ç†äº†ï¼ å½“è¾“å…¥ä¸€ä¸ªå¥å­æ—¶ï¼Œæ¨¡å‹ä¼šç”Ÿæˆè¡¨ç¤ºä¸‹ä¸€ä¸ªTokenå¯èƒ½æ€§çš„logitså€¼ã€‚è¿™äº›logitsä¼šé™¤ä»¥ç§°ä¸ºTemperatureçš„è¶…å‚æ•°â€”â€”Temperatureå€¼è¶Šå¤§ï¼Œæ¨¡å‹é€‰æ‹©ä½é¢‘è¯çš„æ¦‚ç‡è¶Šé«˜ã€‚ä¹‹åæˆ‘ä»¬ç­›é€‰å‡ºæ¦‚ç‡æœ€é«˜çš„å‰kä¸ªå€™é€‰Tokenï¼ˆtop-k samplingï¼‰ï¼Œé€šè¿‡softmaxå‡½æ•°å°†ç­›é€‰åçš„logitsè½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œç„¶åä¾æ®è¯¥æ¦‚ç‡åˆ†å¸ƒéšæœºé€‰å–ä¸€ä¸ªTokenä½œä¸ºè¾“å‡ºã€‚ ä¹‹åï¼Œæˆ‘ä»¬å°†æ–°ç”Ÿæˆçš„Tokenè¿½åŠ è‡³è¾“å…¥åºåˆ—æœ«å°¾ï¼Œé‡æ–°è¾“å…¥æ¨¡å‹è¿›è¡Œä¸‹ä¸€è½®é¢„æµ‹ï¼Œå¾ªç¯ç›´è‡³å‡ºç°ç»ˆæ­¢ç¬¦ï¼ˆå¦‚ï¼‰æˆ–è¾¾åˆ°æœ€å¤§ç”Ÿæˆé•¿åº¦ã€‚ æ–‡æœ¬ç”Ÿæˆä¸­ï¼Œä¹Ÿå¸¸å¸¸ä½¿ç”¨ beam search æ¥é€‰æ‹© Token ","date":"2025-04-06","objectID":"/posts/building-a-transformer-lm/:6:0","tags":["LLM","Code"],"title":"Building a Transformer LM","uri":"/posts/building-a-transformer-lm/"},{"categories":["Backend","System"],"content":"åœ¨åç«¯å®ä¹ é¢è¯•ä¸­ï¼Œæœ‰ æ•°æ®åº“ï¼ŒJavaï¼Œç½‘ç»œï¼ŒOS å››å¤§è€ƒç‚¹ï¼Œå…¶ä¸­åˆä»¥æ•°æ®åº“è€ƒå¯Ÿæœ€ä¸ºé¢‘ç¹ã€‚æ•°æ®åº“é—®é¢˜ä¸­ï¼Œé™¤äº†å°‘éƒ¨åˆ†èŒƒå¼ç›¸å…³ç†è®ºï¼ŒåŸºæœ¬ä¸º MySQL é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨è¿™é‡Œæ‘˜å½•ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œåšä¸€ä¸ªæ€»ç»“ï¼Œæ—¢æ˜¯ä¸ºç§‹æ‹›åšå‡†å¤‡ï¼Œä¹Ÿæ˜¯æ€»ç»“æ‰¾å®ä¹ è¿‡ç¨‹ä¸­çš„æ‰€å­¦çŸ¥è¯†ã€‚ b ç«™è§†é¢‘è§£æ æ¶æ„ MySQL æ•´ä½“å¯åˆ†ä¸º Server å±‚ å’Œ å­˜å‚¨å¼•æ“ å±‚ã€‚Server å±‚å¤„ç†å®¢æˆ·è¿æ¥ï¼Œæ¥æ”¶ SQL è¯­å¥ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œå¹¶è°ƒç”¨å­˜å‚¨å¼•æ“ API æ¥è·å– / å†™å…¥å…·ä½“æ•°æ®ã€‚æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥éƒ½ç”±ä¸€ä¸ªçº¿ç¨‹æ¥è´Ÿè´£å¤„ç†ã€‚æ¯ä¸ª table éƒ½å¯ä»¥è®¾ç½®ä¸åŒçš„å­˜å‚¨å¼•æ“ã€‚å…·ä½“æµç¨‹ å­˜å‚¨å¼•æ“è‡ªå®šä¹‰å®ç°æ•°æ®çš„ç‰©ç†ï¼Œé€»è¾‘ç»„ç»‡ä»¥åŠç´¢å¼•ï¼Œäº‹åŠ¡ç­‰ç‰¹æ€§ã€‚ï¼ˆå› æ­¤é¢è¯•è€ƒå¯Ÿçš„é—®é¢˜å‡ ä¹éƒ½å±äºå­˜å‚¨å¼•æ“å±‚ï¼‰æŠ½è±¡å­˜å‚¨å¼•æ“å±‚ api æ˜¯é€šè¿‡æŠ½è±¡ç±» handler æ¥å®ç°ã€‚a minimal sorage engine in c++ The current limitations of the storage API are not intrinsic aspects of MySQL/MariaDB or Postgresâ€™s design. For both project there used to be no pluggable storage at all. We can imagine a future patch to either project that allows support for batched row reads and writes that together could make column-wise storage and vectorized execution more feasible. MySQL é‡‡ç”¨æ’ä»¶å¼å­˜å‚¨å¼•æ“ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä½¿ç”¨åœºæ™¯ é€‰æ‹©åˆé€‚çš„ã€‚æœ€å¸¸ç”¨çš„ä¹Ÿæ˜¯é»˜è®¤çš„å­˜å‚¨å¼•æ“ä¸º InnoDBï¼Œå®ƒæ˜¯å”¯ä¸€æ»¡è¶³ ACID ç‰¹æ€§äº‹åŠ¡çš„å­˜å‚¨å¼•æ“ã€‚ Maybe you want an in-memory storage layer so that you can quickly run integration tests. Maybe you want to switch between B-Trees (read-optimized) and LSM Trees (write-optimized) and unordered heaps (write-optimized) depending on your workload. Or maybe you just want to try a third-party storage library (e.g. RocksDB or Sled or TiKV). ç´¢å¼• B-tree èµ„æº **åœ¨ InnoDB ä¸­ï¼Œè¡¨éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºä»¥ç´¢å¼•çš„å½¢å¼å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ **ã€‚åˆ InnoDB ä½¿ç”¨äº† **B+ æ ‘ç´¢å¼•æ¨¡å‹ **ï¼Œæ‰€ä»¥æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨ B+ æ ‘ä¸­çš„ã€‚æ¯ä¸€ä¸ªç´¢å¼•åœ¨ InnoDB é‡Œé¢å¯¹åº”ä¸€æ£µ B+ æ ‘ã€‚ èšç°‡ç´¢å¼•æ˜¯ä¸»é”®æ‰€åœ¨çš„ç´¢å¼•ï¼Œæ•°æ®ä¹Ÿå­˜åœ¨å…¶ä¸­ã€‚ äºŒçº§ç´¢å¼•æ˜¯åˆæ¬¡ä¹‹å¤–çš„ç´¢å¼•ï¼ŒæŸ¥è¯¢åå¾—åˆ°ä¸»é”®ï¼Œå…¶ä»–ä¿¡æ¯éœ€è¦åˆ°ä¸»ç´¢å¼•ä¸­ â€œå›è¡¨æŸ¥è¯¢â€ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥å¯¹å¤šä¸ªé”®è¿›è¡Œè”åˆç´¢å¼•ã€‚è”åˆç´¢å¼•çš„å»ºç«‹åº”è¯¥éµå¾ªæœ€å·¦å‰ç¼€åŸåˆ™ã€‚ è€Œå¦‚æœæˆ‘ä»¬è¦æŸ¥è¯¢çš„æ•°æ®å·²ç»åœ¨ç´¢å¼•ä¸­ï¼Œé¿å…äº†å›è¡¨æŸ¥è¯¢ã€‚è¿™ä¸ªç´¢å¼•å°±å«åšè¦†ç›–ç´¢å¼•ã€‚ äº‹åŠ¡ äº‹åŠ¡çš„æ‰§è¡Œæµç¨‹ï¼š äº‹åŠ¡æŒ‡æ»¡è¶³ ACID ç‰¹æ€§çš„ä¸€ç»„æ“ä½œã€‚ ä¸€è‡´æ€§ï¼šæ•°æ®åº“å¤„äºæ­£ç¡®çš„çŠ¶æ€ åŸå­æ€§ï¼šæˆ–è€…æˆåŠŸï¼Œæˆ–è€…å¤±è´¥ï¼Œæ²¡æœ‰ä¸­é—´çŠ¶æ€ éš”ç¦»æ€§ï¼šå¹¶å‘äº‹åŠ¡ç›¸äº’ä¸å½±å“ æŒä¹…æ€§ï¼šæ–­ç”µå†…å­˜æ•°æ®ä¸¢å¤±åå¯æ¢å¤ ","date":"2025-03-12","objectID":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/:0:0","tags":["Database","Interview","Summary"],"title":"MySQL çŸ¥è¯†ç‚¹æ€»ç»“ ","uri":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"},{"categories":["Backend","System"],"content":"å®ç°åŸå­æ€§ -\u003e undo log æ¯ä¸€æ¡ SQL é€šè¿‡æ‰§è¡Œå™¨åï¼Œä¼šåœ¨ undo log segment ä¸­ç”³è¯·ä¸€ä¸ª undo log é¡µã€‚ç„¶åæ ¹æ® SQL ä¿¡æ¯æ„é€  undo log å†…å®¹ï¼Œå¹¶å†™å…¥ç£ç›˜ï¼Œä¿è¯çœŸæ­£æ“ä½œä¹‹å‰ undo log å®Œæ•´ã€‚ MySQL é‡‡ç”¨ SEGMENT -\u003e PAGE -\u003e å…·ä½“è®°å½• æ¥ç®¡ç†å†…å­˜ æ¯å½“ InnoDB ä¸­éœ€è¦ä¿®æ”¹æŸä¸ª Record æ—¶ï¼Œéƒ½ä¼šå°†å…¶å†å²ç‰ˆæœ¬å†™å…¥ä¸€ä¸ª Undo Log ä¸­ï¼Œå¯¹åº”çš„ Undo Record æ˜¯ Update ç±»å‹ã€‚å½“æ’å…¥æ–°çš„ Record æ—¶ï¼Œè¿˜æ²¡æœ‰ä¸€ä¸ªå†å²ç‰ˆæœ¬ï¼Œä½†ä¸ºäº†æ–¹ä¾¿äº‹åŠ¡å›æ»šæ—¶åšé€†å‘ï¼ˆDeleteï¼‰æ“ä½œï¼Œè¿˜æ˜¯ä¼šå†™å…¥ä¸€ä¸ª Insert ç±»å‹çš„ Undo Recordã€‚ Insert Undo Record ä»…ä»…æ˜¯ä¸ºäº†å¯èƒ½çš„äº‹åŠ¡å›æ»šå‡†å¤‡çš„ï¼Œå¹¶ä¸åœ¨ MVCC åŠŸèƒ½ä¸­æ‰¿æ‹…ä½œç”¨ã€‚å› æ­¤åªéœ€è¦è®°å½•å¯¹åº” Record çš„ Keyï¼Œä¾›å›æ»šæ—¶æŸ¥æ‰¾ Record ä½ç½®å³å¯ã€‚ å…¶ä¸­ Undo Number æ˜¯ Undo çš„ä¸€ä¸ªé€’å¢ç¼–å·ï¼ŒTable ID ç”¨æ¥è¡¨ç¤ºæ˜¯å“ªå¼ è¡¨çš„ä¿®æ”¹ã€‚ä¸‹é¢ä¸€ç»„ Key Fields çš„é•¿åº¦ä¸å®šï¼Œå› ä¸ºå¯¹åº”è¡¨çš„ä¸»é”®å¯èƒ½ç”±å¤šä¸ª field ç»„æˆï¼Œè¿™é‡Œéœ€è¦è®°å½• Record å®Œæ•´çš„ä¸»é”®ä¿¡æ¯ï¼Œå›æ»šçš„æ—¶å€™å¯ä»¥é€šè¿‡è¿™ä¸ªä¿¡æ¯åœ¨ç´¢å¼•ä¸­å®šä½åˆ°å¯¹åº”çš„ Recordã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ Undo Record çš„å¤´å°¾è¿˜å„ç•™äº†ä¸¤ä¸ªå­—èŠ‚ç”¨æˆ·è®°å½•å…¶å‰åºå’Œåç»§ Undo Record çš„ä½ç½®ã€‚ ç”±äº MVCC éœ€è¦ä¿ç•™ Record çš„å¤šä¸ªå†å²ç‰ˆæœ¬ï¼Œå½“æŸä¸ª Record çš„å†å²ç‰ˆæœ¬è¿˜åœ¨è¢«ä½¿ç”¨æ—¶ï¼Œè¿™ä¸ª Record æ˜¯ä¸èƒ½è¢«çœŸæ­£çš„åˆ é™¤çš„ã€‚å› æ­¤ï¼Œå½“éœ€è¦åˆ é™¤æ—¶ï¼Œå…¶å®åªæ˜¯ä¿®æ”¹å¯¹åº” Record çš„ Delete Mark æ ‡è®°ã€‚å¯¹åº”çš„ï¼Œå¦‚æœè¿™æ—¶è¿™ä¸ª Record åˆé‡æ–°æ’å…¥ï¼Œå…¶å®ä¹Ÿåªæ˜¯ä¿®æ”¹ä¸€ä¸‹ Delete Mark æ ‡è®°ï¼Œä¹Ÿå°±æ˜¯å°†è¿™ä¸¤ç§æƒ…å†µçš„ delete å’Œ insert è½¬å˜æˆäº† update æ“ä½œã€‚å†åŠ ä¸Šå¸¸è§„çš„ Record ä¿®æ”¹ï¼Œå› æ­¤è¿™é‡Œçš„ Update Undo Record ä¼šå¯¹åº”ä¸‰ç§ Typeï¼šTRX_UNDO_UPD_EXIST_RECã€TRX_UNDO_DEL_MARK_REC å’Œ TRX_UNDO_UPD_DEL_RECã€‚ä»–ä»¬çš„å­˜å‚¨å†…å®¹ä¹Ÿç±»ä¼¼ï¼š é™¤äº†è·Ÿ Insert Undo Record ç›¸åŒçš„å¤´å°¾ä¿¡æ¯ï¼Œä»¥åŠä¸»é”® Key Fileds ä¹‹å¤–ï¼ŒUpdate Undo Record å¢åŠ äº†ï¼š Transaction Id è®°å½•äº†äº§ç”Ÿè¿™ä¸ªå†å²ç‰ˆæœ¬äº‹åŠ¡ Idï¼Œç”¨ä½œåç»­ MVCC ä¸­çš„ç‰ˆæœ¬å¯è§æ€§åˆ¤æ–­ Rollptr æŒ‡å‘çš„æ˜¯è¯¥è®°å½•çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„ä½ç½®ï¼ŒåŒ…æ‹¬ space numberï¼Œpage number å’Œ page å†…çš„ offsetã€‚æ²¿ç€ Rollptr å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª Record çš„æ‰€æœ‰å†å²ç‰ˆæœ¬ã€‚ Update Fields ä¸­è®°å½•çš„å°±æ˜¯å½“å‰è¿™ä¸ª Record ç‰ˆæœ¬ç›¸å¯¹äºå…¶ä¹‹åçš„ä¸€æ¬¡ä¿®æ”¹çš„ Delta ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€æœ‰è¢«ä¿®æ”¹çš„ Field çš„ç¼–å·ï¼Œé•¿åº¦å’Œå†å²å€¼ã€‚ æ¯ä¸ªäº‹åŠ¡å…¶å®ä¼šä¿®æ”¹ä¸€ç»„çš„ Recordï¼Œå¯¹åº”çš„ä¹Ÿå°±ä¼šäº§ç”Ÿä¸€ç»„ Undo Recordï¼Œè¿™äº› Undo Record æ”¶å°¾ç›¸è¿å°±ç»„æˆäº†è¿™ä¸ªäº‹åŠ¡çš„ Undo Logã€‚é™¤äº†ä¸€ä¸ªä¸ªçš„ Undo Record ä¹‹å¤–ï¼Œè¿˜åœ¨å¼€å¤´å¢åŠ äº†ä¸€ä¸ª Undo Log Header æ¥è®°å½•ä¸€äº›å¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼Œå› æ­¤ï¼Œä¸€ä¸ª Undo Log çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š ç´¢å¼•ä¸­çš„åŒä¸€ä¸ª Record è¢«ä¸åŒäº‹åŠ¡ä¿®æ”¹ï¼Œä¼šäº§ç”Ÿä¸åŒçš„å†å²ç‰ˆæœ¬ï¼Œè¿™äº›å†å²ç‰ˆæœ¬åˆé€šè¿‡ Rollptr ç©¿æˆä¸€ä¸ªé“¾è¡¨ï¼Œä¾› MVCC ä½¿ç”¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š insert undo log åœ¨äº‹åŠ¡ç»“æŸåå³å¯å›æ”¶ï¼Œä½† update undo log éœ€è¦æ”¯æŒ MVCCï¼Œä¸èƒ½ç›´æ¥åˆ é™¤ã€‚å½“æŸä¸ªå†å²ç‰ˆæœ¬å·²ç»ç¡®è®¤ä¸ä¼šè¢«ä»»ä½•ç°æœ‰çš„å’Œæœªæ¥çš„äº‹åŠ¡çœ‹åˆ°çš„æ—¶å€™ï¼Œå°±åº”è¯¥è¢«æ¸…ç†æ‰ã€‚ ","date":"2025-03-12","objectID":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/:1:0","tags":["Database","Interview","Summary"],"title":"MySQL çŸ¥è¯†ç‚¹æ€»ç»“ ","uri":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"},{"categories":["Backend","System"],"content":"å®ç°éš”ç¦»æ€§ -\u003e MVCC å’Œé” å¦‚æœå¹¶å‘äº‹åŠ¡é—´ä¸éš”ç¦»å°±ä¼šäº§ç”Ÿä»¥ä¸‹é—®é¢˜ï¼š è„è¯»ï¼šA äº‹åŠ¡è¯»å– B äº‹åŠ¡æœªæäº¤çš„æ•°æ® ä¸å¯é‡å¤è¯»ï¼šA äº‹åŠ¡ä¸¤æ¬¡è¯»å–åˆ°ä¸åŒçš„æ•°æ®ï¼ˆB äº‹åŠ¡ä¿®æ”¹ä¸”æäº¤ï¼‰ å¹»è¯»ï¼šA äº‹åŠ¡ä¸¤æ¬¡è¯»å–åˆ°æ•°é‡ä¸åŒçš„è¡Œæ•°æ®ï¼ˆB äº‹åŠ¡åˆ é™¤ / å¢åŠ è¡Œï¼‰ InnoDB ä¸­å®ç°äº†å››å¤§éš”ç¦»çº§åˆ«ï¼š éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» READ-UNCOMMITTED âˆš âˆš âˆš READ-COMMITTED Ã— âˆš âˆš REPEATABLE-READ Ã— Ã— âˆš SERIALIZABLE Ã— Ã— Ã— Innodb é€šè¿‡é”æœºåˆ¶å’Œ MVCC æ¥å®ç°å„ç§éš”ç¦»çº§åˆ«ï¼Œå…¶ä¸­é”åˆåˆ†ä¸ºï¼š LOCK_S å…±äº«é” LOCK_X ç‹¬å é” LOCK_IS å…±äº«æ„å‘é”ï¼ˆæ„å‘é”ï¼šåœ¨è¡¨ä¸Šåšä¸€ä¸ªæ ‡è®°ï¼‰ LOCK_IX ç‹¬å æ„å‘é” LOCK_AUTO_INC è‡ªå¢é” æŒ‰ç…§ç²’åº¦åˆåˆ†ä¸º LOCK_TABLE è¡¨é”ï¼Œå’Œ LOCK_REC è¡Œé”ã€‚ è¡Œé”åˆåˆ†ä¸ºï¼š LOCK_REC_NOT_GAP ç²¾å‡†è¡Œé”ï¼Œé”ä½æŸä¸€è¡Œ LOCK_GAP é”ä½æŸä¸¤è¡Œé—´éš™ï¼Œé˜²æ­¢æ’å…¥ LOCK_ORDINARY next-key é” = LOCK_GAP + LOCK_REC_NOT_GAP LOCK_INSERT_INTENTION æ’å…¥æ„å‘é”ï¼Œå…±äº«çš„ gap é” å¦‚æœè¦åŠ å¤šä¸ªé”ï¼Œä¼šå¼ºåˆ¶ä½¿ç”¨ ä¸¤æ®µé”åè®® ä»¥ä¿è¯å¯ä¸²è¡ŒåŒ–ã€‚ é€šè¿‡å¼ºåˆ¶é”çš„ç”³è¯·å’Œé‡Šæ”¾é¡ºåºï¼Œä¸¤æ®µé”åè®®ç¡®ä¿äº‹åŠ¡é—´çš„å†²çªæ“ä½œï¼ˆå¦‚è¯»å†™ã€å†™å†™ï¼‰éµå¾ªå›ºå®šé¡ºåºï¼Œä»è€Œé¿å…å› æ“ä½œäº¤å‰å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œè‹¥äº‹åŠ¡ T1 å’Œ T2 å‡éµå®ˆä¸¤æ®µé”åè®®ï¼Œå®ƒä»¬çš„æ“ä½œé¡ºåºä¼šè¢«é”å®šä¸º â€œT1 å…¨åŠ é”â†’T1 é‡Šæ”¾é”â†’T2 åŠ é”â€ï¼Œç­‰æ•ˆäºä¸²è¡Œæ‰§è¡Œã€‚ MVCC å…·ä½“é€šè¿‡ undo log å’Œ read view å®ç°ã€‚undo log å­˜å‚¨äº†æ‰€æœ‰å˜æ›´ã€‚ä¸€ä¸ªäº‹åŠ¡çš„ read view è®°å½•äº†å½“å‰æ´»è·ƒäº‹åŠ¡é›†åˆï¼Œæœ€å°äº‹åŠ¡ idï¼Œä¸‹ä¸€ä¸ªäº‹åŠ¡ idï¼Œå½“å‰äº‹åŠ¡ idã€‚è¯»å–æ—¶ï¼Œæ²¿ç€ç‰ˆæœ¬é“¾ï¼Œæ‰¾åˆ°åˆé€‚çš„ç‰ˆæœ¬ã€‚ å¯¹äºè¯»æœªæäº¤çº§åˆ«ï¼š è¯»å–æ—¶ä¸åšä»»ä½•åŠ é”å¤„ç†ï¼Œç›´æ¥è®¿é—®å†…å­˜ä¸­çš„æœ€æ–°æ•°æ®é¡µç‰ˆæœ¬ã€‚ æ›´æ–°æ—¶åŠ  ç‹¬å è¡Œé”ï¼Œäº‹åŠ¡ç»“æŸæ—¶é‡Šæ”¾ã€‚ï¼ˆå…¶ä»–äº‹åŠ¡ä¸å¯ä»¥ä¿®æ”¹ï¼Œä½†å¯è¯»å–ï¼‰ å¯¹äºè¯»å·²ä½“æäº¤ï¼š æ¯æ¬¡æŸ¥è¯¢æ„é€ ä¸€ä¸ªæ–°çš„ readviewï¼Œè§£å†³è„è¯» æ›´æ–°æ—¶åŠ  ç‹¬å è¡Œé”ï¼Œäº‹åŠ¡ç»“æŸæ—¶é‡Šæ”¾ã€‚ å¯¹äºå¯é‡å¤è¯»ï¼š ä½¿ç”¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶ç”Ÿæˆçš„ readviewï¼Œè§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯» æ›´æ–°æ•°æ®æ—¶åŠ  next-key é”ï¼Œè§£å†³äº†éƒ¨åˆ†å¹»è¯»é—®é¢˜ å¯¹äºä¸²è¡Œè¯»ï¼š è¯»å–æ—¶ä½¿ç”¨å…±äº«è¡¨é” æ›´æ–°æ—¶ä½¿ç”¨ç‹¬å è¡¨é” ","date":"2025-03-12","objectID":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/:2:0","tags":["Database","Interview","Summary"],"title":"MySQL çŸ¥è¯†ç‚¹æ€»ç»“ ","uri":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"},{"categories":["Backend","System"],"content":"å®ç°æŒä¹…æ€§ -\u003e redo logï¼Œbinlog redo log æ˜¯ä¸€ç§ WALï¼ˆWrite-Ahead Loggingï¼‰ã€‚å½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°æ—¶ï¼ŒInnoDB å¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° redo log é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDB å¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ã€‚ï¼ˆæ³¨æ„ undo é¡µå¯èƒ½ä¸€ç›´åœ¨ buffer pool ä¸­ï¼Œä»ä¸å®é™…å†™å…¥ç£ç›˜ï¼‰ æœ‰äº† redo logï¼ŒInnoDB å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º crash-safeã€‚ é‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ ·çš„ REDO å‘¢ï¼Ÿé¦–å…ˆï¼ŒREDO çš„ç»´æŠ¤å¢åŠ äº†ä¸€ä»½å†™ç›˜æ•°æ®ï¼ŒåŒæ—¶ä¸ºäº†ä¿è¯æ•°æ®æ­£ç¡®ï¼Œäº‹åŠ¡åªæœ‰åœ¨ä»–çš„ REDO å…¨éƒ¨è½ç›˜æ‰èƒ½è¿”å›ç”¨æˆ·æˆåŠŸï¼ŒREDO çš„å†™ç›˜æ—¶é—´ä¼šç›´æ¥å½±å“ç³»ç»Ÿååï¼Œæ˜¾è€Œæ˜“è§ï¼Œ**REDO çš„æ•°æ®é‡è¦å°½é‡å°‘ **ã€‚å…¶æ¬¡ï¼Œç³»ç»Ÿå´©æºƒæ€»æ˜¯å‘ç”Ÿåœ¨å§‹æ–™æœªåŠçš„æ—¶å€™ï¼Œå½“é‡å¯é‡æ”¾ REDO æ—¶ï¼Œç³»ç»Ÿå¹¶ä¸çŸ¥é“å“ªäº› REDO å¯¹åº”çš„ Page å·²ç»è½ç›˜ï¼Œå› æ­¤ REDO çš„é‡æ”¾å¿…é¡»å¯é‡å…¥ï¼Œå³ **REDO æ“ä½œè¦ä¿è¯å¹‚ç­‰ ã€‚æœ€åï¼Œä¸ºäº†ä¾¿äºé€šè¿‡å¹¶å‘é‡æ”¾çš„æ–¹å¼åŠ å¿«é‡å¯æ¢å¤é€Ÿåº¦ï¼ŒREDO åº”è¯¥æ˜¯ ** åŸºäº Page çš„ï¼Œå³ä¸€ä¸ª REDO åªæ¶‰åŠä¸€ä¸ª Page çš„ä¿®æ”¹ã€‚ æ•°æ®é‡å°æ˜¯ Logical Logging çš„ä¼˜ç‚¹ï¼Œè€Œå¹‚ç­‰ä»¥åŠåŸºäº Page æ­£æ˜¯ Physical Logging çš„ä¼˜ç‚¹ï¼Œå› æ­¤ InnoDB é‡‡å–äº†ä¸€ç§ç§°ä¸º Physiological Logging çš„æ–¹å¼ï¼Œæ¥å…¼å¾—äºŒè€…çš„ä¼˜åŠ¿ã€‚æ‰€è°“ Physiological Loggingï¼Œå°±æ˜¯ä»¥ Page ä¸ºå•ä½ï¼Œä½†åœ¨ Page å†…ä»¥é€»è¾‘çš„æ–¹å¼è®°å½•ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒMLOG_REC_UPDATE_IN_PLACE ç±»å‹çš„ REDO ä¸­è®°å½•äº†å¯¹ Page ä¸­ä¸€ä¸ª Record çš„ä¿®æ”¹ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š ï¼ˆPage IDï¼ŒRecord Offsetï¼Œ(Filed 1, Value 1) â€¦ (Filed i, Value i) â€¦ ) å…¶ä¸­ï¼ŒPageID æŒ‡å®šè¦æ“ä½œçš„ Page é¡µï¼ŒRecord Offset è®°å½•äº† Record åœ¨ Page å†…çš„åç§»ä½ç½®ï¼Œåé¢çš„ Field æ•°ç»„ï¼Œè®°å½•äº†éœ€è¦ä¿®æ”¹çš„ Field ä»¥åŠä¿®æ”¹åçš„ Valueã€‚ MySQL çš„ InnoDB é¡µå¤§å°ä¸º 16KBï¼Œè€Œæ“ä½œç³»ç»Ÿï¼ˆå¦‚ Linuxï¼‰çš„é¡µå¤§å°ä¸º 4KBã€‚InnoDB å°†ä¸€ä¸ª 16KB çš„é¡µå†™å…¥ç£ç›˜æ—¶ï¼Œéœ€è¦æ‹†åˆ†ä¸º 4 ä¸ªæ“ä½œç³»ç»Ÿé¡µï¼ˆ4KBÃ—4ï¼‰ã€‚è‹¥åœ¨å†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿå´©æºƒï¼ˆå¦‚æ–­ç”µï¼‰ï¼Œå¯èƒ½å‡ºç°ä»…éƒ¨åˆ†æ“ä½œç³»ç»Ÿé¡µæˆåŠŸå†™å…¥çš„æƒ…å†µï¼Œå¯¼è‡´ InnoDB é¡µæ•°æ®æŸåã€‚è¿™ç§æŸåæ— æ³•é€šè¿‡ Redo Log æ¢å¤ï¼Œå› ä¸º **Redo Log è®°å½•çš„æ˜¯æ“ä½œè€Œéå®Œæ•´é¡µæ•°æ® **ã€‚ InnoDB ä¸­é‡‡ç”¨äº† Double Write Buffer çš„æ–¹å¼æ¥é€šè¿‡å†™ä¸¤æ¬¡çš„æ–¹å¼ä¿è¯æ¢å¤çš„æ—¶å€™æ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„ Page çŠ¶æ€ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼Œåœ¨æŠŠé¡µå†™åˆ°æ•°æ®æ–‡ä»¶ä¹‹å‰ï¼ŒInnoDB å…ˆæŠŠå®ƒä»¬å†™åˆ°ä¸€ä¸ªå« Double Write Bufferï¼ˆåŒå†™ç¼“å†²åŒºï¼‰çš„å…±äº«è¡¨ç©ºé—´å†…ï¼Œåœ¨å†™ Double Write Buffer å®Œæˆåï¼ŒInnoDB æ‰ä¼šæŠŠé¡µå†™åˆ°æ•°æ®æ–‡ä»¶çš„é€‚å½“çš„ä½ç½®ã€‚å¦‚æœåœ¨å†™é¡µçš„è¿‡ç¨‹ä¸­å‘ç”Ÿæ„å¤–å´©æºƒï¼ŒInnoDB åœ¨ç¨åçš„æ¢å¤è¿‡ç¨‹ä¸­åœ¨ Double Write Buffer ä¸­æ‰¾åˆ°å®Œå¥½çš„ page å‰¯æœ¬ç”¨äºæ¢å¤ã€‚ Double Write Buffer èƒ½å¤Ÿä¿è¯æ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„ Page çŠ¶æ€ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“è¿™ä¸ªçŠ¶æ€å¯¹åº” REDO ä¸Šçš„å“ªä¸ªè®°å½•ï¼Œæ¥é¿å…å¯¹ Page çš„é‡å¤ä¿®æ”¹ã€‚ä¸ºæ­¤ï¼ŒInnoDB ç»™æ¯ä¸ª REDO è®°å½•ä¸€ä¸ªå…¨å±€å”¯ä¸€é€’å¢çš„æ ‡å· LSN (Log Sequence Number)ã€‚Page åœ¨ä¿®æ”¹æ—¶ï¼Œä¼šå°†å¯¹åº”çš„ REDO è®°å½•çš„ LSN è®°å½•åœ¨ Page ä¸Šï¼ˆFIL_PAGE_LSN å­—æ®µï¼‰ï¼Œè¿™æ ·æ¢å¤é‡æ”¾ REDO æ—¶ï¼Œå°±å¯ä»¥æ¥åˆ¤æ–­è·³è¿‡å·²ç»åº”ç”¨çš„ REDOï¼Œä»è€Œå®ç°é‡æ”¾çš„å¹‚ç­‰ã€‚ MySQL ä¸­ä½¿ç”¨ binlog åš ä¸»ä»åº“é—´çš„å¤‡ä»½ã€‚ æœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ã€‚MySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿ â€”â€” ä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚ è¿™ä¸¤ç§æ—¥å¿—æœ‰ä»¥ä¸‹ä¸‰ç‚¹ä¸åŒã€‚ redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚ redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯ â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚ â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1â€ã€‚ redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€ æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚ MySQL é‡‡ç”¨ä¸¤é˜¶æ®µæäº¤(2PC) æœºåˆ¶ï¼Œæ˜¯ä¸ºäº†è§£å†³ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰ å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ ä¹‹é—´çš„é€»è¾‘ä¸€è‡´æ€§é—®é¢˜ï¼Œç¡®ä¿äº‹åŠ¡çš„åŸå­æ€§å’ŒæŒä¹…æ€§ã€‚ ","date":"2025-03-12","objectID":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/:3:0","tags":["Database","Interview","Summary"],"title":"MySQL çŸ¥è¯†ç‚¹æ€»ç»“ ","uri":"/posts/mysql%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":" cheat sheet Machine Learning Glossary ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:0:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"åŸºæœ¬æ¦‚å¿µ ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ æœºå™¨å­¦ä¹ è‡´åŠ›äºç ”ç©¶å¦‚ä½•é€šè¿‡è®¡ç®—çš„æ‰‹æ®µï¼Œåˆ©ç”¨ç»éªŒæ¥æ”¹å–„ç³»ç»Ÿè‡ªèº«çš„æ€§èƒ½ã€‚ ç»éªŒé€šå¸¸ä»¥\"æ•°æ®â€œå½¢å¼å­˜åœ¨ï¼Œå› æ­¤æœºå™¨å­¦ä¹ ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œæ˜¯å…³äºåœ¨è®¡ç®—æœºä¸Šä»æ•°æ®ä¸­äº§ç”Ÿâ€æ¨¡å‹\"(model) çš„ç®—æ³•ï¼Œå³\"å­¦ä¹ ç®—æ³•\" (learning algorithm). è®°å½•çš„é›†åˆç§°ä¸ºä¸€ä¸ª\"æ•°æ®é›†\" (data set) ï¼Œå…¶ä¸­æ¯æ¡è®°å½•æ˜¯å…³äºä¸€ä¸ªäº‹ä»¶æˆ–å¯¹è±¡çš„æè¿°ï¼Œç§°ä¸ºä¸€ä¸ª\"ç¤ºä¾‹\"(instance) æˆ–\"æ ·æœ¬\"(sample). åæ˜ äº‹ä»¶æˆ–å¯¹è±¡åœ¨æŸæ–¹é¢çš„è¡¨ç°æˆ–æ€§è´¨çš„äº‹é¡¹ç§°ä¸º\"å±æ€§\"(attribute) æˆ–\"ç‰¹å¾\"(feature); å±æ€§ä¸Šçš„å–å€¼ç§°ä¸º\"å±æ€§å€¼\" (attribute value). å±æ€§å¼ æˆçš„ç©ºé—´ç§°ä¸º\"å±æ€§ç©ºé—´\" (attribute space) ã€\"æ ·æœ¬ç©ºé—´\" (sample space)æˆ–\"è¾“å…¥ç©ºé—´\"ã€‚æˆ‘ä»¬ä¹ŸæŠŠä¸€ä¸ªç¤ºä¾‹ç§°ä¸ºä¸€ä¸ª\"ç‰¹å¾å‘é‡\" (feature vector).å±æ€§çš„æ•°ç›®è¢«ç§°ä¸ºæ ·æœ¬çš„\"ç»´æ•°\" (dimensionality). ä»æ•°æ®ä¸­å­¦å¾—æ¨¡å‹çš„è¿‡ç¨‹ç§°ä¸º\"å­¦ä¹ \"(learning)æˆ–\"è®­ç»ƒ\" (training),è¿™ä¸ªè¿‡ç¨‹é€šè¿‡æ‰§è¡ŒæŸä¸ªå­¦ä¹ ç®—æ³•æ¥å®Œæˆ.è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®ç§°ä¸º\"è®­ç»ƒæ•°æ®\" (training data) ï¼Œå…¶ä¸­æ¯ä¸ªæ ·æœ¬ç§°ä¸ºä¸€ä¸ª\"è®­ç»ƒæ ·æœ¬\" (training sample),è®­ç»ƒæ ·æœ¬ç»„æˆçš„é›†åˆç§°ä¸º\"è®­ç»ƒé›†\" (training set). å­¦å¾—æ¨¡å‹å¯¹åº”äº†å…³äºæ•°æ®çš„æŸç§æ½œåœ¨çš„è§„å¾‹ï¼Œå› æ­¤äº¦ç§°\"å‡è®¾\" (hypothesis); è¿™ç§æ½œåœ¨è§„å¾‹è‡ªèº«ï¼Œåˆ™ç§°ä¸º\"çœŸç›¸â€œæˆ–â€çœŸå®\"(ground-truth) ï¼Œå­¦ä¹ è¿‡ç¨‹å°±æ˜¯ä¸ºäº†æ‰¾å‡ºæˆ–é€¼è¿‘çœŸç›¸. å­¦å¾—æ¨¡å‹åï¼Œä½¿ç”¨å…¶æ¯è¡Œé¢„æµ‹çš„è¿‡ç¨‹ç§°ä¸º\"æµ‹è¯•\"(testing) ï¼Œè¢«é¢„æµ‹çš„æ ·æœ¬ ç§°ä¸º\"æµ‹è¯•æ ·æœ¬\" (testing sample). éƒ½æœ‰å“ªäº›æœºå™¨å­¦ä¹ ç®—æ³•ï¼Ÿ ä¸€ä»½ç®—æ³•åˆ—è¡¨ é™¤å¦‚å›¾æ‰€ç¤ºçš„ç›‘ç£å’Œéç›‘ç£å­¦ä¹ å¤–ï¼Œå¼ºåŒ–å­¦ä¹ ä¹Ÿæ˜¯ä¸€ç±»åŸºæœ¬å­¦ä¹ ç®—æ³•ã€‚ ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹  æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ˜¯ä¸€ç§åŸºäºäººå·¥ç¥ç»ç½‘ç»œçš„ç®—æ³•æ¨¡å‹ã€‚å®ƒæ¨¡ä»¿äººç±»å¤§è„‘å¤„ç†ä¿¡æ¯çš„æ–¹å¼ï¼Œé‡‡ç”¨å¤šå±‚ç¥ç»ç½‘ç»œä»å¤§é‡æ•°æ®ä¸­æå–ç‰¹å¾å¹¶è¿›è¡Œå†³ç­–ã€‚æ·±åº¦å­¦ä¹ åœ¨ç›‘ç£ï¼Œéç›‘ç£ï¼Œå¼ºåŒ–å­¦ä¹ ä¸­å‡æœ‰åº”ç”¨ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:1:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"å¯¹å­¦ä¹ çš„ç†è§£ æˆ‘ä»¬å¯ä»¥æŠŠå­¦ä¹ è¿‡ç¨‹çœ‹ä½œä¸€ä¸ªåœ¨æ‰€æœ‰å‡è®¾ (hypothesis)ç»„æˆçš„ç©ºé—´ä¸­è¿›è¡Œæœç´¢çš„è¿‡ç¨‹ï¼Œæœç´¢ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸è®­ç»ƒé›†\"åŒ¹é…\"(fit) çš„å‡è®¾ï¼Œå³èƒ½å¤Ÿå°†è®­ç»ƒé›†ä¸­çš„ç“œåˆ¤æ–­æ­£ç¡®çš„å‡è®¾.å‡è®¾çš„è¡¨ç¤ºä¸€æ—¦ç¡®å®šï¼Œå‡è®¾ç©ºé—´åŠå…¶è§„æ¨¡å¤§å°å°±ç¡®å®šäº†. å¯èƒ½æœ‰å¤šä¸ªå‡è®¾ä¸è®­ç»ƒé›†ä¸€è‡´ï¼Œå³å­˜åœ¨ç€ä¸€ä¸ªä¸è®­ç»ƒé›†ä¸€è‡´çš„\"å‡è®¾é›†åˆ\"ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º\"ç‰ˆæœ¬ç©ºé—´\" (version space). æœºå™¨å­¦ä¹ ç®—æ³•åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å¯¹æŸç§ç±»å‹å‡è®¾çš„åå¥½ï¼Œç§°ä¸º\"å½’çº³åå¥½\" (inductive bias) ,æˆ–ç®€ç§°ä¸º\"åå¥½\".ä»»ä½•ä¸€ä¸ªæœ‰æ•ˆçš„æœºå™¨å­¦ä¹ ç®—æ³•å¿…æœ‰å…¶å½’çº³åå¥½ï¼Œå¦åˆ™å®ƒå°†è¢«å‡è®¾ç©ºé—´ä¸­çœ‹ä¼¼åœ¨è®­ç»ƒé›†ä¸Š\"ç­‰æ•ˆ\"çš„å‡è®¾æ‰€è¿·æƒ‘ï¼Œè€Œæ— æ³•äº§ç”Ÿç¡®å®šçš„å­¦ä¹ ç»“æœ. å½’çº³åå¥½å¯çœ‹ä½œå­¦ä¹ ç®—æ³•è‡ªèº«åœ¨ä¸€ä¸ªå¯èƒ½å¾ˆåºå¤§çš„å‡è®¾ç©ºé—´ä¸­å¯¹å‡è®¾è¿›è¡Œé€‰æ‹©çš„å¯å‘å¼æˆ–\"ä»·å€¼è§‚\"ã€‚â€œå¥¥å¡å§†å‰ƒåˆ€â€ (Occamâ€™s razor)æ˜¯ä¸€ç§å¸¸ç”¨çš„ã€è‡ªç„¶ç§‘å­¦ç ”ç©¶ä¸­æœ€åŸºæœ¬çš„åŸåˆ™ï¼Œå³\"è‹¥æœ‰å¤šä¸ªå‡è®¾ä¸è§‚å¯Ÿä¸€è‡´ï¼Œåˆ™é€‰æœ€ç®€å•çš„é‚£ä¸ªã€‚ äº‹å®ä¸Šï¼Œå½’çº³åå¥½å¯¹åº”äº†å­¦ä¹ ç®—æ³•æœ¬èº«æ‰€åšå‡ºçš„å…³äº\"ä»€ä¹ˆæ ·çš„æ¨¡å‹æ›´å¥½\"çš„å‡è®¾.åœ¨å…·ä½“çš„ç°å®é—®é¢˜ä¸­ï¼Œè¿™ä¸ªå‡è®¾æ˜¯å¦æˆç«‹ï¼Œå³ç®—æ³•çš„å½’çº³åå¥½æ˜¯å¦ä¸é—®é¢˜æœ¬èº«åŒ¹é…ï¼Œå¤§å¤šæ•°æ—¶å€™ç›´æ¥å†³å®šäº†ç®—æ³•èƒ½å¦å–å¾—å¥½çš„æ€§èƒ½. ä¸åŒçš„ç¥ç»ç½‘ç»œæ¶æ„æ—¢ä½“ç°äº†ä¸åŒçš„å‡è®¾ç©ºé—´ï¼Œä¹Ÿä½“ç°äº†ä¸åŒçš„å½’çº³åå¥½ å‡è®¾ç©ºé—´ï¼šç”±æ¶æ„å®šä¹‰ï¼Œæ˜¯æ¨¡å‹å¯ä»¥è¡¨ç¤ºçš„æ‰€æœ‰å¯èƒ½å‡½æ•°ã€‚ ç†è®ºä¸Šæ¥è¯´ï¼Œä¸€å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼ˆå…·æœ‰è¶³å¤Ÿçš„ç¥ç»å…ƒå’Œéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼‰å°±èƒ½é€¼è¿‘ä»»æ„è¿ç»­å‡½æ•°ã€‚ å½’çº³åå¥½ï¼šç”±æ¶æ„åŠå…¶ä¼˜åŒ–è¿‡ç¨‹ï¼ˆä¾‹å¦‚æŸå¤±å‡½æ•°ã€æ­£åˆ™åŒ–ç­–ç•¥ï¼‰å®šä¹‰ï¼Œæ˜¯æ¨¡å‹åœ¨æœ‰é™æ•°æ®ä¸‹æ›´å€¾å‘é€‰æ‹©çš„å‡½æ•°ã€‚ è€ŒåŒæ—¶ï¼Œæ ¹æ®NFL å®šç†ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§å­¦ä¹ ç®—æ³•åœ¨æ‰€æœ‰é—®é¢˜ä¸Šéƒ½ä¼˜äºå…¶ä»–ç®—æ³•ã€‚ ç›´è§‚æ¥è¯´ï¼š å¦‚æœæˆ‘ä»¬å¯¹é—®é¢˜åˆ†å¸ƒä¸€æ— æ‰€çŸ¥ï¼Œé‚£ä¹ˆæ‰€æœ‰ç®—æ³•åœ¨è¿™äº›é—®é¢˜ä¸ŠæˆåŠŸçš„æ¦‚ç‡æ˜¯ç­‰ä»·çš„ã€‚ è¦åœ¨ç‰¹å®šä»»åŠ¡ä¸­å–å¾—å¥½æ€§èƒ½ï¼Œç®—æ³•å¿…é¡»å¯¹ä»»åŠ¡çš„ç‰¹å®šæ€§è´¨åšå‡ºå‡è®¾ï¼ˆå³å¼•å…¥å½’çº³åå¥½ï¼‰ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:2:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"æ¨¡å‹è¯„ä¼°å’Œé€‰æ‹© ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:3:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"ç»éªŒè¯¯å·®ä¸è¿‡æ‹Ÿåˆ åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨ä»¥ä¸‹æŒ‡æ ‡æ¥è¡¡é‡æ¨¡å‹çš„æ€§èƒ½ï¼š é”™è¯¯ç‡ï¼ˆError Rateï¼‰ï¼šåˆ†ç±»é”™è¯¯çš„æ ·æœ¬æ•°å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ $m$ ä¸ªæ ·æœ¬ä¸­æœ‰ $\\alpha$ ä¸ªæ ·æœ¬è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ï¼š $\\text{é”™è¯¯ç‡} = \\frac{\\alpha}{m}$ ç²¾åº¦ï¼ˆAccuracyï¼‰ï¼šåˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ï¼Œä¸é”™è¯¯ç‡äº’è¡¥ï¼š $\\text{ç²¾åº¦} = 1 - \\text{é”™è¯¯ç‡}$ æ›´å¹¿ä¹‰åœ°ï¼Œæˆ‘ä»¬æŠŠå­¦ä¹ å™¨çš„å®é™…é¢„æµ‹è¾“å‡ºä¸æ ·æœ¬çš„çœŸå®è¾“å‡ºä¹‹é—´çš„å·®å¼‚ç§°ä¸ºâ€œè¯¯å·®ï¼ˆErrorï¼‰â€ï¼š è®­ç»ƒè¯¯å·®ï¼ˆTraining Errorï¼‰ï¼šå­¦ä¹ å™¨åœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®ï¼Œåˆç§°ä¸ºâ€œç»éªŒè¯¯å·®ï¼ˆEmpirical Errorï¼‰â€ã€‚ æ³›åŒ–è¯¯å·®ï¼ˆGeneralization Errorï¼‰ï¼šå­¦ä¹ å™¨åœ¨æ–°æ ·æœ¬ä¸Šçš„è¯¯å·®ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªæ³›åŒ–è¯¯å·®å°½å¯èƒ½å°çš„å­¦ä¹ å™¨ã€‚ç„¶è€Œï¼Œç”±äºäº‹å…ˆæ— æ³•å¾—çŸ¥æ–°æ ·æœ¬çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡æœ€å°åŒ–ç»éªŒè¯¯å·®æ¥é—´æ¥ä¼˜åŒ–æ³›åŒ–è¯¯å·®ã€‚ åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ å™¨èƒ½å¯¹æ–°æ ·æœ¬åšå‡ºå‡†ç¡®é¢„æµ‹ï¼Œè¿™è¦æ±‚å®ƒä»è®­ç»ƒæ•°æ®ä¸­å­¦åˆ°èƒ½é€‚ç”¨äºæ‰€æœ‰æ½œåœ¨æ ·æœ¬çš„â€œæ™®éè§„å¾‹â€ã€‚ä½†æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›å¯èƒ½å‡ºç°ä¸¤ç§æç«¯æƒ…å†µï¼š è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰ï¼š å­¦ä¹ å™¨å¯¹è®­ç»ƒæ ·æœ¬å­¦å¾—è¿‡äºâ€œç²¾å‡†â€ï¼Œç”šè‡³å°†è®­ç»ƒæ ·æœ¬ä¸­ç‰¹æœ‰çš„å™ªå£°æˆ–ä¸æ™®éçš„ç‰¹æ€§å½“æˆä¸€èˆ¬è§„å¾‹ã€‚è¿™ä¼šå¯¼è‡´æ¨¡å‹å¯¹æ–°æ ·æœ¬çš„æ³›åŒ–æ€§èƒ½ä¸‹é™ã€‚ æ¬ æ‹Ÿåˆï¼ˆUnderfittingï¼‰ï¼š å­¦ä¹ å™¨æ²¡æœ‰å……åˆ†æ•æ‰è®­ç»ƒæ ·æœ¬çš„ä¸€èˆ¬è§„å¾‹ï¼Œå¯¼è‡´æ¨¡å‹åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„è¡¨ç°éƒ½ä¸ç†æƒ³ã€‚ å¸¸è§åŸå› ï¼š è¿‡æ‹Ÿåˆï¼šå­¦ä¹ èƒ½åŠ›è¿‡å¼ºï¼Œæ¨¡å‹å¤æ‚åº¦è¿‡é«˜ã€‚ æ¬ æ‹Ÿåˆï¼šå­¦ä¹ èƒ½åŠ›ä¸è¶³ï¼Œæ¨¡å‹å¤æ‚åº¦è¿‡ä½ã€‚ è¿‡æ‹Ÿåˆæ˜¯æœºå™¨å­¦ä¹ ä¸­çš„ä¸€ä¸ªæ™®éç°è±¡ï¼Œæ— æ³•å½»åº•é¿å…ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç¼“è§£æˆ–å‡å°å…¶å½±å“ï¼š å¢åŠ è®­ç»ƒæ•°æ®ã€‚ ä½¿ç”¨æ­£åˆ™åŒ–ï¼ˆå¦‚ $L_1$ æˆ– $L_2$ æ­£åˆ™åŒ–ï¼‰ã€‚ é‡‡ç”¨æ—©åœï¼ˆEarly Stoppingï¼‰ç­–ç•¥ã€‚ ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å‹ï¼ˆé™ä½å¤æ‚åº¦ï¼‰ã€‚ å¼•å…¥äº¤å‰éªŒè¯ï¼ˆCross-Validationï¼‰è¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚ æœ¬è´¨é™åˆ¶ï¼šè¿‡æ‹Ÿåˆæ— æ³•å®Œå…¨é¿å…ï¼Œå› ä¸ºæœºå™¨å­¦ä¹ é—®é¢˜é€šå¸¸æ˜¯ NP éš¾æˆ–æ›´å¤æ‚çš„ï¼Œè€Œæœ‰æ•ˆçš„å­¦ä¹ ç®—æ³•å¿…ç„¶æ˜¯å¤šé¡¹å¼æ—¶é—´å†…è¿è¡Œå®Œæˆã€‚è¦å½»åº•é¿å…è¿‡æ‹Ÿåˆï¼Œç»éªŒè¯¯å·®æœ€å°åŒ–å°±èƒ½æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œè€Œè¿™åœ¨ç†è®ºä¸Šç­‰åŒäº $P=NP$ï¼ˆæ„é€ æ€§åœ°è¯æ˜ï¼‰ï¼Œç›®å‰å°šæœªè¢«è¯æ˜ã€‚ è®¸å¤šå­¦ä¹ é—®é¢˜ï¼ˆå¦‚ç¥ç»ç½‘ç»œæƒé‡ä¼˜åŒ–ã€æ”¯æŒå‘é‡æœºä¸­çš„æ ¸å‚æ•°é€‰æ‹©ç­‰ï¼‰æ¶‰åŠéå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œæˆ–éœ€è¦åœ¨ä¸€ä¸ªç¦»æ•£çš„ç»„åˆç©ºé—´ä¸­æœç´¢æœ€ä½³è§£ã€‚è¿™ç±»é—®é¢˜é€šå¸¸è¢«è¯æ˜ä¸º NPéš¾ã€‚ åœ¨å®é™…ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é¢ä¸´è®¸å¤šé€‰æ‹©ï¼ŒåŒ…æ‹¬ï¼š ä¸åŒçš„å­¦ä¹ ç®—æ³•ï¼ˆå¦‚å†³ç­–æ ‘ã€æ”¯æŒå‘é‡æœºã€æ·±åº¦å­¦ä¹ ï¼‰ã€‚ åŒä¸€ç®—æ³•çš„ä¸åŒå‚æ•°é…ç½®ï¼ˆå¦‚æ­£åˆ™åŒ–å¼ºåº¦ã€å­¦ä¹ ç‡ã€ç½‘ç»œç»“æ„ï¼‰ã€‚ è¿™å¼•å‡ºäº†æ¨¡å‹é€‰æ‹©ï¼ˆModel Selectionï¼‰é—®é¢˜ï¼š å¦‚ä½•é€‰æ‹©ä¸€ä¸ªæ³›åŒ–æ€§èƒ½æœ€å¥½çš„æ¨¡å‹ï¼Ÿ ç†æƒ³ç›®æ ‡ï¼šç›´æ¥è¯„ä¼°å€™é€‰æ¨¡å‹çš„æ³›åŒ–è¯¯å·®ï¼Œé€‰æ‹©æ³›åŒ–è¯¯å·®æœ€å°çš„æ¨¡å‹ã€‚ ç°å®å›°å¢ƒï¼šæ³›åŒ–è¯¯å·®æ— æ³•ç›´æ¥è·å¾—ï¼Œè®­ç»ƒè¯¯å·®åˆå¯èƒ½å› è¿‡æ‹Ÿåˆè€Œæ— æ³•å‡†ç¡®åæ˜ æ¨¡å‹æ€§èƒ½ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:3:1","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"è¯„ä¼°æ–¹æ³• åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¨¡å‹çš„æ€§èƒ½è¯„ä¼°æ˜¯å…³é”®çš„ä¸€ç¯ã€‚ä¸ºäº†è¡¡é‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼ˆå³åœ¨æ–°æ ·æœ¬ä¸Šçš„è¡¨ç°ï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡å®éªŒæµ‹è¯•æ¥è¯„ä¼°æ³›åŒ–è¯¯å·®ã€‚ä»¥ä¸‹å°†ä»‹ç»å‡ ç§å¸¸ç”¨çš„æ•°æ®é›†åˆ’åˆ†ä¸è¯„ä¼°æ–¹æ³•ï¼Œå¹¶æ¢è®¨å‚æ•°è°ƒèŠ‚çš„æŠ€å·§ã€‚ åœ¨è¯„ä¼°æ¨¡å‹æ—¶ï¼Œéœ€å°†åŸå§‹æ•°æ®é›† $D$ï¼ˆåŒ…å« $m$ ä¸ªæ ·æœ¬ï¼‰åˆ’åˆ†ä¸ºè®­ç»ƒé›† $S$ å’Œæµ‹è¯•é›† $T$ï¼Œå³ $D = S \\cup T$ ä¸” $S \\cap T = \\emptyset$ã€‚è®­ç»ƒé›†ç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œæµ‹è¯•é›†ç”¨äºè¯„ä¼°æ¨¡å‹åœ¨æœªè§æ ·æœ¬ä¸Šçš„è¡¨ç°ã€‚æµ‹è¯•è¯¯å·®ï¼ˆTesting Errorï¼‰è¢«è§†ä¸ºæ³›åŒ–è¯¯å·®çš„è¿‘ä¼¼ï¼Œå‡è®¾æµ‹è¯•æ ·æœ¬ä¸è®­ç»ƒæ ·æœ¬æ˜¯ä»ç›¸åŒåˆ†å¸ƒä¸­ç‹¬ç«‹åŒåˆ†å¸ƒæŠ½å–çš„ã€‚ 1. ç•™å‡ºæ³•ï¼ˆHold-out Methodï¼‰ ç•™å‡ºæ³•æ˜¯æœ€ç®€å•çš„è¯„ä¼°æ–¹æ³•ï¼Œå°†æ•°æ®é›† $D$ éšæœºåˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚ä¾‹å¦‚ï¼Œå¸¸ç”¨ 2/3 è‡³ 4/5 çš„æ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ï¼Œå…¶ä½™ä½œä¸ºæµ‹è¯•é›†ã€‚ æ³¨æ„äº‹é¡¹ï¼š æ•°æ®åˆ’åˆ†éœ€å°½é‡ä¿æŒåˆ†å¸ƒä¸€è‡´æ€§ï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡ä¸­ä¿æŒç±»åˆ«æ¯”ä¾‹ï¼‰ï¼Œå¯é€šè¿‡åˆ†å±‚é‡‡æ ·ï¼ˆStratified Samplingï¼‰å®ç°ã€‚ å•æ¬¡åˆ’åˆ†çš„è¯„ä¼°ç»“æœå¯èƒ½ä¸ç¨³å®šï¼Œå› æ­¤éœ€å¤šæ¬¡éšæœºåˆ’åˆ†ï¼Œå–å¹³å‡å€¼ä½œä¸ºæœ€ç»ˆè¯„ä¼°ç»“æœã€‚ æƒè¡¡ï¼š è®­ç»ƒé›†æ¯”ä¾‹è¿‡å¤§ï¼šæ¨¡å‹æ›´æ¥è¿‘ä½¿ç”¨å…¨æ•°æ®è®­ç»ƒçš„æƒ…å†µï¼Œä½†æµ‹è¯•é›†è¿‡å°å¯èƒ½å¯¼è‡´ç»“æœä¸ç¨³å®šã€‚ æµ‹è¯•é›†æ¯”ä¾‹è¿‡å¤§ï¼šæµ‹è¯•ç»“æœæ›´ç¨³å®šï¼Œä½†è®­ç»ƒé›†ä¸å…¨æ•°æ®å·®è·è¾ƒå¤§ï¼Œå¯èƒ½å½±å“è¯„ä¼°ç»“æœçš„ä¿çœŸæ€§ï¼ˆFidelityï¼‰ã€‚ 2. äº¤å‰éªŒè¯æ³•ï¼ˆCross-validationï¼‰ äº¤å‰éªŒè¯å°†æ•°æ®é›† $D$ åˆ†ä¸º $k$ ä¸ªå¤§å°ç›¸ç­‰çš„äº’æ–¥å­é›†ï¼š $D = D_1 \\cup D_2 \\cup â€¦ \\cup D_k$â€‹ï¼Œä¸” $D_i \\cap D_j = \\emptyset , (i \\neq j)$ æ¯æ¬¡ç”¨ $kâˆ’1$ ä¸ªå­é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä½™ä¸€ä¸ªå­é›†ä½œä¸ºæµ‹è¯•é›†ï¼Œé‡å¤ $k$ æ¬¡åå–æµ‹è¯•ç»“æœçš„å‡å€¼ä½œä¸ºæœ€ç»ˆè¯„ä¼°ç»“æœã€‚å¸¸è§çš„ $k$ å€¼ä¸º 10ï¼Œç§°ä¸º10 æŠ˜äº¤å‰éªŒè¯ï¼ˆ10-fold Cross-validationï¼‰ã€‚ ä¼˜ç‚¹ï¼š æ¯”ç•™å‡ºæ³•æ›´ç¨³å®šå¯é ã€‚ å¯éšæœºé‡å¤å¤šæ¬¡äº¤å‰éªŒè¯ï¼ˆå¦‚ 10 æ¬¡ 10 æŠ˜äº¤å‰éªŒè¯ï¼‰ï¼Œè¿›ä¸€æ­¥å‡å°‘åˆ’åˆ†å·®å¼‚çš„å½±å“ã€‚ ç‰¹ä¾‹ï¼šç•™ä¸€æ³•ï¼ˆLeave-One-Out Cross-validation, LOOï¼‰ ä»¤ $k=m$ï¼Œå³æ¯æ¬¡ä»…ç”¨ä¸€ä¸ªæ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™æ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ã€‚ LOO ä¸å—éšæœºåˆ’åˆ†å½±å“ï¼Œè®­ç»ƒé›†ä¸å…¨æ•°æ®é›†éå¸¸æ¥è¿‘ï¼Œä½†è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œå°¤å…¶åœ¨æ ·æœ¬é‡è¾ƒå¤§æ—¶ã€‚ åœ¨ç†è®ºä¸Šï¼Œå¤šæ¬¡ç•™å‡ºæ³•çš„éšæœºåˆ’åˆ†ç»“æœæœ‰å¯èƒ½ä¸äº¤å‰éªŒè¯æ³•æŸæ¬¡åˆ’åˆ†å®Œå…¨ä¸€è‡´ 3. è‡ªåŠ©æ³•ï¼ˆBootstrappingï¼‰ è‡ªåŠ©æ³•é€šè¿‡è‡ªåŠ©é‡‡æ ·ï¼ˆBootstrap Samplingï¼‰ç”Ÿæˆæ–°çš„è®­ç»ƒé›†ã€‚æ¯æ¬¡ä»åŸå§‹æ•°æ®é›† $D$ ä¸­éšæœºæŠ½å–ä¸€ä¸ªæ ·æœ¬æ”¾å…¥è®­ç»ƒé›†ï¼Œå¹¶å°†å…¶æ”¾å›ï¼Œå†æ¬¡é‡‡æ ·ï¼Œé‡å¤ $m$ æ¬¡ã€‚é‡‡æ ·åï¼š $Dâ€²$ ä¸ºè®­ç»ƒé›†ï¼ŒåŒ…å« $m$ ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­éƒ¨åˆ†æ ·æœ¬é‡å¤å‡ºç°ã€‚ $D \\setminus Dâ€™$ ä½œä¸ºæµ‹è¯•é›†ï¼ŒåŒ…å«çº¦ 36.8% çš„æœªè¢«é‡‡æ ·æ ·æœ¬ï¼ˆæ¦‚ç‡è®¡ç®—å¦‚ä¸‹ï¼‰ï¼š $P(\\text{æ ·æœ¬æœªè¢«é‡‡æ ·}) = (1 - \\frac{1}{m})^m \\approx e^{-1} \\approx 36.8%$ ç‰¹ç‚¹ï¼š é€‚ç”¨äºæ•°æ®é‡è¾ƒå°æˆ–éš¾ä»¥åˆ’åˆ†çš„åœºæ™¯ã€‚ å¯ç”Ÿæˆå¤šä¸ªè®­ç»ƒé›†ï¼Œç”¨äºé›†æˆå­¦ä¹ ç­‰æ–¹æ³•ã€‚ å±€é™ï¼š æ”¹å˜äº†æ•°æ®åˆ†å¸ƒï¼Œå¯èƒ½å¼•å…¥ä¼°è®¡åå·®ã€‚ å‚æ•°è°ƒèŠ‚ä¸æœ€ç»ˆæ¨¡å‹é€‰æ‹© æœºå™¨å­¦ä¹ æ¨¡å‹é€šå¸¸æœ‰å¤šä¸ªå‚æ•°éœ€è®¾å®šï¼Œä¸åŒå‚æ•°é…ç½®ä¼šæ˜¾è‘—å½±å“æ¨¡å‹æ€§èƒ½ã€‚è°ƒå‚ï¼ˆParameter Tuningï¼‰æ˜¯ä¼˜åŒ–æ¨¡å‹æ€§èƒ½çš„é‡è¦æ­¥éª¤ã€‚ å¸¸è§è°ƒå‚æ–¹æ³•ï¼š ç½‘æ ¼æœç´¢ï¼ˆGrid Searchï¼‰ï¼š ä¸ºæ¯ä¸ªå‚æ•°è®¾å®šå–å€¼èŒƒå›´å’Œæ­¥é•¿ï¼Œé€ä¸€è¯„ä¼°æ‰€æœ‰å‚æ•°ç»„åˆï¼Œé€‰æ‹©æ€§èƒ½æœ€ä½³è€…ã€‚ è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†å¯è¡Œæ€§ä¾èµ–äºå‚æ•°æ•°é‡å’Œå€™é€‰å€¼èŒƒå›´ã€‚ ç¤ºä¾‹ï¼š3 ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°æœ‰ 5 ä¸ªå€™é€‰å€¼ï¼Œéœ€è®­ç»ƒ $5^3 = 125$ ä¸ªæ¨¡å‹ã€‚ éšæœºæœç´¢ï¼ˆRandom Searchï¼‰ï¼š éšæœºé‡‡æ ·å‚æ•°ç»„åˆï¼Œé™ä½è®¡ç®—æˆæœ¬ã€‚ éªŒè¯é›†ï¼ˆValidation Setï¼‰ï¼š åœ¨è®­ç»ƒæ•°æ®ä¸­ç•™å‡ºä¸€éƒ¨åˆ†ä½œä¸ºéªŒè¯é›†ï¼Œç”¨äºæ¨¡å‹è¯„ä¼°å’Œå‚æ•°è°ƒèŠ‚ã€‚ å®é™…æµ‹è¯•æ•°æ®åˆ™ä¿ç•™ç”¨äºæœ€ç»ˆæµ‹è¯•ã€‚ å¸¸ç”¨çš„æ¯”ä¾‹æ˜¯è®­ç»ƒé›†å  70%~80%ï¼Œæµ‹è¯•é›†å  20%~30%ã€‚å†ä»è®­ç»ƒé›†åˆ’åˆ†å‡ºéªŒè¯é›†ï¼Œå¸¸è§æ¯”ä¾‹æ˜¯ï¼šè®­ç»ƒé›†å åŸå§‹æ•°æ®çš„ 60%~70%ï¼ŒéªŒè¯é›†å  10%~20%ã€‚ éªŒè¯é›†å…è®¸æ¨¡å‹åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°è¯•ä¸åŒçš„ç®—æ³•æˆ–å‚æ•°è®¾ç½®ï¼Œä¸ºæ¨¡å‹é€‰æ‹©å’Œè°ƒå‚æä¾›ä¾æ®ï¼Œè€Œæµ‹è¯•é›†ä¸å‚ä¸è¿™ä¸ªè¿‡ç¨‹ï¼Œä»¥é˜²æ­¢è¯„ä¼°åå·®ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:3:2","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"ç¥ç»ç½‘ç»œ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:4:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"ç¥ç»å…ƒæ¨¡å‹ ç¥ç»ç½‘ç»œæ˜¯ç”±å…·æœ‰é€‚åº”æ€§çš„ç®€å•å•å…ƒç»„æˆçš„å¹¿æ³›å¹¶è¡Œäº’è¿çš„ç½‘ç»œï¼Œå®ƒçš„ç»„ç»‡èƒ½å¤Ÿæ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç³»ç»Ÿå¯¹çœŸå®ä¸–ç•Œç‰©ä½“æ‰€ä½œå‡ºçš„äº¤äº’ååº”ã€‚ç¥ç»ç½‘ç»œä¸­æœ€åŸºæœ¬çš„æˆåˆ†æ˜¯ç¥ç»å…ƒ (neuron)æ¨¡å‹ã€‚ ï¼ˆM-P ç¥ç»å…ƒï¼‰ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:4:1","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"æ„ŸçŸ¥æœºå’Œå¤šå±‚ç½‘ç»œ æ„ŸçŸ¥æœº (Perceptron) ç”±ä¸¤å±‚ ç¥ç»å…ƒ ç»„æˆï¼Œæ„ŸçŸ¥æœºèƒ½å®¹æ˜“åœ°å®ç°é€»è¾‘ä¸ã€æˆ–ã€éè¿ç®—ã€‚ å²ä¸€èˆ¬çš„ï¼Œå¸¸è§çš„ç¥ç»ç½‘ç»œæ˜¯å½¢å¦‚å›¾æ‰€ç¤ºçš„å±‚çº§ç»“æ„ï¼Œæ¯å±‚ç¥ç»å…ƒä¸ä¸‹ å±‚ç¥ç»å…ƒå…¨äº’è¿ã€‚ç¥ç»å…ƒä¹‹é—´ä¸å­˜åœ¨åŒå±‚è¿æ¥ï¼Œä¹Ÿä¸å­˜åœ¨è·¨å±‚è¿æ¥ã€‚è¿™æ · çš„ ç¥ç»ç½‘ç»œç»“æ„é€šå¸¸ç§°ä¸º\" å¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œ \" (multi-layer feedforward neural networks) ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:4:2","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"åå‘ä¼ æ’­ç®—æ³• æœ€å¸¸ç”¨çš„ç¥ç»ç½‘ç»œè®­ç»ƒæ–¹æ³•ï¼Œè¯¦è§ï¼š https://ml-cheatsheet.readthedocs.io/en/latest/backpropagation.html ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:4:3","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"æ·±åº¦å­¦ä¹ è®­ç»ƒæŠ€å·§ æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­çš„å˜é‡ï¼š æ•°æ®é›† æ¨¡å‹ç»“æ„ï¼ˆmodel biasï¼‰ è¶…å‚æ•° epochæ•°ç›®ï¼Œbatchå¤§å°ç­‰ loss function ä¼˜åŒ–ç®—æ³• è§£å†³é—®é¢˜éƒ½å¾—ä»è¿™å‡ ä¸ªæ–¹é¢å…¥æ‰‹ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:5:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"åº”å¯¹æ¬ æ‹Ÿåˆé—®é¢˜ ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œç¥ç»ç½‘ç»œçš„ç›®æ ‡æ˜¯æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚ç„¶è€Œï¼Œä¼˜åŒ–è¿‡ç¨‹å¯èƒ½ä¼šé‡åˆ°å¤šç§æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­ã€‚ Adamç®—æ³•ç»“åˆäº†RMSPropå’ŒåŠ¨é‡æ–¹æ³•ï¼Œæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•ä¹‹ä¸€ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæé«˜è®­ç»ƒé€Ÿåº¦ï¼Œå¹¶é¿å…æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚æœ€ä¸ºå¸¸ç”¨ã€‚ 1. å±€éƒ¨æœ€ä¼˜ä¸éç‚¹ å±€éƒ¨æœ€ä¼˜è§£ï¼šæŸå¤±å‡½æ•°åœ¨æŸä¸ªå±€éƒ¨åŒºåŸŸå†…è¾¾åˆ°æœ€å°å€¼ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¼˜åŒ–ç®—æ³•åœ¨è¯¥ç‚¹åœæ»ï¼Œä»è€Œå½±å“æ¨¡å‹çš„è®­ç»ƒã€‚ éç‚¹ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œéç‚¹æ¯”å±€éƒ¨æœ€ä¼˜è§£æ›´å¤šã€‚éç‚¹çš„æ¢¯åº¦ä¸ºé›¶ï¼Œä½†å®ƒæ—¢ä¸æ˜¯æœ€å°å€¼ä¹Ÿä¸æ˜¯æœ€å¤§å€¼ï¼Œä¼˜åŒ–ç®—æ³•å®¹æ˜“è¢«å¡åœ¨è¿™ç§ç‚¹ä¸Šã€‚ è§£å†³éç‚¹ï¼šå¯ä»¥é€šè¿‡è®¡ç®—HessiançŸ©é˜µæ¥åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦ä¸ºéç‚¹ã€‚è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨åŠ¨é‡å’Œè‡ªé€‚åº”å­¦ä¹ ç‡ç­‰æŠ€æœ¯å¯ä»¥å¸®åŠ©é¿å…è¢«å¡ä½ã€‚ 2. å°æ‰¹é‡ä¸å™ªå£° å°æ‰¹é‡çš„ä¼˜åŠ¿ï¼šå°æ‰¹é‡è®­ç»ƒæ—¶ï¼Œç”±äºæ¯ä¸ªæ‰¹æ¬¡çš„æ ·æœ¬è¾ƒå°‘ï¼Œå™ªå£°è¾ƒå¤§ï¼Œè¿™ç§å™ªå£°æœ‰åŠ©äºæ¨¡å‹è·³å‡ºå±€éƒ¨æœ€å°å€¼ï¼Œé¿å…é™·å…¥â€œå³¡è°·â€ä¸­ã€‚å®éªŒè¯æ˜ï¼Œå°æ‰¹é‡è®­ç»ƒæœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•é›†ä¸Šçš„è¡¨ç°é€šå¸¸æ›´å¥½ã€‚ åŠ£åŠ¿ï¼šå°æ‰¹é‡è®­ç»ƒéœ€è¦æ›´å¤šçš„æ—¶é—´æ¥å®Œæˆä¸€ä¸ªepochï¼Œå› ä¸ºæ¯ä¸ªbatchçš„è®­ç»ƒæ—¶é—´è¾ƒé•¿ã€‚ å¤§æ‰¹é‡çš„åŠ£åŠ¿ï¼šå¤§æ‰¹é‡è®­ç»ƒæ—¶ï¼Œç”±äºå™ªå£°è¾ƒå°ï¼Œæ¨¡å‹æ›´å®¹æ˜“åœç•™åœ¨å±€éƒ¨æœ€å°å€¼ï¼Œä»è€Œå¯¼è‡´è®­ç»ƒæ•ˆæœä¸ä½³ã€‚ 3. è‡ªé€‚åº”å­¦ä¹ ç‡ å­¦ä¹ ç‡æ˜¯æ§åˆ¶æ¢¯åº¦ä¸‹é™æ­¥ä¼çš„é‡è¦è¶…å‚æ•°ã€‚è¿‡å¤§çš„å­¦ä¹ ç‡å¯èƒ½å¯¼è‡´ä¼˜åŒ–è¿‡ç¨‹ä¸ç¨³å®šï¼Œè¿‡å°çš„å­¦ä¹ ç‡åˆ™å¯èƒ½å¯¼è‡´æ”¶æ•›ç¼“æ…¢ã€‚ è‡ªé€‚åº”å­¦ä¹ ç‡ï¼šä½¿ç”¨Adagradã€RMSPropã€Adamç­‰è‡ªé€‚åº”å­¦ä¹ ç‡ç®—æ³•ï¼Œå¯ä»¥æ ¹æ®æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦å¤§å°è°ƒæ•´æ­¥ä¼ï¼Œä»è€Œæé«˜è®­ç»ƒæ•ˆç‡å’Œæ”¶æ•›é€Ÿåº¦ã€‚ å­¦ä¹ ç‡è°ƒåº¦ï¼šé€æ¸é™ä½å­¦ä¹ ç‡ï¼ˆå¦‚é€šè¿‡å­¦ä¹ ç‡è¡°å‡æˆ–warm-upç­–ç•¥ï¼‰ï¼Œèƒ½å¤Ÿé¿å…éœ‡è¡ï¼Œå¸®åŠ©ç½‘ç»œæ‰¾åˆ°æ›´ç²¾ç¡®çš„è§£ã€‚ 4. åŠ¨é‡ï¼ˆMomentumï¼‰ åŠ¨é‡æ–¹æ³•é€šè¿‡ç»“åˆå½“å‰çš„æ¢¯åº¦å’Œå‰ä¸€æ—¶åˆ»çš„æ¢¯åº¦ä¿¡æ¯ï¼Œå¸®åŠ©ç½‘ç»œåœ¨é‡åˆ°å±€éƒ¨æœ€å°å€¼æ—¶ç»§ç»­å‘å‰æ¨è¿›ï¼Œé¿å…åœæ»åœ¨å±€éƒ¨æœ€å°å€¼ã€‚åŠ¨é‡æ–¹æ³•æ¨¡ä»¿ç‰©ç†ä¸­å°çƒæ»šåŠ¨çš„ç°è±¡ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å…·æœ‰è¾ƒå¼ºçš„ç¨³å®šæ€§ã€‚ 5. æ‰¹å½’ä¸€åŒ–ï¼ˆBatch Normalizationï¼‰ æ‰¹å½’ä¸€åŒ–é€šè¿‡å¯¹æ¯å±‚è¾“å…¥è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ¶ˆé™¤ä¸åŒç»´åº¦é—´çš„å·®å¼‚ï¼Œä½¿å¾—ç½‘ç»œè®­ç»ƒæ›´åŠ ç¨³å®šã€‚ å¹³å¦åŒ–è¯¯å·®è¡¨é¢ï¼šæ‰¹å½’ä¸€åŒ–èƒ½æœ‰æ•ˆå¹³æ»‘æŸå¤±å‡½æ•°ï¼Œå‡å°‘è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°ä¸å‡åŒ€çš„è¯¯å·®ã€‚ è®­ç»ƒä¸æµ‹è¯•çš„åŒºåˆ«ï¼šåœ¨è®­ç»ƒæ—¶ï¼Œæ‰¹å½’ä¸€åŒ–ä½¿ç”¨å½“å‰æ‰¹æ¬¡çš„æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œè€Œåœ¨æµ‹è¯•æ—¶ä½¿ç”¨è®­ç»ƒæœŸé—´è®¡ç®—çš„å‡å€¼å’Œæ–¹å·®ã€‚ 6. æ¿€æ´»å‡½æ•°çš„é€‰æ‹© æ¿€æ´»å‡½æ•°å¯¹ä¼˜åŒ–è¿‡ç¨‹æœ‰ç€é‡è¦å½±å“ã€‚ä¸åŒçš„æ¿€æ´»å‡½æ•°ä¼šå†³å®šç½‘ç»œçš„éçº¿æ€§èƒ½åŠ›ï¼Œä»è€Œå½±å“ä¼˜åŒ–æ•ˆæœã€‚ ReLUï¼ˆRectified Linear Unitï¼‰ï¼šReLUæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å…æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¹¶ä¸”è®¡ç®—æ•ˆç‡é«˜ã€‚ Sigmoidå’ŒTanhï¼šè¿™äº›æ¿€æ´»å‡½æ•°é€‚ç”¨äºæµ…å±‚ç½‘ç»œï¼Œä½†åœ¨æ·±å±‚ç½‘ç»œä¸­å®¹æ˜“å‡ºç°æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå½±å“è®­ç»ƒæ•ˆæœã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:5:1","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"åº”å¯¹è¿‡æ‹Ÿåˆé—®é¢˜ è¿‡æ‹Ÿåˆæ˜¯æ·±åº¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­å¸¸è§çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šæ€§èƒ½è¾ƒå·®æ—¶ã€‚ä¸ºäº†å‡å°‘è¿‡æ‹Ÿåˆï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š 1. å¢åŠ æ•°æ®é‡ æ•°æ®å¢å¼ºï¼šé€šè¿‡å¯¹ç°æœ‰æ•°æ®è¿›è¡Œæ—‹è½¬ã€å¹³ç§»ã€ç¼©æ”¾ç­‰å˜æ¢ï¼Œç”Ÿæˆæ›´å¤šçš„æ ·æœ¬ï¼Œä»¥å‡å°‘æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®çš„ä¾èµ–ï¼Œä»è€Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚ æ­£åˆ™åŒ–æŠ€æœ¯ï¼šå¦‚L2æ­£åˆ™åŒ–å’Œdropoutç­‰ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæŠ‘åˆ¶æ¨¡å‹çš„è¿‡æ‹Ÿåˆã€‚ 2. æ­£åˆ™åŒ–æ–¹æ³• L2æ­£åˆ™åŒ–ï¼šé€šè¿‡åœ¨æŸå¤±å‡½æ•°ä¸­å¢åŠ æƒ©ç½šé¡¹ï¼Œè¿«ä½¿æ¨¡å‹å‚æ•°ä¿æŒè¾ƒå°çš„å€¼ï¼Œä»è€Œé¿å…æ¨¡å‹è¿‡äºå¤æ‚ã€‚ Dropoutï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­éšæœºä¸¢å¼ƒä¸€å®šæ¯”ä¾‹çš„ç¥ç»å…ƒï¼Œè¿™æ ·å¯ä»¥é¿å…ç½‘ç»œè¿‡åº¦ä¾èµ–æŸäº›ç‰¹å®šç¥ç»å…ƒï¼Œä»è€Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚ 3. æå‰åœæ­¢ï¼ˆEarly Stoppingï¼‰ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ç›‘æ§éªŒè¯é›†çš„æŸå¤±ï¼Œè‹¥éªŒè¯é›†æŸå¤±ä¸å†ä¸‹é™æˆ–å¼€å§‹ä¸Šå‡ï¼Œåˆ™æå‰åœæ­¢è®­ç»ƒã€‚è¿™æ ·å¯ä»¥é¿å…æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¿‡æ‹Ÿåˆã€‚ 4. æ›´ç®€å•çš„æ¨¡å‹ç»“æ„ å‡å°ç½‘ç»œè§„æ¨¡ï¼šä½¿ç”¨è¾ƒå°çš„ç½‘ç»œç»“æ„ï¼ˆä¾‹å¦‚å‡å°‘ç½‘ç»œå±‚æ•°æˆ–ç¥ç»å…ƒæ•°é‡ï¼‰ï¼Œå¯ä»¥å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ï¼Œä»è€Œé™ä½è¿‡æ‹Ÿåˆçš„é£é™©ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:5:2","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"åˆ†ç±»ä»»åŠ¡ä¸­çš„ä¼˜åŒ–ç­–ç•¥ åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œä¼˜åŒ–ç­–ç•¥éœ€è¦æ ¹æ®ä»»åŠ¡çš„ç‰¹ç‚¹è¿›è¡Œè°ƒæ•´ï¼š 1. åˆ†ç±»é—®é¢˜è½¬åŒ–ä¸ºå›å½’é—®é¢˜ æœ‰æ—¶å°†åˆ†ç±»é—®é¢˜è½¬åŒ–ä¸ºå›å½’é—®é¢˜è¿›è¡Œè§£å†³ï¼Œç½‘ç»œè¾“å‡ºä¸€ä¸ªè¿ç»­å€¼ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¼•å…¥ä¼ªå…³ç³»ï¼Œå› æ­¤æ›´å¸¸è§çš„æ˜¯ä½¿ç”¨One-hotå‘é‡ä½œä¸ºè¾“å‡ºï¼Œå¹¶ç»“åˆSoftmaxå‡½æ•°è¿›è¡Œæ ‡å‡†åŒ–ã€‚ 2. æŸå¤±å‡½æ•°çš„é€‰æ‹© äº¤å‰ç†µæŸå¤± (Cross-Entropy Loss)ï¼šå¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å¤šåˆ†ç±»ä»»åŠ¡ï¼Œäº¤å‰ç†µæŸå¤±æ˜¯æ›´åˆé€‚çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯ä¸Softmaxç»“åˆä½¿ç”¨æ—¶ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æŒ‡å¯¼ä¼˜åŒ–è¿‡ç¨‹ã€‚ ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:5:3","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["AI"],"content":"Pytorchâ€”â€”æ‰‹å†™æ•°å­—è¯†åˆ«çš„ä¾‹å­ pytorch internals import torch import torch.nn as nn import torch.optim as optim import torch.nn.functional as F from torch.utils.data import DataLoader from torchvision import datasets, transforms from torch.utils.data import random_split # è¶…å‚æ•° batch_size = 64 learning_rate = 0.001 epochs = 10 dropout_rate = 0.5 # 1. æ•°æ®åŠ è½½å’Œé¢„å¤„ç† transform = transforms.Compose([ transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,)) ]) # åŠ è½½MNISTæ•°æ®é›† train_dataset = datasets.MNIST(root='./data', train=True, download=True, transform=transform) test_dataset = datasets.MNIST(root='./data', train=False, download=True, transform=transform) # æ•°æ®åˆ†æ‰¹æ¬¡å¤„ç† train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=True) test_loader = DataLoader(test_dataset, batch_size=batch_size, shuffle=False) # 2. å®šä¹‰å·ç§¯ç¥ç»ç½‘ç»œ (CNN) class SimpleCNN(nn.Module): def __init__(self): super(SimpleCNN, self).__init__() # ç¬¬ä¸€å·ç§¯å±‚ï¼Œè¾“å…¥1ä¸ªé€šé“ï¼Œè¾“å‡º32ä¸ªé€šé“ self.conv1 = nn.Conv2d(1, 32, kernel_size=3, stride=1, padding=1) self.bn1 = nn.BatchNorm2d(32) # æ‰¹å½’ä¸€åŒ– # ç¬¬äºŒå·ç§¯å±‚ï¼Œè¾“å…¥32ä¸ªé€šé“ï¼Œè¾“å‡º64ä¸ªé€šé“ self.conv2 = nn.Conv2d(32, 64, kernel_size=3, stride=1, padding=1) self.bn2 = nn.BatchNorm2d(64) # æ‰¹å½’ä¸€åŒ– # ç¬¬ä¸‰å·ç§¯å±‚ï¼Œè¾“å…¥64ä¸ªé€šé“ï¼Œè¾“å‡º128ä¸ªé€šé“ self.conv3 = nn.Conv2d(64, 128, kernel_size=3, stride=1, padding=1) self.bn3 = nn.BatchNorm2d(128) # æ‰¹å½’ä¸€åŒ– # çº¿æ€§å±‚ï¼ˆå…¨è¿æ¥å±‚ï¼‰ self.fc1 = nn.Linear(128 * 7 * 7, 512) self.fc2 = nn.Linear(512, 10) # è¾“å‡º10ä¸ªç±»åˆ«ï¼ˆMNISTæ˜¯0-9çš„æ•°å­—ï¼‰ # Dropoutå±‚ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ self.dropout = nn.Dropout(p=dropout_rate) def forward(self, x): # å·ç§¯å±‚ + æ¿€æ´»å‡½æ•° + æ‰¹å½’ä¸€åŒ– + æ± åŒ– x = F.relu(self.bn1(self.conv1(x))) x = F.max_pool2d(x, 2) x = F.relu(self.bn2(self.conv2(x))) x = F.max_pool2d(x, 2) x = F.relu(self.bn3(self.conv3(x))) x = F.max_pool2d(x, 2) # å°†ç‰¹å¾å›¾å±•å¹³ï¼ˆFlattenï¼‰ x = x.view(-1, 128 * 7 * 7) # å…¨è¿æ¥å±‚ x = F.relu(self.fc1(x)) x = self.dropout(x) # åœ¨å…¨è¿æ¥å±‚ååº”ç”¨Dropout x = self.fc2(x) return x # 3. æ¨¡å‹ã€æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨ model = SimpleCNN() # Adamä¼˜åŒ–å™¨ï¼Œå¹¶ä½¿ç”¨L2æ­£åˆ™åŒ–ï¼ˆweight decayï¼‰ optimizer = optim.Adam(model.parameters(), lr=learning_rate, weight_decay=0.0001) # ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆé€‚ç”¨äºåˆ†ç±»ä»»åŠ¡ï¼‰ criterion = nn.CrossEntropyLoss() # 4. è®­ç»ƒè¿‡ç¨‹ def train(model, train_loader, optimizer, criterion, epoch): model.train() running_loss = 0.0 correct = 0 total = 0 for batch_idx, (data, target) in enumerate(train_loader): # å°†æ•°æ®ç§»åˆ°GPUï¼ˆå¦‚æœå¯ç”¨ï¼‰ data, target = data.cuda(), target.cuda() # æ¸…é™¤æ¢¯åº¦ optimizer.zero_grad() # å‘å‰ä¼ æ’­ output = model(data) # è®¡ç®—æŸå¤± loss = criterion(output, target) running_loss += loss.item() # å‘åä¼ æ’­ loss.backward() # æ›´æ–°å‚æ•° optimizer.step() # è®¡ç®—å‡†ç¡®åº¦ _, predicted = torch.max(output, 1) total += target.size(0) correct += (predicted == target).sum().item() # æ‰“å°æ¯ä¸ªepochçš„æŸå¤±å’Œå‡†ç¡®ç‡ print(f'Epoch {epoch}, Loss: {running_loss/len(train_loader):.4f}, Accuracy: {100. * correct/total:.2f}%') # 5. æµ‹è¯•è¿‡ç¨‹ def test(model, test_loader, criterion): model.eval() # åˆ‡æ¢ä¸ºè¯„ä¼°æ¨¡å¼ test_loss = 0.0 correct = 0 total = 0 with torch.no_grad(): # æµ‹è¯•æ—¶ä¸éœ€è¦è®¡ç®—æ¢¯åº¦ for data, target in test_loader: # å°†æ•°æ®ç§»åˆ°GPUï¼ˆå¦‚æœå¯ç”¨ï¼‰ data, target = data.cuda(), target.cuda() # å‘å‰ä¼ æ’­ output = model(data) # è®¡ç®—æŸå¤± loss = criterion(output, target) test_loss += loss.item() # è®¡ç®—å‡†ç¡®åº¦ _, predicted = torch.max(output, 1) total += target.size(0) correct += (predicted == target).sum().item() # æ‰“å°æµ‹è¯•é›†ä¸Šçš„æŸå¤±å’Œå‡†ç¡®ç‡ print(f'Test Loss: {test_loss/len(test_loader):.4f}, Test Accuracy: {100. * correct/total:.2f}%') # 6. è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹ # å¦‚æœæœ‰GPUï¼Œä½¿ç”¨GPUè®­ç»ƒ device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\") model.to(device) for epoch in range(1, epochs + 1): train(model, train_loader, optimizer, criterion, epoch) test(model, test_loader, criterion) ","date":"2025-01-13","objectID":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/:6:0","tags":["DeepLearning","Summary"],"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/"},{"categories":["Sociology"],"content":" äººä»¬è‡ªå·±åˆ›é€ è‡ªå·±çš„å†å²ï¼Œä½†æ˜¯ä»–ä»¬å¹¶ä¸æ˜¯éšå¿ƒæ‰€æ¬²åœ°åˆ›é€ ï¼Œå¹¶ä¸æ˜¯åœ¨ä»–ä»¬è‡ªå·±é€‰å®šçš„æ¡ä»¶ä¸‹åˆ›é€ ï¼Œè€Œæ˜¯åœ¨ç›´æ¥ç¢°åˆ°çš„ã€æ—¢å®šçš„ã€ä»è¿‡å»ç»§æ‰¿ä¸‹æ¥çš„æ¡ä»¶ä¸‹åˆ›é€ ã€‚ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:0:0","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"å†™åœ¨å‰é¢çš„æ„Ÿæƒ³ å‰ç™»æ–¯çš„è¿™æœ¬ã€Œç¤¾ä¼šå­¦ã€è™½ç„¶åªæœ‰è–„è–„ç™¾ä½™é¡µï¼Œå´éƒ½æ˜¯ç²¾åã€‚åšç¬”è®°æ—¶å·®ç‚¹æŠŠæ•´æœ¬ä¹¦éƒ½å¤åˆ¶ä¸€éâ€¦ï¼ˆæ‰€ä»¥ä¸å…¶çœ‹ç¬”è®°å€’ä¸å¦‚å»çœ‹ä¹¦_(â”ã€ŒÎµ:)_ è¯»å®Œå°è±¡æœ€æ·±åˆ»çš„è§‚ç‚¹æœ‰ï¼š ç¤¾ä¼šå­¦ä¸åŒäºè‡ªç„¶ç§‘å­¦ï¼Œæ˜¯æ‰¹åˆ¤çš„å­¦ç§‘ ç¤¾ä¼šå­¦ç†è®ºçš„ä¸¤å¤§ä¸»æµï¼šèµ„æœ¬ä¸»ä¹‰ç†è®ºå’Œå·¥ä¸šç¤¾ä¼šç†è®º å‰ç™»æ–¯ç®€è¦ä»‹ç»äº†è¿™ä¸¤ç§ç†è®ºï¼Œå¹¶å¯¹æ¯”äº†è¿™ä¸¤ç§ç†è®ºå¯¹ç°ä»£ç¤¾ä¼šçš„ä¸åŒçœ‹æ³• å‰ç™»æ–¯åŒæ—¶æ‰¹åˆ¤äº†ä¸¤ç§ç†è®ºï¼Œè®¤ä¸ºçœŸç›¸åº”è¯¥æ˜¯æŸç§æŠ˜ä¸­ æ­¤å¤–ï¼Œæˆ‘ä¹Ÿæ„Ÿå—åˆ°ï¼Œè¿™äº›ç¤¾ä¼šå­¦ç†è®ºçš„èƒŒåéƒ½æœ‰ä¸€äº›åŸºæœ¬çš„ä»·å€¼ï¼Œæˆ‘æ‰€æ€»ç»“å‡ºçš„æ˜¯ï¼šæœºä¼šå¹³ç­‰ å’Œ ç»“æœå¹³ç­‰ã€‚è¿™ä¸¤è€…ä¸å¯å¾—å…¼ï¼Œä½†ä¹Ÿè¦ä¸€å®šç¨‹åº¦ä¸Šå…¼é¡¾ã€‚å‰è€…æ¿€åŠ±äººä»¬å¥‹å‘å›¾å¼ºï¼Œåè€…èƒ½ä¿è¯ç¤¾ä¼šå’Œè°ã€‚ã€Œç¤¼è®°ã€ä¸­çš„ã€Œé¸è³¢èˆ‡èƒ½ï¼Œè¬›ä¿¡ä¿®ç¦ã€ä¼¼ä¹å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬è‚¯å®šä¹Ÿæœ‰åˆ«çš„ä»·å€¼ï¼šæ¯”å¦‚è‡ªç”±ï¼Œæ¯”å¦‚å®¶åº­â€¦ ä½†æ˜¯è¿™ä¸¤ç§å¹³ç­‰ä¼¼ä¹æ‰æ˜¯ç°ä»£èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šé¢ä¸´çš„æ ¸å¿ƒé—®é¢˜ã€‚ èµ„æœ¬ä¸»ä¹‰å’Œå·¥ä¸šç¤¾ä¼šç†è®ºçš„åˆ†æ­§ç‚¹åœ¨äºï¼š å¯¹äºç¤¾ä¼šç°çŠ¶çš„åˆ¤æ–­ä¸åŒï¼šå¦‚æœæœ‰æ›´å¥½çš„è°ƒæŸ¥æ–¹æ³•å’Œæ›´è¯¦å®çš„æ•°æ®ï¼Œåº”è¯¥å°±èƒ½å¼¥åˆè¿™ä¸ªåˆ†æ­§ å¯¹äºæœªæ¥çš„é¢„æµ‹ä¸åŒï¼šè¿™ä¸»è¦æºäºä»–ä»¬æ‰€æ„å»ºçš„ç†è®ºä¸åŒã€‚ä¸€ä¸ªå¥½çš„ç†è®ºåº”è¯¥èƒ½ç»å¾—èµ·å®è·µçš„æ£€éªŒ åŸºæœ¬ä»·å€¼çš„åå·®ï¼šå¦‚å¯†é‡Œæœ¬å¾·ç›¸å¯¹äºæ‹‰ä¼¦å¤šå¤«ï¼Œä¼¼ä¹æ›´é‡è§†ç»“æœå¹³ç­‰ã€‚å‰ä¸¤è€…çš„åˆ†æ­§éƒ½å¯ä»¥ç”¨è‡ªç„¶ç§‘å­¦çš„æ–¹æ³•æ¥å¼¥è¡¥ï¼Œä½†æ˜¯ä»·å€¼è§‚çš„åå·®å°±ä¸èƒ½äº†ã€‚ ä¸è¿‡ï¼Œä»·å€¼è§‚ä¹Ÿå¹¶ä¸æ˜¯ä»€ä¹ˆå…ˆå¤©å°±åˆ»åœ¨DNAé‡Œçš„ä¸œè¥¿ï¼Œè€Œæ˜¯å—åˆ°æˆ‘ä»¬çš„ç¤¾ä¼šå®è·µå’Œç¤¾ä¼šè®¤è¯†çš„å½±å“ã€‚æ‰€ä»¥ç¤¾ä¼šå­¦å°±åƒç¤¾ä¼šè‡ªèº«çš„å“²å­¦ä¸€æ ·ï¼Œä¼šåœ¨å®è·µä¸­ä¸æ–­é‡æ–°å®šä¹‰è‡ªèº«ã€‚ å°±åƒæˆ‘ä»¬éœ€è¦å“²å­¦ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ç¤¾ä¼šå­¦ã€‚è¿™æ˜¯ç”±äººæœ¬èº«ç†è§£ä¸–ç•Œçš„å†²åŠ¨å†³å®šçš„ã€‚å³ä½¿è¿™ç§ç†è§£åªæ˜¯ç‰¹å®šæ¡ä»¶ä¸‹çš„è°è¨€ï¼Œæˆ–è€…éƒ¨åˆ†çš„çœŸç†ï¼Œå®ƒä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚ æ­¤å¤–ï¼Œåœ¨äº†è§£äº†ç¤¾ä¼šå­¦çš„å¤§ä½“æ¡†æ¶åï¼Œæˆ‘ä¹Ÿäº§ç”Ÿäº†ä¸‹é¢ä¸€äº›é—®é¢˜ï¼Œç­‰å¾…åç»­æœ‰æœºä¼šå†å»ç ”ç©¶ã€‚ èµ„æœ¬ä¸»ä¹‰çš„é—®é¢˜ï¼šé©¬å…‹æ€è®¤ä¸ºèµ„æœ¬ä¸»ä¹‰äº§æƒä»¥åŠè‡ªç”±çš„æ¦‚å¿µæœ¬èº«å°±è•´è—äº†ä¸å¹³ç­‰â€”â€”ç©¶ç«Ÿå“ªé‡Œä¸å¹³ç­‰äº†ï¼Ÿéš¾é“æœ‰ä¸€ç§åœ¨å…·æœ‰ç›¸åŒè‡ªç”±çš„ç¨‹åº¦ä¸‹è¿˜æ›´å¹³ç­‰çš„ç¤¾ä¼šå½¢æ€å—ï¼Ÿ ç¬¬ä¸‰æ¡é“è·¯ï¼šå‰ç™»æ–¯ä»¥åŠè®¸å¤šäººä¸»å¼ èµ„æœ¬ä¸»ä¹‰å’Œç¤¾ä¼šä¸»ä¹‰ä¹‹å¤–çš„â€œç¬¬ä¸‰æ¡é“è·¯â€ï¼ˆè™½ç„¶æ²¡æœ‰æ˜ç¡®æå‡ºï¼‰ï¼Œä¼¼ä¹åœ¨ä¸Šä¸ªä¸–çºªä¹Ÿæœ‰ä¸å°‘æ”¿å…šè·µè¡Œè¿™ä¸€ç†è®ºã€‚ç¬¬ä¸‰æ¡é“è·¯ç©¶ç«Ÿæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿå®ƒæˆåŠŸäº†å—ï¼Ÿ å‚ä¸å¼æ°‘ä¸»ï¼šå‰ç™»æ–¯æå‡ºï¼Œç°æœ‰çš„ä»£è®®åˆ¶æ°‘ä¸»å­˜åœ¨è®¸å¤šé—®é¢˜ï¼Œå…¶æœ¬èº«çš„å‰æå°±æ˜¯å®˜åƒšåˆ¶ï¼Œè€Œä¸”æ°‘ä¸»åªä¿ç•™åœ¨äº†æ”¿æ²»é¢†åŸŸã€‚ä½†æ˜¯ï¼Œåœ¨äººå£ä¼—å¤šçš„å‰æä¸‹ï¼Œéš¾é“çœŸçš„èƒ½å®ç°å‚ä¸å¼æ°‘ä¸»å—ï¼Ÿ è‡ªç”±å¸‚åœºçš„é—®é¢˜ï¼šè®¸å¤šç¤¾ä¼šå­¦å®¶å¯¹è‡ªç”±å¸‚åœºæå‡ºäº†æ‰¹åˆ¤ï¼Œè®¤ä¸ºå…¶é€åˆ©çš„æœ¬æ€§åè€Œé™åˆ¶äº†äººè‡ªå‘ç”Ÿäº§çš„ç§¯ææ€§ã€‚ç”šè‡³å¯¹å„æ–­èµ„æœ¬æå‡ºäº†èµæ‰¬â€”â€”å„æ–­èµ„æœ¬è‡³å°‘æ²¡æœ‰é‚£ä¹ˆé€åˆ©ã€‚ä½†æ˜¯æ˜¾ç„¶ç«äº‰ä¸å……åˆ†ä¹Ÿé™ä½äº†å¸‚åœºæ•ˆç‡ã€‚é‚£ä¹ˆï¼Œä¸å……åˆ†çš„ç«äº‰ç©¶ç«Ÿåœ¨ä»€ä¹ˆç¨‹åº¦ä¸Šï¼Œä»¥ä»€ä¹ˆæ–¹å¼å½±å“äº†æ•ˆç‡ä¸å¹³ç­‰å‘¢ï¼Ÿ æŠ€æœ¯å‘å±•çš„é—®é¢˜ï¼šæŠ€æœ¯å‘å±•å¯¹ç¤¾ä¼šå½¢æ€ä¹Ÿäº§ç”Ÿäº†å·¨å¤§å½±å“ï¼Œæ¯”å¦‚ä¸Šä¸ªä¸–çºªç™½é¢†é˜¶å±‚çš„å‡ºç°ã€‚å¦‚ä»Šä¿¡æ¯äº§ä¸šçš„å‘å±•ä¼¼ä¹å¤§æœ‰å–ä»£å¤§éƒ¨åˆ†å·¥ä½œä¹‹åŠ¿ï¼Œæˆ–è®¸çœŸå°†åˆ¶é€ ä¸€ä¸ªåºå¤§çš„å¤±ä¸šè€…ç¾¤ä½“ã€‚æ‰€ä»¥ï¼ŒæŠ€æœ¯å‘å±•åˆ°åº•ä¼šç»™ç¤¾ä¼šå¸¦æ¥ä»€ä¹ˆï¼Ÿå¦‚æœæŠ€æœ¯å‘å±•åè€Œç ´åäº†ç¤¾ä¼šï¼ˆå°±å¦‚åŒ19ä¸–çºªè®¸å¤šå·¥äººçš„ç”Ÿæ´»æ°´å¹³ç”šè‡³ä¸å¦‚å†œæ°‘ï¼‰ï¼Œæˆ‘ä»¬æœ‰åŠæ³•æ”¹å˜å—ï¼Ÿ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:1:0","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"ä»€ä¹ˆæ˜¯ç¤¾ä¼šå­¦ ç¤¾ä¼šå­¦äº§ç”Ÿçš„èƒŒæ™¯ï¼š 1789 å¹´æ³•å›½å¤§é©å‘½ï¼Œäººç±»å†å²ä¸Šé¦–æ¬¡å‡ºç°ç”±çº¯ç²¹äººé—´ç†æƒ³æ‰€æŒ‡å¼•çš„è¿åŠ¨â€”â€”è‡ªç”±å’Œå¹³ç­‰ 18,19 ä¸–çºªå‘æºäºè‹±å›½çš„å·¥ä¸šé©å‘½ï¼Œå¸¦æ¥äº†åŸå¸‚åŒ–ï¼Œå·¥ä¸šåŒ–ï¼Œäººå£å¤§å¢é•¿ï¼Œæ·±åˆ»åœ°æ”¹å˜äº†ç¤¾ä¼š åœ¨æ¬§æ´²ï¼Œè¿™ä¸¤åœºå¤§é©å‘½å¸¦æ¥ä¸€äº›åˆ—ç¤¾ä¼šå˜è¿ï¼Œå½“äººä»¬è¯•å›¾ç†è§£è¿™äº›å˜è¿çš„æ¡ä»¶åŠå…¶å¯èƒ½çš„ç»“æœæ—¶ï¼Œç¤¾ä¼šå­¦è¯ç”Ÿäº†ã€‚ä½†åŒæ—¶ï¼Œç¤¾ä¼šå­¦å½¢æˆçš„æ€æƒ³èƒŒæ™¯ä¹Ÿä¿ƒè¿›äº†ä¸¤æ¬¡å¤§é©å‘½ã€‚ ä»€ä¹ˆæ˜¯ç¤¾ä¼šå­¦ï¼š ç¤¾ä¼šå­¦ç ”ç©¶çš„æ˜¯äººç±»ç¤¾ä¼š ä¸€ä¸ªç¤¾ä¼šå°±æ˜¯ä¸€å¥—åˆ¶åº¦åŒ–(institutionalised)è¡Œä¸ºæ¨¡å¼çš„é›†ç»“(cluster)æˆ–ä½“ç³» ç¤¾ä¼šå­¦å’Œå…¶ä»–ç¤¾ä¼šç§‘å­¦ï¼Œå¦‚äººç±»å­¦ï¼Œç»æµå­¦éƒ½æŠŠç¤¾ä¼šä½œä¸ºå…±åŒçš„ç ”ç©¶å¯¹è±¡ï¼Œä½†ç¤¾ä¼šå­¦çš„æ˜¾è‘—ç‰¹å¾åœ¨äºå®ƒé›†ä¸­å…³æ³¨â€œä¸¤æ¬¡å¤§é©å‘½â€ä»¥æ¥æ‰€å‡ºç°çš„å„ç§ç¤¾ä¼šå½¢å¼ã€‚ æœ€ç»ˆå®šä¹‰ï¼šç¤¾ä¼šå­¦æ˜¯ä¸€é—¨ç¤¾ä¼šç§‘å­¦ï¼Œå®ƒé‡ç‚¹ç ”ç©¶çš„æ˜¯è¿‡å»ä¸¤ä¸‰ä¸ªä¸–çºªå·¥ä¸šè½¬å‹æ‰€å½¢æˆçš„ç¤¾ä¼šåˆ¶åº¦ æ³¨æ„ï¼šç¤¾ä¼šå­¦å’Œå…¶ä»–ç¤¾ä¼šç§‘å­¦é—´ä¸å­˜åœ¨æ˜ç¡®åˆ†é‡ï¼Œè€Œä¸”è¿™ç§åˆ†é‡ä¹Ÿæ²¡æœ‰å­˜åœ¨çš„å¿…è¦ ç¤¾ä¼šå­¦ä¸è‡ªç„¶ç§‘å­¦çš„ä¸åŒï¼š åœ¨ä¸€å¼€å§‹ï¼Œè®¸å¤šç¤¾ä¼šå­¦å®¶è®¤ä¸ºï¼Œç ”ç©¶ç¤¾ä¼šå°±åº”è¯¥åƒç ”ç©¶è‡ªç„¶ç§‘å­¦ä¸€æ · å¥¥å¤æ–¯ç‰¹Â·å­”å¾·(Auguste Comte)ï¼š é¢„æµ‹å°±æ˜¯ä¸ºäº†æ§åˆ¶(PrÃ©voir pour pouvoir) æ¶‚å°”å¹²ä¸»å¼ ï¼Œç¤¾ä¼šç°è±¡åº”å½“ä½œä¸ºäº‹ç‰©(things)æ¥å¤„ç†ï¼šæˆ‘ä»¬åº”å½“æŠŠæˆ‘ä»¬è‡ªèº«çœ‹ä½œæ˜¯è‡ªç„¶ä¸–ç•Œä¸­çš„å®¢ä½“ã€‚ä»–ä»è€Œé‡ç”³äº†ç¤¾ä¼šå­¦ä¸è‡ªç„¶ç§‘å­¦ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚ ä½†æ˜¯å‰ç™»æ–¯è®¤ä¸ºç¤¾ä¼šå­¦çš„ç ”ç©¶æ–¹æ³•ä»ç„¶å’Œè‡ªç„¶ç§‘å­¦æœ‰åŒºåˆ« æˆ‘ä»¬æ— æ³•åƒäº†è§£è‡ªç„¶ä¸–ç•Œä¸­çš„å®¢ä½“æˆ–äº‹ç‰©é‚£æ ·æ¥äº†è§£ç¤¾ä¼šæˆ–â€œç¤¾ä¼šäº‹å®â€ï¼Œå› ä¸ºç¤¾ä¼šä»…ä»…å­˜åœ¨äºäººç±»è‡ªèº«çš„åˆ›é€ å’Œå†åˆ›é€ è¡Œä¸ºä¸­ã€‚ æˆ‘ä»¬åˆ›é€ ç¤¾ä¼šçš„åŒæ—¶ï¼Œç¤¾ä¼šä¹Ÿåˆ›é€ äº†æˆ‘ä»¬ ç¤¾ä¼šå­¦çš„å®è·µæ„æ¶µä¹Ÿä¸èƒ½ç›´æ¥ç­‰åŒäºç§‘å­¦çš„æŠ€æœ¯ç”¨é€”ã€‚ ä½œä¸ºäººç±»ï¼Œæˆ‘ä»¬ä¸ä»…ä»…ç”Ÿæ´»åœ¨å†å²ä¹‹ä¸­ï¼Œæˆ‘ä»¬å¯¹å†å²çš„ç†è§£æœ¬èº«æ„æˆäº†å†å²åŠå…¶æœªæ¥é¢è²Œçš„å†…åœ¨ç»„æˆéƒ¨åˆ†ã€‚ ç¤¾ä¼šå­¦çš„æƒ³è±¡åŠ›ï¼š ç¤¾ä¼šå­¦çš„å®è·µéœ€è¦å”¤èµ·C.èµ–ç‰¹Â·ç±³å°”æ–¯æ‰€è°“çš„â€œç¤¾ä¼šå­¦çš„æƒ³è±¡åŠ›â€ å†å²çš„æƒ³è±¡åŠ›ï¼šèƒ½å¤Ÿæ„è¯†åˆ°ä¼ ç»Ÿç¤¾ä¼šå’Œç°ä»£ç¤¾ä¼šçš„åŒºåˆ« äººç±»å­¦çš„æƒ³è±¡åŠ›ï¼šèƒ½å¤Ÿæ„è¯†åˆ°åŸå§‹ç¤¾ä¼šå’Œå·¥ä¸šç¤¾ä¼šçš„åŒºåˆ« æ‰¹åˆ¤çš„æƒ³è±¡åŠ›ï¼šèƒ½å¤Ÿæƒ³è±¡æœªæ¥çš„å„ç§å¯èƒ½æ€§ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:2:0","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"èµ„æœ¬ä¸»ä¹‰å’Œå·¥ä¸šç¤¾ä¼š ä¸ºäº†è§£é‡Šâ€œä¸¤æ¬¡å¤§é©å‘½â€å¯¹ä¸–ç•Œå·¥ä¸šåŒ–åœ°åŒºçš„å‘å±•æ‰€é€ æˆçš„å½±å“ï¼Œå†å²ä¸Šæœ‰ä¸¤å¤©ä¸»çº¿ï¼šå·¥ä¸šç¤¾ä¼šå’Œèµ„æœ¬ä¸»ä¹‰ã€‚è¿™ä¸¤ä¸ªæœ¯è¯­å¹¶ä¸æ˜¯å•çº¯çš„æ ‡ç­¾ï¼Œè€Œæ˜¯ä»£è¡¨äº†ç¤¾ä¼šæ€æƒ³å®¶åœ¨ç†è§£ç°ä»£ä¸–ç•Œå˜è¿çš„æœ¬è´¨æ—¶å½¢æˆçš„ä¸¤ç§å¯¹ç«‹é€”å¾„ã€‚ â€œå·¥ä¸šç¤¾ä¼šâ€æœ¯è¯­æ˜¯19ä¸–çºªåˆæœŸç”±åœ£è¥¿é—¨(Comte Henri de Saint-Simon)åœ¨å…¶ä½œå“ä¸­æå‡ºçš„ï¼Œä»–åŒæ—¶è¿˜æå‡ºäº†ä¸€äº›åæ¥è¢«å…¶ä»–ç ”ç©¶è€…æ‰€é‡‡ç”¨çš„æ™®éæ€§ç†è®ºå‡†åˆ™ã€‚è¿™æ¡ä¸»çº¿å†…éƒ¨å·®å¼‚ä¹Ÿå·¨å¤§ã€‚ èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šçš„è§‚ç‚¹é¦–å…ˆæ˜¯ä¸å¡å°”Â·é©¬å…‹æ€è”ç³»åœ¨ä¸€èµ·çš„ï¼Œå°½ç®¡é©¬å…‹æ€çš„ä¸»è¦è§‚ç‚¹ä¹Ÿå‡ºè‡ªæ­¤å‰ç¤¾ä¼šç†è®ºã€å“²å­¦å’Œç»æµå­¦å„ç§æ€æƒ³æµæ´¾ã€‚ ä¸‹é¢ä»¥å…¸å‹çš„å·¥ä¸šç¤¾ä¼šå’Œèµ„æœ¬ä¸»ä¹‰ç†è®ºä¸ºä¾‹ï¼Œæ¯”è¾ƒä¸¤è€…ä¸åŒï¼š å·¥ä¸šç¤¾ä¼šç†è®º ä¸»è¦è§‚ç‚¹ å½“ä»£ä¸–ç•Œæœ€é‡å¤§çš„å˜è¿åœ¨äºä»ä¸»è¦ä»¥å†œä¸šä¸ºåŸºç¡€çš„â€œä¼ ç»Ÿç¤¾ä¼šâ€å‘ä»¥æœºæ¢°åŒ–ç”Ÿäº§å’Œå•†å“äº¤æ¢ä¸ºåŸºç¡€çš„â€œå·¥ä¸šç¤¾ä¼šâ€è¿‡æ¸¡ã€‚ ä»ä¼ ç»Ÿç¤¾ä¼šå‘å·¥ä¸šç¤¾ä¼šè¿‡æ¸¡ä»£è¡¨äº†å†å²ä¸Šçš„è¿›æ­¥è¿åŠ¨ã€‚ å¯¹äº19ä¸–çºªå’Œ20ä¸–çºªæ—©æœŸå‘ç”Ÿåœ¨è¥¿æ¬§çš„é˜¶çº§å†²çªï¼Œå·¥ä¸šç¤¾ä¼šç†è®ºè®¤ä¸ºï¼Œè¿™æ˜¯ä»ä¼ ç»Ÿå†œä¸šç§©åºå‘å·¥ä¸šç¤¾ä¼šè½¬å˜è¿‡ç¨‹ä¸­å½¢æˆçš„å¼ åŠ›çš„ç»“æœã€‚ ä½†æ˜¯ï¼Œéšç€å½¼æ­¤èƒ½å¤Ÿæ¥å—çš„å·¥ä¸šè°ˆåˆ¤æ¨¡å¼å¾—åˆ°å»ºç«‹ï¼Œä»¥åŠâ€œæ”¿æ²»å…¬æ°‘èº«ä»½æƒåˆ©â€â€”â€”æŠ•ç¥¨å’Œç»„å»ºæ”¿å…šçš„æƒåˆ©â€”â€”æ‰©å±•åˆ°å¤§å¤šæ•°äººå£ï¼Œè¿™äº›ç´§å¼ å…³ç³»å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«åŒ–è§£äº† ä»ä¼ ç»Ÿå‘ç°ä»£è¿‡æ¸¡çš„ä¸€ä¸ªåŸºæœ¬ç¯èŠ‚å°±æ˜¯è‡ªç”±æ°‘ä¸»å›½å®¶çš„å…´èµ·ã€‚è‡ªç”±æ°‘ä¸»åˆ¶åº¦æ˜¯ä¸€ç§å¸¸è§äºè¥¿æ¬§å’Œç¾å›½çš„æ”¿æ²»åˆ¶åº¦ï¼Œç››è¡Œè®®ä¼šåˆ¶æ”¿åºœï¼Œç”±ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šæ”¿å…šé€šè¿‡é€‰ä¸¾çš„æ–¹å¼è·å–è®®å¸­ã€‚ å·¥ä¸šç¤¾ä¼šç†è®ºçš„æ”¯æŒè€…å‡å®šæˆ–è®¤ä¸ºï¼Œå·¥ä¸šç§©åºä¸€æ—¦å‡ºç°ï¼Œå°±å­˜åœ¨å…¶åŸºæœ¬çš„ä¸€è‡´æ€§ã€‚è¿™ç§è§‚ç‚¹æœ‰æ—¶å¾—åˆ°äº†æœ€ä¸ºç›´ç‡çš„è¡¨è¾¾ï¼Œå…¶ä¸­æœ€è‘—åçš„è¦æ•°å…‹å°”(Kerr)å’Œä»–çš„åŒäº‹ã€‚å½“ç„¶ï¼Œå®ƒä¹Ÿé­åˆ°äº†å¦‚æœ¬è¿ªå…‹æ–¯(Bendix)è¿™ä¸€ç±»äººçš„å¼ºçƒˆæ‰¹åˆ¤ï¼Œä»–ä»¬å¼ºè°ƒï¼Œåœ¨å½“ä»£ç¤¾ä¼šï¼Œä¼ ç»Ÿä¸ç°ä»£çš„èåˆå­˜åœ¨ç€å„ç§ä¸åŒçš„æ–¹å¼ã€‚ ç°ä»£åŒ–ç†è®ºçš„æ ¸å¿ƒè®ºç‚¹åœ¨äºï¼Œâ€œä¸å‘è¾¾ç¤¾ä¼šâ€æ·±é™·äºä¼ ç»Ÿåˆ¶åº¦ä¹‹ä¸­ï¼Œå¦‚æœå®ƒä»¬æƒ³è¦è·å¾—è¥¿æ–¹ç¤¾ä¼šçš„ç»æµç¹è£çš„è¯ï¼Œå®ƒä»¬å°±å¿…é¡»ä»ä¼ ç»Ÿåˆ¶åº¦ä¸­è§£æ”¾å‡ºæ¥ã€‚ä»ä¸–ç•Œä¸Šæœªå®ç°å·¥ä¸šåŒ–çš„ç¤¾ä¼šè€Œè¨€ï¼Œå·¥ä¸šç¤¾ä¼šçš„è§‚å¿µé€šå¸¸ä¸æ‰€è°“çš„â€œç°ä»£åŒ–ç†è®ºâ€å¯†åˆ‡ç›¸å…³ã€‚ ä¸€ä¸ªä»£è¡¨äººç‰© è¾¾ä¼¦å¤šå¤« çš„è®ºè¿°ï¼ˆå¦‚ä½•çœ‹å¾…åé©¬å…‹æ€æ—¶ä»£ï¼‰ èµ„æœ¬ä¸»ä¹‰å·²ç»è¿‡æ—¶ï¼Œç°åœ¨æ˜¯å·¥ä¸šåŒ–æ—¶ä»£ è¾¾ä¼¦å¤šå¤«æ‰€ä½¿ç”¨çš„â€œå·¥ä¸šåŒ–â€æ¦‚å¿µè¡¨ç¤ºçš„æ˜¯å·¥å‚æˆ–ä¼ä¸šä¸­å•†å“ç”Ÿäº§æœºæ¢°åŒ–çš„æ¶µä¹‰ï¼Œè€Œå·¥ä¸šç¤¾ä¼šåˆ™è¡¨ç¤ºåœ¨è¯¥ç¤¾ä¼šä¸­ï¼Œå·¥ä¸šä¸»ä¹‰å·²æˆä¸ºç»æµç»„ç»‡çš„ä¸»è¦å½¢å¼ã€‚ è¾¾ä¼¦å¤šå¤«æ¯«ä¸è¿Ÿç–‘åœ°å‘Šè¯‰æˆ‘ä»¬ï¼Œå·¥ä¸šåŒ–æ˜¯å½±å“å½“ä»£ç¤¾ä¼šå‘å±•çš„ä¸»è¦ç°è±¡ã€‚ä»–è¯´é“ï¼Œèµ„æœ¬ä¸»ä¹‰ä»…ä»…æ˜¯å·¥ä¸šç¤¾ä¼šçš„ä¸€ç§ç»„ç»‡å½¢å¼â€”â€”ä¸€ç§ä»…ä»…å±€é™äº19ä¸–çºªå’Œ20ä¸–çºªæ—©æœŸçš„è¥¿æ¬§ç¤¾ä¼šçš„è¿‡æ¸¡å½¢å¼ å› ä¸ºæ‰€æœ‰æƒå’Œç®¡ç†æƒï¼Œæ‰€ä»¥å·²ç»æ²¡æœ‰èµ„æœ¬å®¶ ä½†æ˜¯ï¼Œè¿™ç§æ‰€æœ‰æƒä¸ç®¡ç†æƒé‡å åœ¨ä¸€èµ·çš„ç°è±¡ä»…ä»…æ˜¯ä¸€ç§çŸ­æš‚çš„ç°è±¡ã€‚è‡ªé©¬å…‹æ€æ—¶ä»£ä»¥æ¥ï¼Œéšç€å·¥ä¸šè§„æ¨¡çš„ä¸æ–­æ‰©å¤§ï¼Œèµ„æœ¬æ‰€æœ‰æƒä¸å†èµ‹äºˆå¯¹ä¼ä¸šæƒå¨ä½“ç³»çš„æ§åˆ¶æƒäº†ã€‚ èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šä¸è¿‡æ˜¯å·¥ä¸šç¤¾ä¼šçš„ä¸€ç§æ¬¡è¦å½¢å¼ï¼Œä¸è¿‡æ˜¯å·¥ä¸šç¤¾ä¼šå‘å±•çš„ä¸€ä¸ªé˜¶æ®µã€‚ ç¤¾ä¼šæµåŠ¨æ€§çš„å¢é•¿å¯ä»¥å¸¦æ¥æœºä¼šå¹³ç­‰çš„æ‰©å¤§ã€‚ ä¸ªä½“åœ¨æ•™è‚²ä½“ç³»çš„æˆåŠŸæˆ–å¤±è´¥å°†æˆä¸ºå½±å“å…¶ç¤¾ä¼šåœ°ä½çš„ä¸»è¦å› ç´ ã€‚æ•™è‚²ä½¿ç¤¾ä¼šæµåŠ¨æ›´è¶‹è‡ªç”±ï¼Œè€Œè¿™ä¸€è¶‹åŠ¿åˆæˆä¸ºå·¥ä¸šç¤¾ä¼šç¨³å®šæˆé•¿çš„å…³é”®ã€‚ äººä»¬çš„åœ°ä½å°†æ›´å¤šå–å†³äºæ¶‚å°”å¹²çš„â€œå†…åœ¨ä¸å¹³ç­‰â€ï¼Œè€Œéâ€œå¤–åœ¨ä¸å¹³ç­‰â€ ä¸ªäººå°†æ‰¾åˆ°ä¸å…¶æ™ºæ…§ç›¸å½“çš„ç¤¾ä¼šåœ°ä½ï¼Œè€Œè¿™åˆä¾èµ–äºä¸€ä¸ªå–„æ„å›½å®¶çš„å¼•å¯¼ã€‚ å–„æ„å›½å®¶èƒ½è°ƒèŠ‚ä¸åŒé˜¶çº§å†²çª è‡ªç”±æ°‘ä¸»å›½å®¶çš„å‡ºç°ï¼Œå„ç§å·¥ä¸šä»²è£å½¢å¼çš„å»ºç«‹ï¼ŒåŒ…æ‹¬æ³•å¾‹ä¸Šå¯¹ç½¢å·¥æƒåˆ©çš„æ­£å¼æ‰¿è®¤ï¼Œä½¿å·¥ä¸šé¢†åŸŸçš„å†²çªå¾—åˆ°äº†è°ƒèŠ‚å’Œæ§åˆ¶ã€‚å‰è€…ä½¿æ”¿æ²»é¢†åŸŸä¸­ä»£è¡¨å„ç§ä¸åŒé˜¶çº§åˆ©ç›Šçš„æ”¿å…šçš„æ­£å¼ç»„å»ºæˆä¸ºå¯èƒ½ï¼Œåè€…åˆ™ä½¿å·¥ä¸šé¢†åŸŸä¸­çš„ä¸åŒåˆ©ç›Šå¾—åˆ°äº†ç±»ä¼¼çš„æ‰¿è®¤ã€‚ èµ„æœ¬ä¸»ä¹‰ç†è®º ä¸»è¦è§‚ç‚¹ ç»æµæ´»åŠ¨å½¢å¼çš„èµ„æœ¬ä¸»ä¹‰ èµ„æœ¬ä¸»ä¹‰çš„ä¸¤ä¸ªåŸºæœ¬ç»“æ„ï¼šèµ„æœ¬ å’Œ é›‡ä½£åŠ³åŠ¨åŠ› å‡å®šä½œä¸ºç»æµæ´»åŠ¨å½¢å¼çš„èµ„æœ¬ä¸»ä¹‰åœ¨å·¥ä¸šé©å‘½ä»¥å‰å°±å·²ç»å‡ºç°ï¼Œå¹¶ä¸”ä¸ºå·¥ä¸šåŒ–çš„å¯åŠ¨æä¾›äº†åˆºæ¿€å› ç´ ã€‚ å·¥ä¸šåŒ–çš„è¿‡ç¨‹â€”â€”åŠ é€Ÿäº†å†œæ‘åŠ³åŠ¨åŠ›å‘ä»¥åŸå¸‚ä¸ºåŸºç¡€çš„å·¥ä¸šåŠ³åŠ¨é˜¶çº§çš„è½¬æ¢ã€‚ èµ„æœ¬ä¸»ä¹‰æ˜¯ä¸€ç§æ°¸ä¸ä¼‘æ­¢ã€ä¸æ–­æ‰©å¼ çš„ä½“ç³»ï¼Œèµ„æœ¬ä¸»ä¹‰ç”Ÿäº§è¶Šæ¥è¶Šå¤„äºæ”¯é…åœ°ä½ï¼Œå¹¶æ¨åŠ¨äº†ä¸å·¥ä¸šé©å‘½è”ç³»åœ¨ä¸€èµ·çš„æŠ€æœ¯é©æ–°ã€‚ æ”¿æ²»åˆ¶åº¦çš„èµ„æœ¬ä¸»ä¹‰ é©¬å…‹æ€æŠŠèµ„æœ¬ä¸»ä¹‰çœ‹ä½œæ˜¯ä¸€ç§ç»æµæ´»åŠ¨å½¢å¼ï¼ŒåŒæ—¶ï¼Œç”±äºä»–ç›¸ä¿¡ï¼Œå…¶ä»–åˆ¶åº¦ä¸è¿™ç§ç»æµæ´»åŠ¨å½¢å¼æ˜¯ç´§å¯†è”ç³»åœ¨ä¸€èµ·çš„ï¼Œå› æ­¤ï¼Œä»–ä¹ŸæŠŠèµ„æœ¬ä¸»ä¹‰çœ‹ä½œæ˜¯ä¸€ç§ç¤¾ä¼šç±»å‹ã€‚ åœ¨é©¬å…‹æ€ç†è®ºä¸­ï¼Œé˜¶çº§å…³ç³»ç›´æ¥æŠŠèµ„æœ¬ä¸»ä¹‰ç»æµç»„ç»‡ä¸èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šçš„å…¶ä»–åˆ¶åº¦è¿æ¥åœ¨ä¸€èµ·ã€‚ 1789å¹´æ³•å›½å¤§é©å‘½ï¼Œæ ‡å¿—ç€èµ„äº§é˜¶çº§æ”¿æ²»æƒåŠ›çš„å…´èµ·ã€‚ èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é˜¶çº§ç¤¾ä¼šï¼Œå½¢æˆè¿™ç§ç¤¾ä¼šçš„å„ç§é˜¶çº§å…³ç³»æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å†²çªæˆ–æ–—äº‰çš„å…³ç³» èµ„æœ¬å®¶å’Œå·¥äººä¹‹é—´çš„ä¾èµ–æ˜¯ä¸€ç§ä¸å¹³è¡¡å…³ç³»ï¼šå·¥äººå¾ˆå°‘èƒ½å¤Ÿæ§åˆ¶ä»–ä»¬æ‰€ä»äº‹çš„å·¥ä½œï¼Œè€Œé›‡ä¸»å´èƒ½å¤Ÿä¾ç…§è‡ªå·±çš„ç›®çš„è·å–åˆ©æ¶¦ã€‚ é˜¶çº§å†²çªå¹¶ä¸ä¼šä»…ä»…å±€é™åœ¨èµ„æœ¬ä¸»ä¹‰å‘å±•çš„æ—©æœŸé˜¶æ®µï¼Œå®ƒå°†éšç€æ—¶é—´çš„å»¶ç»­è€Œå˜å¾—è¶Šæ¥è¶Šå°–é”ã€‚ å›½å®¶æ˜¯é˜¶çº§æƒåŠ›çš„è¡¨ç°å½¢å¼ é©¬å…‹æ€çš„æ—¶ä»£ï¼Œå¤§éƒ¨åˆ†äººéƒ½æ²¡æœ‰æŠ•ç¥¨æƒåŠ›ï¼ˆå› ä¸ºè´¢äº§é™åˆ¶ï¼‰ åŠ³åŠ¨è€…æ”¿å…šçš„ç»„å»ºå—åˆ°æ³•å¾‹é™åˆ¶æˆ–ç¦æ­¢ å›½å®¶æ›´æ³¨é‡äºç»´æŠ¤èµ„æœ¬ä¸»ä¹‰åŠ³åŠ¨å¥‘çº¦ ä¸€ä¸ªä»£è¡¨äººç‰© æ‹‰å°”å¤«Â·å¯†é‡Œæœ¬å¾·(Ralph Miliband) çš„è®ºè¿°ï¼ˆå¦‚ä½•çœ‹å¾…åé©¬å…‹æ€æ—¶ä»£ï¼‰ èµ„æœ¬ä¸»ä¹‰ä»ç„¶å­˜åœ¨ åœ¨å¯†é‡Œæœ¬å¾·çœ‹æ¥ï¼Œå°½ç®¡å­˜åœ¨ç€å¤§å‹ä¼ä¸šä¸æ–­æˆé•¿å’Œå›½å®¶ä¸æ–­æŸ“æŒ‡ç»æµé¢†åŸŸçš„ç°è±¡ï¼Œèµ„æœ¬çš„ç§äººæ‰€æœ‰æƒä»ç„¶æ˜¯å½“ä»£è¥¿æ–¹ç¤¾ä¼šçš„é¦–è¦ç‰¹å¾ã€‚ ï¼ˆèµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šï¼‰æœ‰ä¸¤ä¸ªé‡è¦çš„ç‰¹å¾ï¼šä¸€æ˜¯å®ƒä»¬éƒ½æ˜¯é«˜åº¦å·¥ä¸šåŒ–çš„ç¤¾ä¼šï¼ŒäºŒæ˜¯å…¶ç»æµæ´»åŠ¨çš„å¤§éƒ¨åˆ†å·¥å…·éƒ½ä¸ºç§äººæ‰€å æœ‰å’Œæ”¯é…ã€‚ æ‰€æœ‰æƒå’Œç®¡ç†æƒåˆ†ç¦»å¹¶æ²¡æœ‰å¯¼è‡´èµ„æœ¬ä¸»ä¹‰è§£ä½“ é¦–å…ˆï¼Œè¿™ç§åˆ†ç¦»å°†ä¸ä¼šäº§ç”Ÿé€šå¸¸æ‰€è¯´çš„è¿›æ­¥æ„ä¹‰ï¼Œå°‘æ•°è‚¡ç¥¨æŒæœ‰è€…ä¾ç„¶èƒ½å¤Ÿæ§åˆ¶ä¸€ä¸ªå¤§ä¼ä¸šï¼Œåªè¦å®ƒçš„å…¶ä»–è‚¡ä»½æ˜¯é«˜åº¦åˆ†æ•£çš„ã€‚ æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œèµ„æœ¬æ‰€æœ‰è€…å’Œç»ç†åœ¨ç»´æŒèµ„æœ¬ä¸»ä¹‰çš„ç”Ÿäº§æ¡†æ¶æ–¹é¢æœ‰ç€ç›¸åŒçš„ç»æµåˆ©ç›Šï¼Œä»–ä»¬éƒ½æ¥è‡ªç›¸åŒçš„ç‰¹æƒèƒŒæ™¯ï¼Œä»è€Œå½¢æˆäº†ä¸€ä¸ªç›¸å¯¹ç»Ÿä¸€çš„æ”¯é…é˜¶çº§ã€‚ ç¤¾ä¼šæµåŠ¨æ€§å®é™…ä¸Šå¹¶æ²¡æœ‰é‚£ä¹ˆå¤§ å¯†é‡Œæœ¬å¾·è®¤ä¸ºï¼Œå¤§éƒ¨åˆ†æµåŠ¨éƒ½æ˜¯â€œå°å¹…åº¦çš„â€(short-range)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯é˜¶çº§ä½“ç³»ä¸­æ¯—é‚»åœ°ä½ä¹‹é—´çš„æµåŠ¨ï¼Œå¾ˆå°‘å­˜åœ¨â€œå¤§å¹…åº¦â€çš„æµåŠ¨ï¼Œä½¿æ¥è‡ªå·¥äººé˜¶çº§èƒŒæ™¯çš„äººèƒ½å¤Ÿä¸Šå‡åˆ°ç²¾è‹±ç¾¤ä½“ã€‚ å³ä½¿æŠŠä¸€ç§è¾ƒå…·â€˜ç²¾è‹±â€™(meritocratic)æ–¹å¼çš„å‡è¿è·¯å¾„å«æ¥åˆ°ç°å­˜çš„ç»æµä½“ç³»ä¸­å»ï¼Œä¹Ÿåªèƒ½ä¿è¯è®¸å¤šå·¥äººé˜¶çº§å‡ºèº«çš„äººèƒ½å¤Ÿä¸Šå‡åˆ°ç°å­˜é˜¶çº§ä½“ç³»çš„ä¸Šå±‚ã€‚è¿™ç§ç»“æœæˆ–è®¸æ˜¯æ€¡äººå¿ƒæ„çš„ï¼Œä½†å®ƒä¸ä¼šæŠŠç°å­˜çš„é˜¶çº§ä½“ç³»å˜æˆå¦ä¸€ç§ä¸åŒçš„ä½“ç³»ã€‚â€ é˜¶çº§æ–—äº‰ä¾ç„¶æ˜¯æ ¸å¿ƒ æ™®éå…¬æ°‘æƒå’Œå·¥ä¸šä»²è£ç¨‹åºï¼Œä½†åœ¨å¯†é‡Œæœ¬å¾·çœ‹æ¥ï¼Œå®ƒä»¬åªæœ‰åœ¨é˜¶çº§æ–—äº‰ä¸­ï¼Œè€Œä¸”ä¹Ÿåªæœ‰é€šè¿‡é˜¶çº§æ–—äº‰æ‰èƒ½å®ç°ï¼Œå¹¶ä¸”å®ƒä»¬ä»ç„¶æ˜¯é˜¶çº§æ–—äº‰çš„æ ¸å¿ƒã€‚ï¼ˆå¹¶éå–„æ„å›½å®¶èµäºˆçš„ï¼‰ è‹è”æ¨¡å¼ï¼šå®ƒè‡³å¤šæ˜¯ä¸€ç§æ®‹ç¼ºçš„æˆ–æ‰­æ›²çš„ç¤¾ä¼šä¸»ä¹‰é¢è²Œã€‚ èµ„æœ¬ä¸»ä¹‰å›½å®¶çš„ç¤¾ä¼šä¸»ä¹‰æ”¿å…šå·©å›ºï¼Œè€Œä¸æ˜¯ç“¦è§£äº†ç°å­˜ç§©åº ä¸ºäº†èµ¢å¾—é€‰ä¸¾çš„å¹¿æ³›èƒœåˆ©ï¼Œå®ƒä»¬é€šå¸¸å¿…é¡»æ·¡åŒ–å…¶ç¤¾ä¼šå˜é©çš„æ–¹æ¡ˆã€‚ä¸€æ—¦ä¸Šå°æ‰§æ”¿ï¼Œå®ƒä»¬çš„å®é™…æ”¿ç­–ä¹Ÿä¸ä¼šåƒé€‰ä¸¾è¿åŠ¨æ—¶æ‰€æ ‡æ¦œçš„é‚£ä¹ˆæ¿€è¿›ï¼Œå› ä¸ºæ—¢å¾—åˆ©ç›Šé˜¶å±‚å‡ºäºå…¶æ—¢æœ‰çš„åœ°ä½å’Œç‰¹æƒæ‰€å—åˆ°çš„å¨èƒï¼Œå°†ä¼šæå‡ºå¼ºçƒˆçš„æŠ—è®®ã€‚ â€œè®®ä¼šåˆ¶ç¤¾ä¼šä¸»ä¹‰â€(parliamentary socialism)æœ¬èº«ä¸å¯èƒ½å¥æ•ˆï¼Œåªæœ‰å€ŸåŠ©äºè®®ä¼šä¹‹å¤–çš„é¢å¤–è¿åŠ¨ï¼Œå½»åº•çš„ç¤¾ä¼šå˜é©æ‰æœ‰å¯èƒ½å®ç°ã€‚ ä»–è®¤ä¸ºï¼Œç”±äºå—æµè¡Œæ„è¯†å½¢æ€çš„å½±å“ï¼Œè¥¿æ–¹ç¤¾ä¼šä¸»ä¹‰æ”¿å…šå‡ºç°äº†å¹¿æ³›çš„æ”¹è‰¯ä¸»ä¹‰å€¾å‘ã€‚ æ§åˆ¶äº†ç”Ÿäº§å·¥å…·å’Œæ”¿æ²»æœºå™¨çš„é˜¶çº§åŒæ—¶ä¹Ÿå°±æ§åˆ¶äº†è¿™ä¸ªç¤¾ä¼šçš„ä¿¡ä»°å’Œè±¡å¾ã€‚åœ¨èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šï¼Œå­˜åœ¨ç€å¯†é‡Œæœ¬å¾·æ‰€è°“çš„â€œåŒæ„å·¥ç¨‹å­¦â€(engineering of consent)ï¼Œå®ƒå¯ä»¥åœ¨äººå£ä¸­åŸ¹è‚²èµ·å¯¹ç°çŠ¶çš„é¡ºä»æ€åº¦ã€‚ åœ¨è¾¾ä¼¦å¤šå¤«çœ‹æ¥ï¼Œæ•™è‚²æ˜¯é€šå¾€å¹³ç­‰çš„ä¸»è¦è½¦è½®ï¼Œå®ƒä¿ƒè¿›äº†æµåŠ¨æ€§å’Œâ€œç²¾è‹±å¼â€ç¤¾ä¼šç§©åºçš„å½¢æˆï¼Œä½†åœ¨å¯†é‡Œæœ¬å¾·çœ¼é‡Œï¼Œæ•™è‚²ä¸»è¦æ˜¯ä¸€ç§é˜»ç¢ç¤¾ä¼šå˜é©çš„ç°è±¡ï¼Œå› ä¸ºæ•™è‚²ä½“ç³»åœ¨æ¯ä¸€ä»£äººé‚£é‡Œéƒ½ä¼šè¢«åå¤ç”¨æ¥åˆ›é€ æœ‰åˆ©äºç»Ÿæ²»é˜¶çº§åˆ©ç›Šçš„æ€»ä½“æ„è¯†å½¢æ€ã€‚ å¯ä»¥æ€»ç»“å‡ºä»–ä»¬çš„å‡ ä¸ªå…³æ³¨ç‚¹ï¼šæœºä¼šå¹³ç­‰å’Œç¤¾ä¼šå’Œè°ï¼Œä»¥åŠé˜¶çº§å†²çªçš„åœ°ä½ æœºä¼šå¹³ç­‰åœ¨äºæ¯ä¸ªäººéƒ½å¾—åˆ°ä¸å…¶æ™ºæ…§ç›¸å½“çš„ç¤¾ä¼šåœ°ä½ï¼ˆé¸è³¢èˆ‡èƒ½ï¼‰ ç¤¾ä¼šå’Œè°åœ¨äºç¤¾ä¼šçš„æ•´ä½“ç»“æ„ä¸å­˜åœ¨è¿‡åˆ†çš„ä¸å¹³ç­‰å’Œå‹è¿«ï¼ˆè¬›ä¿¡ä¿®ç¦ï¼‰ å½“å‰ä¸¤è€…ä¸èƒ½æ»¡è¶³æ—¶ï¼Œå°±ä¼šæœ‰é˜¶çº§å†²çª èµ„æœ¬ä¸»ä¹‰ç†è®ºè§£é‡Šäº†è¿™ä¸¤ç§ä¸å¹³ç­‰çš„æ¥æº æ‹‰ä¼¦å¤šå¤«ï¼Œå¯†é‡Œæœ¬å¾·å¯¹é©¬å…‹æ€19ä¸–çºªèµ„æœ¬ä¸»ä¹‰å·¥ä¸šçš„æè¿°éƒ½èµåŒï¼Œä½†åŒºåˆ«åœ¨äºè¿‘ä¸€ç™¾å¹´è¥¿æ–¹ç¤¾ä¼šçš„å˜è¿ ç°çŠ¶çš„åˆ¤æ–­ä¸åŒ -\u003e éœ€è¦è¯¦å®çš„æ•°æ®æ”¯æŒ è¶‹åŠ¿çš„åˆ¤æ–­ä¸åŒ -\u003e éœ€è¦å®Œå–„çš„ç†è®ºæ”¯æŒ å¤§é“ä¹‹è¡Œä¹Ÿï¼Œå¤©ä¸‹ç‚ºå…¬ã€‚é¸è³¢èˆ‡èƒ½ï¼Œè¬›ä¿¡ä¿®ç¦ï¼Œæ•…äººä¸ç¨è¦ªå…¶è¦ªï¼Œä¸ç¨å­å…¶å­ï¼Œä½¿è€æœ‰æ‰€çµ‚ï¼Œå£¯æœ‰æ‰€ç”¨ï¼Œå¹¼æœ‰æ‰€é•·ï¼ŒçŸœå¯¡å­¤ç¨å»¢ç–¾è€…ï¼Œçš†æœ‰æ‰€é¤Šã€‚ç”·æœ‰åˆ†ï¼Œå¥³æœ‰æ­¸ã€‚è²¨æƒ¡å…¶æ£„æ–¼åœ°ä¹Ÿï¼Œä¸å¿…è—æ–¼å·±ï¼›åŠ›æƒ¡å…¶ä¸å‡ºæ–¼èº«ä¹Ÿï¼Œä¸å¿…ç‚ºå·±ã€‚æ˜¯æ•…è¬€é–‰è€Œä¸èˆˆï¼Œç›œç«Šäº‚è³Šè€Œä¸ä½œï¼Œæ•…å¤–æˆ¶è€Œä¸é–‰ï¼Œæ˜¯è¬‚å¤§åŒã€‚ç¦®è¨˜ ç¦®é‹ å‰ç™»æ–¯çš„æœ€åè¯„ä»·ï¼š åœ¨é€»è¾‘ä¸Šï¼Œå·¥ä¸šç¤¾ä¼šç†è®ºå’Œèµ„æœ¬ä¸»ä¹‰ç†è®ºéƒ½æœªå¿…è¯´å¾—é€šï¼Œåœ¨ç»éªŒä¸Šï¼Œä¸¤è€…ä¹Ÿæœªå¿…å¯è¡Œã€‚æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€ä¸ªå…·æœ‰æ— é™å¯èƒ½æ€§çš„ä¸–ç•Œï¼Œæˆ‘ä»¬æœ‰å…³è¿™ä¸ªä¸–ç•Œçš„çŸ¥è¯†å½¢æˆäº†è¿™äº›å¯èƒ½æ€§ã€‚ ä½†æ˜¯ï¼Œè¯„ä¼°ä¸Šé¢æ‰€å‹¾ç”»çš„è¿™ä¸¤ç§è§‚ç‚¹ä¾ç„¶æ˜¯é‡è¦çš„ï¼Œæˆ‘ä»¬è¦çœ‹çœ‹ä½•è€…æ›´ä¸ºå‡†ç¡®ã€‚å› ä¸ºè¿™å°†å¼ºçƒˆå½±å“æˆ‘ä»¬å¯¹è¿™ä¸ªä¸–ç•Œæœ€æœ‰å¯èƒ½å‡ºç°çš„å‘å±•è¶‹åŠ¿çš„è®¤è¯†ï¼ŒåŒæ—¶è¿˜å¼ºçƒˆå½±å“æˆ‘ä»¬æœ‰å…³ç¤¾ä¼šå˜è¿æ–¹å‘çš„æœ€ç°å®é€‰æ‹©çš„è®¤è¯†ã€‚ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:3:0","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"è‹¥å¹²çš„ç°è±¡è¿›ä¸€æ­¥è®¨è®º ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:4:0","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"é˜¶çº§åˆ†æé—®é¢˜ è‚¡ä»½åˆ¶å¤§å…¬å¸ ç°è±¡ï¼š è¿™é‡Œæ›´é‡è¦çš„æ˜¯è¦å…³æ³¨ä¸æ–­æé«˜çš„ç»æµé›†ä¸­(concentration of the economy)ï¼šå¤§å‹å…¬å¸å¯¹ç»æµç”Ÿæ´»çš„æ”¯é…ã€‚ 20ä¸–çºªåˆä»¥æ¥ï¼Œç¾å›½200ä¸ªæœ€å¤§çš„å…¬å¸ä»¥æ¯å¹´é€’å¢0.5%çš„é€Ÿåº¦æ‰©å¤§äº†å…¶åœ¨æ€»èµ„äº§ä¸­çš„ä»½é¢ã€‚ä»Šå¤©ï¼Œè¿™200ä¸ªæœ€å¤§çš„å…¬å¸å·²ç»æ§åˆ¶äº†æ•´ä¸ªå·¥ä¸šç”Ÿäº§çš„3/5å·¦å³ã€‚ä¸æ­¤ç±»ä¼¼ï¼Œ200ä¸ªæœ€å¤§çš„é‡‘èç»„ç»‡ç°åœ¨ä¹Ÿæ§åˆ¶äº†ç¾å›½å…¨éƒ¨é‡‘èäº¤æ˜“çš„ä¸€åŠä»¥ä¸Šã€‚ åœ¨è¿™äº›å¤§å…¬å¸ä¸­ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯æ‰€è°“çš„å…¬å¼€æ‹›è‚¡å…¬å¸(public corporate)ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œå…¬å¸ç”±è‚¡ç¥¨æ‰€æœ‰è€…æ‰€â€œæ‹¥æœ‰â€ï¼Œå®ƒä»¬å‘è¡Œæ—¢å¯ä»¥ä¹°è¿›ä¹Ÿå¯ä»¥å–å‡ºçš„è‚¡ç¥¨ã€‚ è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š â€œç»ç†ä¸»ä¹‰æ‹¥æŠ¤è€…çš„ç«‹åœºâ€(managerialist position) ä¸å…¨ç››æ—¶æœŸçš„ä¼ä¸šå®¶èµ„æœ¬ä¸»ä¹‰ç›¸æ¯”è¾ƒï¼Œå·¨å‹å…¬å¸å·²ç»â€œæ›´ä¸é‚£ä¹ˆèµ„æœ¬ä¸»ä¹‰â€äº† 19ä¸–çºªæ—¶æœŸçš„èµ„æœ¬ä¸»ä¹‰å…·æœ‰å¼ºçƒˆçš„ç«äº‰æ€§ï¼Œå› æ­¤ï¼Œæ¯ä¸€ä¸ªå…¬å¸éƒ½è‡´åŠ›äºå®ç°åˆ©æ¶¦æœ€å¤§åŒ–çš„ç›®æ ‡ã€‚ä½†æ˜¯ç°åœ¨ï¼Œå·¨å‹å…¬å¸å·²ç»å¤„äºæŸä¸€ç»æµé¢†åŸŸçš„ä¸»å¯¼åœ°ä½ï¼Œå®ƒä»¬èƒ½å¤Ÿæ”¯é…å¸‚åœºï¼Œè€Œä¸è¢«å¸‚åœºæ‰€æ”¯é…ã€‚ å¦å¤–ï¼Œè¿™ç§è§‚ç‚¹è¿˜è¿›ä¸€æ­¥è®¤ä¸ºï¼Œå®ƒä»¬å·²å˜å¾—æ›´å…³æ³¨äºç¨³å®šå’Œé•¿æœŸå¢é•¿äº†ï¼Œè€Œä¸æ˜¯ä¸€æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ è¿™ç§å…¬å¸è¶Šæ¥è¶Šå˜æˆäº†â€œæ»¡è¶³è€…â€(satisficers)ã€‚å®ƒä»¬æ‰€è¿½æ±‚çš„æ˜¯æ€»ä½“åˆ©æ¶¦ç‡çš„ç»´æŒï¼Œè€Œä¸æ˜¯æŠŠåˆ©æ¶¦æœ€å¤§åŒ–çš„ç›®æ ‡ç½®äºä¸€åˆ‡ä¹‹ä¸Šã€‚ å·¨å‹å…¬å¸çš„å½¢å¼æ‹¥æœ‰è€…â€”â€”å³è‚¡ç¥¨æŒæœ‰è€…â€”â€”ç°åœ¨ä¸å†å¯¹å…¬å¸äº‹åŠ¡å½¢æˆå¼ºå¤§çš„æ§åˆ¶äº†ï¼ŒæƒåŠ›å·²ç»è¿‡æ¸¡åˆ°äº†ç»ç†æ‰‹ä¸­ã€‚ æ—¢ç„¶ç»ç†ä¸æ˜¯â€œèµ„æœ¬å®¶â€â€”â€”ä»–ä»¬ä¸æ‹¥æœ‰ä»–ä»¬æ‰€æ§åˆ¶çš„å…¬å¸â€”â€”ä»–ä»¬ä¹Ÿå°±æ›´å…³å¿ƒå…¬å¸å†…éƒ¨è¡Œæ”¿ç®¡ç†çš„ç¨³å®šï¼Œè€Œä¸æ˜¯å®ƒæ‰€è¿½æ±‚çš„åˆ©æ¶¦ã€‚ä¸€äº›æŒç»ç†ä¸»ä¹‰æ‹¥æŠ¤è€…ç«‹åœºçš„ä½œå®¶æä¸ºå¼ºè°ƒè¿™ä¸€ç‚¹ã€‚ä»–ä»¬å®£ç§°ï¼Œå·¨å‹å…¬å¸å·²æˆä¸ºä¸€ç§å…·æœ‰ç¤¾ä¼šè´£ä»»æ„Ÿçš„æœºæ„ï¼Œä¸€ç§å…·æœ‰â€œé«˜å°šæƒ…æ„Ÿçš„å…¬å¸â€(soulful corporation)ï¼Œå®ƒè¿œç¦»äº†19ä¸–çºªé‚£ç§é‡å¿ƒå‹ƒå‹ƒçš„ã€è‡ªç§è‡ªåˆ©çš„å…¬å¸å½¢å¼ã€‚ å…¬å¸è¶Šæ˜¯è¶‹äºé›†ä¸­åŒ–ï¼Œä»¥å‰çš„é˜¶çº§å›¢ç»“(solidarity)å½¢å¼ä¹Ÿå°±è¶Šè¶‹äºç“¦è§£ã€‚ èµ„æœ¬â€œæ‰€æœ‰è€…â€ç°åœ¨å·²æˆä¸ºä¸€ä¸ªå››åˆ†äº”è£‚çš„æ¦‚å¿µï¼Œå› ä¸ºç°åœ¨è‚¡ç¥¨æŒæœ‰è€…å·²å˜å¾—é«˜åº¦åˆ†æ•£äº†ã€‚ åé©³ å®é™…ä¸Šï¼Œæ—©æœŸå®ä¸šå®¶é€šå¸¸éå¸¸æ³¨é‡ä»é•¿è¿œçš„è§’åº¦ç»è¥è‡ªå·±çš„ä¼ä¸šï¼Œè€Œä¸ä»…ä»…æ˜¯è·å–å°½å¯èƒ½å¤šçš„åˆ©æ¶¦ã€‚ æˆ–è®¸æ›´é‡è¦çš„æ˜¯ï¼Œä»Šå¤©çš„å·¨å‹å…¬å¸ä»ç„¶æ˜¯åœ¨ç«äº‰èµ„æœ¬ä¸»ä¹‰çš„æ¡†æ¶å†…è¿ä½œçš„ ä»ä¸¥æ ¼çš„æ„ä¹‰ä¸Šè¯´ï¼Œå¾ˆå°‘æœ‰å“ªä¸ªå·¨å‹å…¬å¸èƒ½å¤ŸçœŸæ­£å¤„äºä¸€ç§â€œå„æ–­â€çš„åœ°ä½ï¼šè¿™æŒ‡çš„æ˜¯è¿™æ ·ä¸€ç§æƒ…å†µï¼Œåœ¨æŸä¸€ç‰¹å®šç»æµé¢†åŸŸä¸­ï¼Œè¿™ä¸ªå…¬å¸æ˜¯å”¯ä¸€çš„å•†å“ç”Ÿäº§è€…ã€‚ è¿™ç§ç«äº‰çš„å‹åŠ›ï¼Œè¿™ç§ä¸ºäº†è·å¾—å°½å¯èƒ½é«˜çš„è¾¹é™…åˆ©æ¶¦çš„é©±åŠ¨åŠ›ï¼Œå®é™…ä¸Šå¯èƒ½æ˜¯éå¸¸å¤§çš„ã€‚ åº”å½“æ³¨æ„åˆ°ï¼Œç»ç†ä¸»ä¹‰çš„ä¸»å¼ ä¸»è¦ç››è¡Œäº20ä¸–çºªäº”å…­åå¹´ä»£ï¼Œå½“è¥¿æ–¹å·¥ä¸šå¤„äºç¨³å®šæ‰©å¼ å’Œç›¸å¯¹æ²¡ä»€ä¹ˆé—®é¢˜çš„é˜¶æ®µã€‚åœ¨éšåçš„å‡ å¹´é‡Œï¼Œç»æµå±æœºçš„å†ç°ï¼Œä»¥åŠéƒ¨åˆ†å·¥ä¸šåŒ–å›½å®¶ä¾é ä½å»‰çš„åŠ³åŠ¨æˆæœ¬ä½¿æœ¬å›½çš„ç”Ÿäº§å•†æ—¥ç›Šå±…äºä¼˜åŠ¿åœ°ä½ï¼Œå®ƒä»¬ç»™å·¨å‹å…¬å¸åœ¨æŸäº›ç»æµé¢†åŸŸä¸­çš„è·åˆ©èƒ½åŠ›åˆ¶é€ äº†å·¨å¤§çš„éº»çƒ¦ã€‚ ç»ç†ä¹Ÿæ˜¯èµ„æœ¬å®¶ ä¸€æ˜¯ä¸å…¶ä»–èµ„æœ¬æ‰€æœ‰è€…ä¸€æ ·ï¼Œä»–ä»¬åœ¨è‚¡å¸‚ç¹è£æ–¹é¢æœ‰ç€å…±åŒçš„åˆ©ç›Šï¼›äºŒæ˜¯ä»–ä»¬åœ¨å·¨å‹å…¬å¸ä¸­çš„æ´»åŠ¨å—èµ„æœ¬ä¸»ä¹‰ä¼ä¸šè¿™ä¸€æ´»åŠ¨æ¡†æ¶çš„å¼•å¯¼ã€‚ æ”¯é…é˜¶çº§ä¾ç„¶å­˜åœ¨ è¥¿æ–¹èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šåœ¨è´¢å¯Œåˆ†é…æ–¹é¢ä»ç„¶å­˜åœ¨çš„æ˜æ˜¾ä¸å¹³ç­‰ç°è±¡ã€‚å¦‚æœæˆ‘ä»¬ä»è‚¡ç¥¨å’Œè‚¡æƒçš„è§’åº¦è€ƒå¯Ÿï¼Œè€Œä¸æ˜¯ä¸€èˆ¬è´¢å¯Œçš„è§’åº¦æ¥çœ‹ï¼Œå°‘æ•°äººå æœ‰çš„æƒ…å†µè¿˜è¦æ›´åŠ çªå‡ºã€‚ ç¤¾ä¼šæµåŠ¨çš„é—®é¢˜â€”â€”ä»ç²¾è‹±ç¾¤ä½“çš„æ„æˆè§’åº¦æ¥çœ‹ï¼Œç”šè‡³æ ¹æœ¬å°±ä¸å­˜åœ¨ä»€ä¹ˆç¤¾ä¼šæµåŠ¨ã€‚ å·¥ä¼šï¼šé˜¶çº§å†²çªçš„åˆ¶åº¦åŒ– ç°è±¡ï¼š ä¸€ä¸ªä¸–çºªä»¥æ¥ï¼Œå¢“ä»ç„¶æ²¡æœ‰æŒ–å¥½ï¼Œè€Œä¸”ï¼Œèµ„æœ¬ä¸»ä¹‰æœªæ¥çš„ç»§æ‰¿äººå°½ç®¡ä¸å†åƒå…¶å…ˆç¥–é‚£æ ·å……æ»¡æ´»åŠ›ï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ç§æ­»æœŸå°†è‡³çš„ä¸¥é‡å¨èƒã€‚ è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š â€œé˜¶çº§å†²çªåˆ¶åº¦åŒ–â€æ˜¯å·¥ä¸šç¤¾ä¼šç†è®ºå®¶æ‰€çƒ­è¡·çš„è§‚ç‚¹ä¹‹ä¸€ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜ç™½åœ°æ¶µç›–äº†ä»–ä»¬æ‰€ç€é‡å¼ºè°ƒçš„é‡ç‚¹ã€‚å› ä¸ºæ ¹æ®è¿™äº›ä½œè€…çš„è§‚ç‚¹ï¼Œå…¬å¼€æˆ–è€…ç ´åæ€§çš„é˜¶çº§æ–—äº‰ä»…ä»…å±€é™äºå·¥ä¸šèµ„æœ¬ä¸»ä¹‰å‘å±•çš„æ—©æœŸé˜¶æ®µã€‚å·¥ä¸šä»²è£æ¨¡å¼çš„å»ºç«‹å’Œè§„èŒƒåŒ–ä½¿é˜¶çº§å†²çªçš„æ£±è§’è¶‹äºé’åŒ–ï¼Œå¹¶è½¬åŒ–æˆä¸ºâ€œå·¥ä¸šå†²çªâ€ã€‚ æ”¿æ²»æƒåŠ›çš„è·å¾—ä¹Ÿä¿ƒè¿›äº†å…¶å·¥ä¸šè°ˆåˆ¤æƒåˆ©çš„å‘å±•ã€‚ T. H.é©¬æ­‡å°”(T. H. Marshall) 19ä¸–çºªçš„é˜¶çº§å†²çªè¢«æ­¤åå‘å±•èµ·æ¥çš„ä¸‰ç§è¿ç»­æ€§â€œå…¬æ°‘èº«ä»½æƒåˆ©â€(citizenship rights)æ‰€è½¯åŒ–ã€‚è¿™ä¸‰ç§å…¬æ°‘æƒåˆ©æ˜¯ï¼šå…¬æ°‘èº«ä»½æƒåˆ©ã€å…¬æ°‘æ”¿æ²»æƒåˆ©å’Œå…¬æ°‘ç¤¾ä¼šæƒåˆ©ã€‚ ç¬¬ä¸€ç§å…¬æ°‘èº«ä»½æƒåˆ©ï¼Œä¸»è¦æ¶‰åŠæ³•å¾‹é¢å‰äººäººå¹³ç­‰å’Œå‚ä¸æ³•å¾‹ä½“ç³»çš„æƒåˆ©ã€‚ ç¬¬äºŒç§å…¬æ°‘æ”¿æ²»æƒåˆ©ï¼Œä¸»è¦æŒ‡æ™®éå…¬æ°‘æƒçš„è·å¾—ï¼Œä»¥åŠç»„å»ºæ”¿å…šçš„æƒåˆ©ã€‚ ç¬¬ä¸‰ç§æƒåˆ©ä¸»è¦æŒ‡å·¥ä¸šè°ˆåˆ¤çš„æƒåˆ©å’Œè·å¾—ç¦åˆ©çš„æƒåˆ©â€”â€”åŒ…æ‹¬å¤±ä¸šæ•‘æµã€åŒ»ç–—ä¿é™©ï¼Œç­‰ç­‰ã€‚ é©¬æ­‡å°”è¯´é“ï¼Œåœ¨è¿‡å»100å¤šå¹´çš„æ—¶é—´é‡Œï¼Œâ€œå…¬æ°‘èº«ä»½ä¸èµ„æœ¬ä¸»ä¹‰çš„é˜¶çº§ä½“ç³»ä¸€ç›´å¤„äºå°–é”å¯¹ç«‹çš„çŠ¶æ€â€ã€‚ä½†æ˜¯ï¼Œèƒœåˆ©çš„æ˜¯å‰è€…ï¼Œå°½ç®¡è¿™ç§èƒœåˆ©å¯èƒ½å¹¶ä¸å…¨é¢ï¼Œä½†é˜¶çº§æ–—äº‰çš„å¨èƒå·²ç»ä¸å†è¶³äºç“¦è§£èµ„æœ¬ä¸»ä¹‰ç§©åºäº†ã€‚ å¯¹é©¬æ­‡å°”çš„ä¿®æ­£ é©¬æ­‡å°”æ²¡æœ‰å……åˆ†å¼ºè°ƒâ€œèµ„äº§é˜¶çº§æ³•å¾‹å…³ç³»â€ä¸é›‡ä½£å·¥äººçš„åœ°ä½ä¹‹é—´å­˜åœ¨çš„ä¸å¹³è¡¡ç‰¹å¾ã€‚ æ—©æœŸèµ„æœ¬å®¶ä¾§é‡äºå»ºç«‹ä¸€ä¸ªèƒ½å¤ŸæŒ‰è‡ªå·±æ„å¿—åŠ ä»¥é›‡ä½£æˆ–è§£é›‡çš„â€œè‡ªç”±â€åŠ³åŠ¨åŠ›åå¤‡é˜Ÿä¼ã€‚ èµ„æœ¬ä¸»ä¹‰çš„åŠ³åŠ¨å¥‘çº¦é¢„å…ˆå‡å®šäº†å½¢å¼ä¸Šâ€œè‡ªç”±â€çš„ä¸ªä½“ï¼Œä»–ä»¬ä¹‹é—´ä¸å­˜åœ¨å„ç§å°å»ºæ•ˆå¿ å…³ç³»çš„çº¦æŸï¼Œè¿™æ˜¯ä¸€ç§é€šè¿‡è‡ªç”±å¥‘çº¦æ‰€å½¢æˆçš„çº¯ç²¹ç»æµå…³ç³»ã€‚ ä½†æ˜¯ï¼Œè¿™ç§â€œè‡ªç”±â€å®é™…ä¸Šæœ‰åŠ©äºé›‡ä¸»æ”¯é…å·¥äººçš„æƒåŠ›ã€‚ æ”¿æ²»æƒåˆ©å°½ç®¡ä½¿æ¯ä¸€ä¸ªäººæˆä¸ºäº†å…¬æ°‘ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å»¶ä¼¸åˆ°å·¥ä¸šé¢†åŸŸï¼Œå¯æ˜¯ï¼Œè¿™ä¸€é¢†åŸŸå´å æ®äº†å¤§å¤šæ•°äººæ—¥å¸¸ç”Ÿæ´»çš„å¤§éƒ¨åˆ†æ—¶é—´ã€‚ é©¬æ­‡å°”æ‰€æè¿°çš„å…¬æ°‘èº«ä»½æƒåˆ©çš„æ‰©å¼ å®é™…ä¸Šå¹¶éå›½å®¶ä»æ…ˆçš„ç»“æœï¼Œè€Œæ˜¯å¿…é¡»ç§¯æäº‰å–çš„ä¸œè¥¿ã€‚ é©¬æ­‡å°”æ‰€è¯´çš„â€œç¦åˆ©å›½å®¶â€ä¾ç„¶æ˜¯èµ„æœ¬ä¸»ä¹‰ åœ¨ç§æœ‰èµ„æœ¬çš„æ”¯é…ä¸‹ï¼Œç”Ÿäº§åˆ©æ¶¦ä»ç„¶æ˜¯ç»æµç³»ç»Ÿçš„ä¸»è¦åŠ¨åŠ›ï¼› ç§æœ‰è´¢äº§ï¼Œå°¤å…¶æ˜¯ç§æœ‰èµ„æœ¬çš„åˆ†å¸ƒä»ç„¶æ˜¯é«˜åº¦ä¸å‡è¡¡çš„ï¼› é˜¶çº§å†²çªåœ¨ç»æµå’Œæ”¿æƒ(polity)å±‚é¢ä»ç„¶å…·æœ‰é‡è¦çš„æ„ä¹‰ã€‚å› æ­¤ï¼Œå¯ä»¥è¯´ï¼Œèµ„æœ¬ä¸»ä¹‰ä»ç„¶æ˜¯é˜¶çº§ç¤¾ä¼šã€‚ ç™½é¢†é˜¶å±‚ ç°è±¡ï¼š 20ä¸–çºªè¥¿æ–¹ç¤¾ä¼šçš„é˜¶çº§ä½“ç³»å‘ç”Ÿçš„ä¸€ä¸ªå¼•äººæ³¨ç›®å’Œæœ€å—åˆ°è®¨è®ºçš„å˜åŒ–å°±æ˜¯ï¼Œä¸ä½“åŠ›æˆ–è€…â€œè“é¢†â€åŠ³åŠ¨æ¯”è¾ƒï¼Œâ€œéä½“åŠ›â€æˆ–è€…â€œç™½é¢†â€å·¥ä½œçš„ç›¸å¯¹å¢é•¿ã€‚ è¿™äº›ç»Ÿè®¡æ•°æ®ä¼¼ä¹ä¸é©¬å…‹æ€æ‰€è®¾æƒ³çš„èµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šçš„å‘å±•è½¨è¿¹å®Œå…¨èƒŒé“è€Œé©°ã€‚å› ä¸ºé©¬å…‹æ€ç›¸ä¿¡ï¼Œå¤§éƒ¨åˆ†äººå£å°†æ³¨å®šè¦æˆä¸ºä½“åŠ›åŠ³åŠ¨è€…ï¼Œä»äº‹ä¸€äº›ä¾‹è¡Œå•è°ƒçš„å·¥ä½œï¼Œå°èµ„æœ¬å®¶å¾ˆå¤§ç¨‹åº¦ä¸Šå°†æ¶ˆå¤±ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªå°‘æ•°å¤§èµ„æœ¬å®¶ä¸å¹¿å¤§æ— äº§é˜¶çº§å¯¹æŠ—çš„æ ¼å±€ã€‚ è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š é©¬å…‹æ€æ‰€è®¾æƒ³çš„æ˜¯ä¸€ä¸ªä¸¤ä¸ªå¯¹ç«‹é˜¶çº§æ—¥ç›Šåˆ†è£‚çš„ç¤¾ä¼šã€‚ä½†çš„ç¡®ï¼Œæ–°ä¸­é—´é˜¶çº§çš„æ‰©å¼ å·²æˆä¸ºä¸€ç§ä¿ƒè¿›ç¨³å®šçš„åŠ›é‡ï¼Œå®ƒè…èš€äº†å·¥äººé˜¶çº§ï¼Œä½¿ä¹‹è¶Šæ¥è¶Šçº³å…¥åˆ°ä¸­é—´é˜¶çº§çš„é˜Ÿä¼ä¸­ï¼Œè€Œä¸æ˜¯åè¿‡æ¥ä½¿ä¸­é—´é˜¶çº§å—åˆ°æ”¹é€ ã€‚ ä½†åŒæ—¶è®¸å¤šç™½é¢†èŒä¸šä¾æ—§å…·æœ‰å•è°ƒã€ç”šè‡³æ˜¯æœºæ¢°æ€§çš„ç‰¹å¾ å¤§éƒ¨åˆ†äººè®¤ä¸ºï¼Œå°½ç®¡æ–°ä¸­é—´é˜¶çº§å¹¶ä¸åƒç»Ÿè®¡æ•°æ®æ‰€å¤©çœŸåœ°è¡¨æ˜çš„é‚£ä¹ˆå¤§ï¼Œä½†å®ƒæˆ–å¤šæˆ–å°‘å·²æˆä¸ºèµ„æœ¬ä¸»ä¹‰é˜¶çº§å…³ç³»çš„ä¸€ä¸ªå¤æ‚å› ç´ ã€‚ ä¿¡æ¯æŠ€æœ¯ä»¥åŠå¤±ä¸šè€… ç°è±¡1ï¼š æˆ‘ä»¬æ­£åœ¨è¿›å…¥ä¸€ä¸ªç”±â€œä¿¡æ¯æŠ€æœ¯â€æ‰€æ”¯é…çš„æ—¶ä»£ï¼Œè¿™ä¸ªæ—¶ä»£ä¸å†åƒè¿‡å»é‚£æ ·ç”±åˆ¶é€ å·¥ä¸šæ‰€ä¸»å®°ã€‚ è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š ç§‘å­¦åœ¨ç°ä»£ç”Ÿäº§ä¸­æ‰€å‘æŒ¥çš„ä½œç”¨ã€ç”µè„‘æŠ€æœ¯çš„å¹¿æ³›é‡‡ç”¨ï¼Œå°¤å…¶æ˜¯æœ€è¿‘å¾®èŠ¯ç‰‡æŠ€æœ¯çš„å¹¿æ³›æ™®åŠï¼Œå°†å¯¹å…ˆå‰çš„ç¤¾ä¼šç§©åºäº§ç”Ÿæ·±è¿œçš„å½±å“ã€‚ åé©³ åå·¥ä¸šç¤¾ä¼šæ¦‚å¿µå»¶ç»­äº†éšè—åœ¨å·¥ä¸šç¤¾ä¼šç†è®ºåé¢çš„æŠ€æœ¯å†³å®šè®ºã€‚ åœ¨åœ£è¥¿é—¨æ‰€æ„æƒ³çš„â€œå·¥ä¸šç¤¾ä¼šâ€ä¸­ï¼Œå°±æ˜¯ç§‘å­¦å®¶å’ŒæŠ€æœ¯ä¸“å®¶çš„è”åˆç»Ÿæ²»ã€‚ä½†æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æˆä¸ºç°å®ï¼Œè€Œä¸”å°½ç®¡å½“ä»£ä¿¡æ¯æŠ€æœ¯çªé£çŒ›è¿›ï¼Œå®ƒä»ç„¶ä¸å¤ªå¯èƒ½å®ç°ã€‚ åªæœ‰åœ¨ä¸€ç§ä¸–ç•Œæ€§çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬æ‰èƒ½å……åˆ†ç†è§£ä¸æ–°æŠ€æœ¯å‘å±•è”ç³»åœ¨ä¸€èµ·çš„ç¤¾ä¼šå’Œç»æµå˜è¿ ç°è±¡2ï¼š ä¿¡æ¯æŠ€æœ¯çš„å¹¿æ³›ä½¿ç”¨å¯èƒ½é€æ¸æ”¹å˜å¤§éƒ¨åˆ†äººæ‰€ä»äº‹çš„å·¥ä½œçš„æ€§è´¨ï¼Œå¹¶æé«˜å¤±ä¸šç‡çš„æ°´å¹³ã€‚äº‹å®ä¸Šï¼Œå¤§éƒ¨åˆ†ä¸–ç•Œç»æµéƒ½æ·±é™·äºé•¿æœŸæ€§ç»æµè¡°é€€ä¹‹ä¸­ï¼Œè¿‘å¹´æ¥ï¼Œè®¸å¤šå›½å®¶çš„å¤±ä¸šç‡æ°´å¹³ä¹Ÿæ€¥å‰§æå‡ã€‚é’ˆå¯¹è¿™äº›ç°è±¡ï¼Œè®¸å¤šäººè®¤ä¸ºï¼Œå·¥ä¸šå›½å®¶å°†æ°¸è¿œä¸å¯èƒ½å†å›åˆ°20ä¸–çºª60å¹´ä»£é‚£ç§â€œå……åˆ†å°±ä¸šâ€çš„ç»æµæ™¯è±¡ä¸­å»äº†ã€‚ è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š æ³•å›½ä½œå®¶é«˜å…¹(Gorz)â€”â€”å·¥äººé˜¶çº§åœ¨æ¶ˆå¤± å½“å‰çš„æƒ…å†µæ˜¯ï¼Œä¸å…¶è¯´æ— äº§é˜¶çº§æ¨ç¿»èµ„æœ¬ä¸»ä¹‰ä½“ç³»ï¼Œåä¸å¦‚è¯´èµ„æœ¬ä¸»ä¹‰çš„æˆç†Ÿè¶Šæ¥è¶Šç¼©å°äº†å·¥äººé˜¶çº§çš„ä½œç”¨ã€‚ åœ¨ä»–çœ‹æ¥ï¼Œä¿¡æ¯æŠ€æœ¯å°†æ¶ˆé™¤å¤§éƒ¨åˆ†ç°å­˜çš„ä½“åŠ›åŠ³åŠ¨ï¼ŒåŒæ—¶ä¹Ÿå°†æ¶ˆé™¤è®¸å¤šå•è°ƒä¹å‘³çš„ç™½é¢†å·¥ä½œã€‚ ç°ä»£å·¥ä¸šæ‰€éšå«çš„ç”Ÿäº§èƒ½åŠ›ï¼Œèƒ½å¤Ÿåˆ›é€ è¿œé«˜äºæ»¡è¶³äººç±»åŸºæœ¬éœ€è¦æ‰€å¿…é¡»çš„è´¢å¯Œã€‚ å·¥ä½œæœ¬èº«å°†æˆä¸ºç›®çš„ï¼Œç”±å®ƒèƒ½å¤Ÿæä¾›ç»™ç”Ÿäº§è€…çš„è‡ªæˆ‘æ»¡è¶³æ°´å¹³æ‰€å†³å®šã€‚ ç„¶è€Œï¼Œé«˜å…¹è¯´é“ï¼Œèµ„æœ¬ä¸»ä¹‰çš„åç»­å‘å±•å´å½»åº•èƒŒç¦»äº†è¿™æ ·ä¸€ç§é¢„æœŸã€‚ç®¡ç†åˆ¶åº¦æ‰€é‡‡å–çš„ä¸¥æ ¼çš„åŠ³åŠ¨æ§åˆ¶ï¼Œå·²ç»æœ‰æ•ˆåœ°å‹åˆ¶äº†å·¥äººå½¢æˆä»»ä½•åˆ›é€ æ€§åŠ³åŠ¨æ½œåŠ›çš„æ„è¯†ã€‚ â€œå½“å‰çš„é‡ç‚¹åœ¨äºåå¯¹åŠ³åŠ¨çš„æ€§è´¨ã€å†…å®¹ã€å¿…ç„¶æ€§å’Œå„ç§æ¨¡å¼ï¼Œä»¥ä¾¿ä½¿è‡ªå·±ä»åŠ³åŠ¨ä¸­è§£æ”¾å‡ºæ¥ã€‚â€ ä¸Šé¢æ‰€å‹¾ç”»çš„å‘å±•è¶‹åŠ¿è¡¨æ˜ï¼Œå·¥äººé˜¶çº§å·²ç»è¢«é«˜å…¹æ‰€è¯´çš„â€œéåŠ³åŠ¨è€…çš„éé˜¶çº§â€(non-class of non-workers)æˆ–â€œæ–°æ— äº§é˜¶çº§â€(neoproletariat)æ‰€å–ä»£ã€‚ è¿™ä¸ªé˜¶çº§æˆ–è€…ç”±å¤§é‡æ°¸ä¹…å¤±ä¸šçš„äººå‘˜æ‰€ç»„æˆï¼Œæˆ–è€…å³ä½¿ä»–ä»¬åœ¨å·¥ä½œï¼Œä¹Ÿæ²¡æœ‰å¾—åˆ°å¾ˆå¥½ç»„ç»‡ï¼Œç¼ºä¹é˜¶çº§è®¤åŒï¼ŒèŒä¸šçš„ä¿éšœç¨‹åº¦ä¹Ÿè¾ƒä½ã€‚ä»é•¿æœŸæ¥çœ‹ï¼Œä½œä¸ºä¿¡æ¯æŠ€æœ¯ä¸æ–­æ‰©å¼ çš„ç»“æœï¼Œå¤±ä¸šçš„é˜Ÿä¼å°†ä¼šæ—¥ç›Šå¢å¤§ã€‚ ä»–ä»¬è¶Šæ¥è¶Šå€¾å‘äºå¯»æ±‚æ»¡è¶³æ„Ÿçš„æºæ³‰ï¼Œä½†è¿™ç§æ»¡è¶³æ„Ÿä¸å·¥ä½œå’Œå·¥ä½œåœºæ‰€æ¯«æ— å…³ç³» é«˜å…¹å®£ç§°ï¼Œæˆ‘ä»¬æ­£åœ¨èµ°å‘ä¸€ç§â€œäºŒå…ƒç¤¾ä¼šâ€ï¼šä¸€æ–¹é¢ï¼Œç”Ÿäº§å’Œæ”¿æ²»ç®¡ç†å°†ä¼šå¾ˆå¥½åœ°ç»„ç»‡èµ·æ¥ï¼Œä»¥ä½¿å…¶æ•ˆç‡æœ€å¤§åŒ–ï¼›å¦ä¸€æ–¹é¢ï¼Œå°†ä¼šå‡ºç°ä¸€ä¸ªä¸ªäººå…·æœ‰å¤šå…ƒè¿½æ±‚çš„é¢†åŸŸï¼Œåœ¨è¿™ä¸€é¢†åŸŸä¸­ï¼Œäº«å—å’Œè‡ªæˆ‘æ»¡è¶³å°†æˆä¸ºè¿½æ±‚çš„ç›®æ ‡ã€‚ ç”Ÿäº§ä¸»ä¹‰çš„å·¥ä½œä¼¦ç†å°†è®©ä½äºä¸€ç§å…³æ³¨åº¦è¿‡â€œè‡ªç”±æ—¶é—´â€çš„å…¨æ–°è§‚å¿µï¼Œè¿™ç§è‡ªç”±æ—¶é—´å°†ä¸å†ä»…ä»…è¢«å½“ä½œæ˜¯ä¸€å¤©æ´»åŠ¨ä¹‹å¤–çš„ä½™æš‡ã€‚ å¸Œé»˜å°”æ–¯ç‰¹å…°å¾·â€”â€”å·¥äººé˜¶çº§åœ¨æ‰©å¤§ åœ¨ç‘å…¸ï¼Œå·¥äººé˜¶çº§å¹¶æ²¡æœ‰èç¼© ä»–å¸Œæœ›çœ‹åˆ°çš„å¹¶ä¸æ˜¯ä»»ä½•å›½æœ‰å·¥ä¸šçš„æ‰©å±•ï¼Œæˆ–ç”Ÿäº§è®¡åˆ’é›†ä¸­åŒ–çš„æ‰©å±•ã€‚ç›¸åï¼Œä»–å¸Œæœ›çœ‹åˆ°çš„æ˜¯å·¥äººåœ¨æŸç§ç¨‹åº¦ä¸Šå®é™…æ§åˆ¶ä»–ä»¬æ‰€ä»äº‹çš„ç”Ÿäº§è¿‡ç¨‹â€”â€”åœ¨é«˜å…¹çœ‹æ¥ï¼Œç°ä»£å·¥ä¸šæ˜¯ä¸å¯èƒ½å®ç°è¿™ä¸ªç›®æ ‡çš„ã€‚ ç›¸åï¼Œä»–æ‰€è°ˆè®ºçš„æ˜¯ä»–æ‰€è°“çš„â€œæ‰©å±•çš„æ— äº§é˜¶çº§â€(extended working class)â€”â€”æŒ‡å¤§éƒ¨åˆ†åŠ³åŠ¨åŠ›â€”â€”ä»–ä»¬å¯¹ç¤¾ä¼šä¸»ä¹‰æ”¹é©å…·æœ‰æ™®éçš„å…´è¶£ã€‚ å¸Œé»˜å°”æ–¯ç‰¹å…°å¾·è¯•å›¾è¡¨æ˜çš„æ˜¯ï¼Œæ ¹æ®å„ç§é˜¶çº§æ„è¯†æŒ‡æ ‡ï¼Œè¿™ç§ä»¥æ‰©å±•çš„æ— äº§é˜¶çº§é¢ç›®","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:4:1","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"å›½å®¶æ€§è´¨é—®é¢˜ å›½å®¶åœ¨ç¤¾ä¼šç”Ÿæ´»ä¸­çš„ä½œç”¨å·²æ—¥ç›Šæ‰©å¼ çš„é—®é¢˜ã€‚ ä»ç»æµè§’åº¦çœ‹ï¼Œèµ„æœ¬ä¸»ä¹‰å›½å®¶åœ¨æŒ‡å¯¼ç”Ÿäº§æ´»åŠ¨æ–¹é¢å‘æŒ¥ç€è¶Šæ¥è¶Šç›´æ¥çš„ä½œç”¨ã€‚åœ¨ç»å¤§å¤šæ•°è¿™ç±»å›½å®¶ï¼Œå›½å®¶ç›´æ¥é›‡ä½£çš„åŠ³åŠ¨äººå£å å…¨å›½ä»äº‹ç»æµæ´»åŠ¨çš„åŠ³åŠ¨äººå£çš„40%ä»¥ä¸Š å¦å¤–ï¼Œåœ¨å…¶ä»–ç¤¾ä¼šç”Ÿæ´»é¢†åŸŸï¼ŒåŒæ ·å°‘ä¸äº†å›½å®¶ä»‹å…¥çš„å½±å­ï¼Œå¦‚å‚ä¸ç»„å»ºç›‘ç‹±ã€æ”¶å®¹æ‰€ã€åŒ»é™¢ç­‰ï¼Œå‚ä¸ä¾›ç»™â€œç¦åˆ©â€åç›®ä¸‹çš„å„ç§æœåŠ¡ç­‰ã€‚ ä»¤äººå¥‡æ€ªçš„æ˜¯ï¼Œç›´åˆ°æœ€è¿‘ï¼Œç¤¾ä¼šå­¦å´å¾ˆå¤§ç¨‹åº¦ä¸Šå¿½è§†äº†å›½å®¶çš„å­˜åœ¨ï¼Œä¸è®ºæ˜¯é©¬å…‹æ€ä¸»ä¹‰çš„ç¤¾ä¼šå­¦å®¶è¿˜æ˜¯å…¶ä»–æµæ´¾çš„ç¤¾ä¼šå­¦å®¶ï¼Œéƒ½æ¦‚è«èƒ½å¤–ã€‚ ç„¶è€Œï¼Œåœ¨è¿‡å»10å¹´å·¦å³ï¼Œå›½å®¶å´æˆä¸ºè®¨è®ºçš„çƒ­é—¨è¯é¢˜ï¼Œåœ¨é©¬å…‹æ€ä¸»ä¹‰è€…ä¸­å°¤å…¶å¦‚æ­¤ã€‚ å›½å®¶ä¸é˜¶çº§ è§‚ç‚¹1ï¼š é˜¶çº§ç»Ÿæ²»çš„ç›´æ¥å·¥å…·ï¼Œç›´æ¥ç”±èµ„äº§é˜¶çº§æ‰€æ”¯é…ã€‚ å›½å®¶çš„é˜¶çº§ç‰¹å¾åœ¨äºå›½å®¶å®˜åƒšæ‰€ç»´æŠ¤çš„æ˜¯æ•´ä¸ªèµ„æœ¬ä¸»ä¹‰ç”Ÿäº§çš„å»¶ç»­æ€§ã€‚ åœ¨ä¸€ä¸ªä¾ç„¶æ˜¯é˜¶çº§ç¤¾ä¼šçš„ç¤¾ä¼šï¼Œç»Ÿæ²»åœˆå­ä¸­å­˜åœ¨ç€ç›¸å½“å¤šçš„æ´¾ç³»å’Œæ‘©æ“¦ã€‚ è§‚ç‚¹2ï¼š ä½†åœ¨æ™®æœ—æŸ¥å…¹çœ‹æ¥ï¼Œèµ„äº§é˜¶çº§æ˜¯ä¸€ä¸ªå†…åœ¨åˆ†è£‚çš„é˜¶çº§ï¼Œå›½å®¶å…·æœ‰ä¸€ç§ç‹¬ç«‹äºèµ„äº§é˜¶çº§çš„â€œç›¸å¯¹è‡ªä¸»æ€§â€ã€‚ åœ¨æ™®æœ—æŸ¥å…¹çœ‹æ¥ï¼Œä¸Šå±‚é˜¶çº§å†…éƒ¨ä¹Ÿå­˜åœ¨ç€åˆ†è£‚ï¼Œä½†è¿™å¹¶ä¸è¯´æ˜èµ„äº§é˜¶çº§çš„æ”¯é…ç”±æ­¤å°±é­åˆ°äº†ç ´åï¼Œåˆ†è£‚æ˜¯ä¸€ç§æ­£å¸¸çš„ç°è±¡ï¼Œå…³é”®åœ¨äºï¼Œèµ„æœ¬ä¸»ä¹‰ç”Ÿäº§çš„åˆ¶åº¦æ€§æ¶æ„èƒ½å¤Ÿç»´æŒä¸‹å»ã€‚ å›½å®¶ä¸å®˜åƒš éŸ¦ä¼¯ èµ„æœ¬ä¸»ä¹‰ç‰¹å¾ï¼šä¾‹è¡ŒåŒ– åªæœ‰åœ¨éä¸ªäººåŒ–çš„å‡†åˆ™(norm)çš„åŸºç¡€ä¸Šï¼Œè¿™ç§ä¾‹è¡ŒåŒ–çš„å½¢å¼æ‰èƒ½å»ºç«‹èµ·æ¥ï¼Œå› ä¸ºè¿™ç§å‡†åˆ™èƒ½å¤Ÿå¯¹å„ç§ç¨‹åºè¿›è¡Œè¯¦ç»†çš„è¯´æ˜ï¼Œå¹¶ä½¿ç²¾ç¡®çš„ç»æµè®¡ç®—æˆä¸ºå¯èƒ½ã€‚ éŸ¦ä¼¯æ¯”é©¬å…‹æ€æ›´åŠ å¼ºè°ƒï¼Œèµ„æœ¬ä¸»ä¹‰æ‰©å¼ çš„æ¡ä»¶åœ¨äºå®˜åƒšåˆ¶å›½å®¶çš„æ—©æœŸå‘å±•ã€‚åœ¨ä»–çœ‹æ¥ï¼Œåœ¨å›½å®¶çš„ç®¡ç†ä¹‹ä¸‹ï¼Œå»ºç«‹èµ·ä¸€å¥—å®Œå¤‡çš„æ³•å¾‹ä½“ç³»å’Œé‡‘èä½“ç³»æ˜¯èµ„æœ¬ä¸»ä¹‰ç”Ÿäº§å¤§è§„æ¨¡æ‰©å¼ çš„å¿…è¦åŸºç¡€ã€‚ ä»æœ¬è´¨ä¸Šçœ‹ï¼Œå®˜åƒšåˆ¶ä½¿æƒåŠ›é›†ä¸­åœ¨å°‘æ•°äººæ‰‹é‡Œï¼Œå³é›†ä¸­åœ¨å¤„äºç»„ç»‡é¡¶å³°çš„é‚£äº›äººæ‰‹é‡Œã€‚ å·¥äººè¢«å‰¥å¤ºç”Ÿäº§èµ„æ–™çš„æƒ…å†µå¹¶ä¸ä»…ä»…é™äºèµ„æœ¬ä¸»ä¹‰ç¤¾ä¼šï¼Œå› æ­¤ï¼Œè¶…è¶Šèµ„æœ¬ä¸»ä¹‰å¹¶ä¸è§å¾—è¿™ä¸€ç°è±¡å°±å°†æ¶ˆå¤±ã€‚ ä½¿å¤§éƒ¨åˆ†äººä»…ä»…æˆä¸ºâ€œæœºå™¨ä¸Šçš„ä¸€ä¸ªå°é½¿è½®â€ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯å®˜åƒšåˆ¶çš„ä¸€èˆ¬ç‰¹å¾ æ°‘ä¸»çš„ç†å¿µèµ·æºäºå°å‹ç¤¾ä¼šï¼Œåœ¨è¿™ç§ç¤¾ä¼šä¸­ï¼Œé‚£äº›èƒ½è¢«ç§°ä½œâ€œå…¬æ°‘â€çš„äººä»…ä»…å äººå£ä¸­çš„æå°éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†äººå¯ä»¥äº²è‡ªå‚ä¸å„ç§é›†ä¼šä»¥è¡Œä½¿æ”¿æ²»æƒåŠ›ã€‚ ç°ä»£æ˜¯â€œæ”¿å…šæœºå™¨çš„æ”¿æ²»â€(party machine politics)çš„æ—¶ä»£ï¼Œåœ¨è¿™ç§æ—¶ä»£é‡Œï¼Œæ™®é€šå…¬æ°‘çš„å‚ä¸ç¨‹åº¦å¯¹æ”¿ç­–åˆ¶å®šçš„å½±å“å¯è°“å¾®ä¹å…¶å¾®ã€‚ â€œæ°‘ä¸»çš„ç²¾è‹±ä¸»ä¹‰â€(democratic elitism)æˆ–è®¸æ˜¯ä¸€ç§æœ‰é™çš„æ”¿æ²»å‚ä¸æ¨¡å¼ï¼Œä½†åœ¨å¤šå…šåˆ¶çš„èƒŒæ™¯ä¸‹ï¼Œå®ƒè¿˜æ˜¯å¥½è¿‡ä»€ä¹ˆéƒ½æ²¡æœ‰ å‚ä¸å¼æ°‘ä¸»çš„å¯èƒ½æ€§ å¯¡å¤´ç»Ÿæ²»çš„é“å¾‹æ—¢ä¸æ˜¯ä¸€ç§é“å¾‹ï¼Œç”šè‡³æ ¹æœ¬å°±æ˜¯ä¸€ç§æœªåŠ é™åˆ¶çš„ä¸ç¡®åˆ‡è¡¨è¾¾ã€‚ å®é™…ä¸Šï¼Œåœ¨é«˜åº¦æ•´åˆçš„å·¥ä½œæ¡ä»¶ä¸‹ï¼Œå·¥äººåœ¨æŸäº›æ–¹é¢è·å¾—äº†æ¯”ä»¥å‰è¿˜è¦å¤§çš„æƒåŠ›ã€‚å› ä¸ºé«˜åº¦æ•´åˆçš„ç”Ÿäº§çº¿æ˜¯æåº¦è„†å¼±çš„ï¼Œå¾ˆå®¹æ˜“ä¸ºå°‘éƒ¨åˆ†å·¥äººæ­¥è°ƒä¸€è‡´çš„è¡Œä¸ºæ‰€ç ´åã€‚ æ‰€æœ‰è¡ŒåŠ¨è€…éƒ½æ˜¯å…·æœ‰è®¤çŸ¥èƒ½åŠ›çš„è¡ŒåŠ¨è€…ï¼Œè€Œä¸æ˜¯åªå—å…¶è¡ŒåŠ¨ç¯å¢ƒå½±å“çš„è¢«åŠ¨æ¥å—è€…ï¼Œè®¤è¯†åˆ°è¿™ä¸€ç‚¹å…·æœ‰é‡è¦çš„ç¤¾ä¼šå­¦æ„ä¹‰ã€‚ å¦‚æœå¤„äºä¸‹å±‚åœ°ä½çš„äººèƒ½å¤Ÿé€šè¿‡è¿™ç§æ¶ˆæçš„æ–¹å¼è·å¾—æŸç§ç¨‹åº¦çš„æƒåŠ›çš„è¯ï¼ˆæŒ‡çš„æ˜¯ç½¢å·¥ï¼‰ï¼Œé‚£æˆ‘ä»¬å°±æœ‰å……åˆ†çš„ç†ç”±å‡å®šï¼Œå…¬æ°‘èº«ä»½æƒåˆ©çš„æ‰©å¼ å°†è¿›ä¸€æ­¥æŠŠè¿™ç§æƒåŠ›å»¶å±•è‡³å·¥ä¸šé¢†åŸŸã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼Œåœ¨å½“ä»£ç¤¾ä¼šï¼Œå­˜åœ¨ç€æŸäº›å»ºç«‹â€œå‚ä¸å¼æ°‘ä¸»â€çš„å¯èƒ½æ€§ï¼Œä¸åº”å½“åƒéŸ¦ä¼¯é‚£æ ·å®Œå…¨æ’æ–¥è¿™ç§å¯èƒ½æ€§ã€‚æ­£å¦‚é©¬å…‹æ€çš„åˆ†ææ‰€è¡¨æ˜çš„é‚£æ ·ï¼Œè¿™ç§æ°‘ä¸»åœ¨å·¥ä¸šé¢†åŸŸå°†å…·æœ‰ç‰¹åˆ«å¼ºå¤§çš„åŠ›é‡ã€‚ å›½å®¶ä¸é©å‘½ åœ¨è’‚åˆ©çœ‹æ¥ï¼Œé©å‘½è¿åŠ¨æ˜¯ä»–æ‰€è°“â€œå¤šå…ƒä¸»æƒâ€(multiple sovereignty)â€”â€”å³æŒ‡ç”±äºè¿™ç§æˆ–é‚£ç§åŸå› ï¼Œå›½å®¶æ— æ³•åœ¨å…¶ç»Ÿæ²»èŒƒå›´å†…å……åˆ†è¡Œä½¿æ§åˆ¶æƒâ€”â€”æƒ…å†µä¸‹é›†ä½“è¡ŒåŠ¨çš„æ¬¡çº§ç±»å‹ã€‚ è’‚åˆ©å€¾å‘äºè®¤ä¸ºï¼Œå¯¹åˆ©ç›Šæœ‰æ„è¯†å’Œæœ‰ç›®çš„çš„è¿½æ±‚æ˜¯é©å‘½è¿åŠ¨çš„å…ˆå¯¼ï¼Œè€Œâ€œæˆåŠŸâ€çš„é©å‘½è¿åŠ¨åˆ™å‘ç”Ÿåœ¨äººä»¬è®¾æ³•å®ç°å…¶åˆ©ç›Šçš„æƒ…å†µä¸‹ã€‚ åœ¨æ–¯è€ƒåˆ‡æ³¢çœ‹æ¥ï¼Œé©å‘½è¿åŠ¨çš„ç›®æ ‡å…¸å‹çš„æ˜¯æ¨¡æ£±ä¸¤å¯å’Œæ‘‡æ‘†ä¸å®šçš„ï¼Œå¤§è§„æ¨¡é©å‘½æ€§å˜åŠ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ä¸€ç§æ— æ„è¯†çš„ç»“æœï¼Œæ˜¯æŸäº›ç¾¤ä½“å’Œè¿åŠ¨æ‰€è¦å®ç°çš„ä¸€äº›è¾ƒä¸ºç‰‡é¢çš„ç›®æ ‡çš„æ„å¤–åæœã€‚ å½“æ–¯è€ƒåˆ‡æ³¢å¼ºè°ƒï¼Œé‡å¤§çš„ç¤¾ä¼šé©å‘½å¹¶ä¸æ˜¯é‚£ç§æœ‰ç›®çš„åœ°ç»„ç»‡èµ·æ¥ä»¥æ¨ç¿»ç°å­˜ç¤¾ä¼šç§©åºä¸ºç›®çš„çš„è¿åŠ¨æ—¶ï¼Œå¥¹æ— ç–‘æ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯ï¼Œåœ¨æœ‰ç›®çš„åœ°å½¢æˆçš„ç¤¾ä¼šå˜åŠ¨ä¸â€œç»“æ„æ€§â€å¤±è°ƒæ‰€å¯¼è‡´çš„ç¤¾ä¼šå˜åŠ¨ä¹‹é—´ï¼Œå¥¹æˆ–è®¸è¿‡äºå¼ºè°ƒäº†ä¸¤è€…é—´çš„å¯¹ç«‹ã€‚ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:4:2","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["Sociology"],"content":"ä¸–ç•Œä½“ç³» ç°è±¡ï¼š åœ¨æˆ‘ä»¬çš„æ—¶ä»£ï¼Œæ²¡æœ‰ä»€ä¹ˆä¼šæ¯”å‘ç”Ÿåœ¨ç‰¹å®šæ—¶ç©ºèƒŒæ™¯ä¸­çš„æ—¥å¸¸ç”Ÿæ´»è¡Œä¸ºä¸è·¨è¶Šå¹¿æ³›æ—¶ç©ºèŒƒå›´çš„äº‹ä»¶è”ç³»åœ¨ä¸€èµ·æ›´å¯Œæœ‰ç‰¹è‰²ã€‚ ç°ä»£ä¸–ç•Œä½“ç³»ç†è®ºï¼š ç°ä»£åŒ–ç†è®º ç¬¬ä¸€ï¼Œç¬¬ä¸‰ä¸–ç•Œä¸­çš„ä¼ ç»Ÿç¤¾ä¼šä¸ä»…æ˜¯ä½åº¦å‘å±•(underdeveloped)çš„ç¤¾ä¼šï¼Œè€Œä¸”æ˜¯ä¸å‘è¾¾(undeveloped)çš„ç¤¾ä¼šï¼Œå®ƒä»¬æœ‰å¾…å·¥ä¸šè½¬å‹åŠ›é‡çš„å†²å‡»ã€‚ ç¬¬äºŒï¼Œè¿™äº›å›½å®¶å› æ­¤å¿…é¡»é‡è¹ˆå·¥ä¸šåŒ–å›½å®¶æ‰€èµ°è¿‡çš„è€è·¯ï¼Œå†ç”Ÿäº§å‡ºâ€œå·¥ä¸šç¤¾ä¼šâ€æ‰€å–å¾—çš„æˆå°±ã€‚ æ‰¹åˆ¤ ç°ä»£åŒ–ç†è®ºå»ºç«‹åœ¨ä¸€ç§é”™è¯¯çš„å‰æä¹‹ä¸Šï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œå®ƒä¸ºè¥¿æ–¹èµ„æœ¬ä¸»ä¹‰å›½å®¶æ”¯é…ä¸–ç•Œå…¶ä»–åœ°æ–¹æä¾›äº†æ„è¯†å½¢æ€è¾©æŠ¤ã€‚ å›½å®¶ä¹‹é—´çš„ä¸å¹³ç­‰ æ°‘æ—å›½å®¶ æ°‘æ—å›½å®¶å¯ä»¥è¢«å®šä¹‰ä¸ºï¼šå®ƒæ˜¯æ”¿æ²»æ²»ç†çš„å„ç§åˆ¶åº¦ï¼Œåœ¨è¿™äº›åˆ¶åº¦ä¸‹ï¼Œç¤¾ä¼šç»Ÿæ²»è€…æˆåŠŸåœ°å®ç°äº†å¯¹æš´åŠ›å·¥å…·ï¼ˆå†›é˜Ÿå’Œè­¦å¯Ÿï¼‰çš„å„æ–­ï¼Œæ§åˆ¶æˆä¸ºä»–ä»¬åœ¨ç‰¹å®šé¢†åœŸè¾¹ç•ŒèŒƒå›´å†…è¿›è¡Œè¡Œæ”¿ç®¡ç†çš„ä¸»è¦ä¿éšœæªæ–½ã€‚ ç°ä»£æ°‘æ—å›½å®¶çš„å½¢æˆä¸æ°‘æ—ä¸»ä¹‰æƒ…æ„Ÿçš„å…´èµ·æ¯æ¯ç›¸å…³ã€‚æ°‘æ—ä¸»ä¹‰å¯ä»¥è¢«å®šä¹‰ä¸ºï¼šå¯¹äºæŸäº›ç¬¦å·çš„å…±åŒå½’å±æ„Ÿï¼Œè¿™äº›ç¬¦å·å¯ä»¥ä½¿ç‰¹å®šäººç¾¤çš„æˆå‘˜è®¤åŒä»–ä»¬å½’å±äºç›¸åŒçš„å…±åŒä½“ã€‚ å¦‚æœè¯´èµ„æœ¬ä¸»ä¹‰ä¸–ç•Œç»æµæ˜¯ç°ä»£ä¸–ç•Œä½“ç³»çš„ä¸€ä¸ªçªå‡ºç‰¹å¾çš„è¯ï¼Œé‚£ä¹ˆï¼Œæ°‘æ—å›½å®¶ä½“ç³»åŒæ ·æ˜¯ç°ä»£ä¸–ç•Œä½“ç³»çš„çªå‡ºç‰¹å¾ä¹‹ä¸€ã€‚ å›½å®¶é—´çš„æ— æ”¿åºœä¸»ä¹‰ ","date":"2024-11-23","objectID":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/:4:3","tags":["Book"],"title":"å‰ç™»æ–¯ã€Œç¤¾ä¼šå­¦ã€ç¬”è®°","uri":"/posts/%E5%90%89%E7%99%BB%E6%96%AF%E7%A4%BE%E4%BC%9A%E5%AD%A6%E7%AC%94%E8%AE%B0/"},{"categories":["System"],"content":"â€œI call architecture frozen musicâ€¦â€ - Goethe BitTorrent æ˜¯ä¸€ä¸ª p2p ä¸‹è½½åè®®ï¼Œå®˜ç½‘ç½‘ç«™è§è¿™é‡Œã€‚å®˜æ–¹ç½‘ç«™å†…ä¸ä»…å«æœ‰æ ‡å‡†è§„èŒƒï¼Œè€Œä¸”ä»¿ç…§PEPï¼ˆPython Enhancement Protocolï¼‰ï¼Œæœ‰ç€è‡ªå·±çš„ BEPï¼Œç”¨æ¥å¯¹åè®®è¿›è¡Œå¢å¼ºã€‚ ä¸è¿‡å®˜æ–¹æ ‡å‡†è§„èŒƒè¾ƒä¸ºéš¾æ‡‚ï¼Œè¿™é‡Œæœ‰ä¸€ä»½åè®®çš„éå®˜æ–¹ç‰ˆæœ¬ï¼Œæ›´æ˜“äºç†è§£ï¼š Unofficial Specification è¿™é‡Œä¹Ÿæœ‰ä¸€ä»½ç®€ä»‹ï¼š https://web.cs.ucla.edu/classes/cs217/05BitTorrent.pdf p2p ç½‘ç»œ æœ€ä¸¥æ ¼çš„ p2p ç½‘ç»œå®šä¹‰ä¸ºï¼š A communications model in which each party has the same capabilities and either party can initiate a communication session ä¹Ÿå°±æ˜¯ç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½èµ·ç›¸åŒåŠŸèƒ½ï¼Œä¸”ä¸ä¼šå‡ºç°å•ç‚¹æ•…éšœã€‚ä¸ä¹‹ç›¸åï¼Œserver-client å¼çš„æ¶æ„å°±è¢«ç§°ä¸º é›†ä¸­å¼ ç½‘ç»œã€‚ ARPNET å°±æ˜¯ p2p å¼çš„ï¼›DNS system å¯ä»¥ç®— p2p å’Œ é›†ä¸­å¼ çš„ä¸€ä¸ªæŠ˜ä¸­ã€‚ å‡å¦‚ DNS æ˜¯é›†ä¸­å¼çš„ï¼Œä¸€ä¸ªä¸»æœºè´Ÿè´£å…¨ä¸–ç•Œçš„ IP æŸ¥è¯¢ï¼Œåˆ™å¾ˆå®¹æ˜“ç¢°ä¸Š å•ç‚¹æ•…éšœ å’Œ æ€§èƒ½é™åˆ¶ã€‚å› æ­¤ï¼ŒDNS é‡‡å–äº†åˆ†å¸ƒå¼çš„æ¶æ„â€”â€”æ ‘å½¢é€’å½’æŸ¥è¯¢åŠ ä¸Šå¤šçº§ç¼“å­˜ã€‚æœ‰è®¸å¤šèµ·ç›¸åŒåŠŸèƒ½çš„æœ¬åœ° DNS æœåŠ¡å™¨ï¼ŒæŒ‚æ‰ä¸€ä¸ªä¹Ÿä¸å½±å“æ•´ä¸ªç³»ç»Ÿè¿ä½œï¼Œæœªå°ä¸å¯ç§°ä¹‹ä¸ºæŸç§ç¨‹åº¦ä¸Šçš„ p2pã€‚ å› æ­¤ï¼Œä¸€ä¸ªå®½æ¾ä¸€ç‚¹çš„ p2p å®šä¹‰ï¼š â€œA distributed network architecture may be called a Peer-to-Peer (P-to-P, P2P,â€¦) network, if the participants share a part of their own (hardware) resources (processing power, storage capacity, network link capacity, printers,â€¦). These shared resources are necessary to provide the Service and content offered by the network (e.g. file sharing or shared workspaces for collaboration). They are accessible by other peers directly, without passing intermediary entities. The participants of such a network are thus resource (Service and content) providers as well as resource (Service and content) requestors (Servant-concept).â€ è¿™æ ·çš„å®šä¹‰ä¸‹ï¼Œè™½ç„¶ä¸èƒ½å®Œå…¨é¿å…å•ç‚¹æ•…éšœï¼Œä½†çš„ç¡®ä½“ç°å‡ºæ¥ p2p çš„æœ¬è´¨ï¼š æ¯ä¸ªå‚ä¸è€…å³æ˜¯ æœåŠ¡æä¾›è€… åˆæ˜¯ æœåŠ¡äº«å—è€… å› æ­¤ï¼Œp2p å°±æœ‰ç€ä»¥ä¸‹ç‰¹ç‚¹ï¼š ç›¸å¯¹å¯æ‰©å±•æ€§ï¼šå¢åŠ æœåŠ¡äº«å—è€…çš„åŒæ—¶ä¹Ÿå¢åŠ äº†æœåŠ¡æä¾›è€… ç›¸å¯¹ç¨³å®šæ€§ï¼šè®¸å¤šæœåŠ¡æä¾›è€…ï¼ŒæŒ‚æ‰ä¸€ä¸ªä¹Ÿæ— å¦¨ BitTorrent ä¸‹é¢å†æ¥ä»‹ç»å…¸å‹çš„ p2p åè®® â€”â€” BitTorrentã€‚ BitTorrent ä¸»è¦è¢«ç”¨æ¥åˆ†å‘/ä¸‹è½½æ–‡ä»¶ï¼Œå› ä¸ºå…¶ p2p çš„ç‰¹æ€§è€Œä¸éœ€è¦è€—è´¹ä¸Šä¼ è€…å¤ªå¤šå¸¦å®½ â€”â€” p2p ç½‘ç»œä¸­çš„æ¯ä¸ªç”¨æˆ·åœ¨ä¸‹è½½æ–‡ä»¶çš„åŒæ—¶ä¹ŸæŠŠè‡ªå·±å·²ä¸‹è½½å¥½çš„æ–‡ä»¶ä¼ ç»™åˆ«äººã€‚ BitTorrent åè®®ä¸åœ¨å®ƒä¹‹å‰çš„ p2p åè®®ç›¸æ¯”ï¼Œæœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼šå®ƒä¼šæŠŠæ¯ä¸ªæ–‡ä»¶éƒ½åˆ‡åˆ†ä¸ºè®¸å¤šå°å—ï¼ˆpieceï¼‰ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶å‘è®¸å¤šåŒä¼´ï¼ˆpeerï¼‰è¯·æ±‚åŒä¸€ä¸ªæ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†ã€‚ è€Œå®ƒä¹‹å‰çš„ p2p åè®®å¾€å¾€æ˜¯ä¸€å¯¹ä¸€åè®®ï¼Œä¸€ä¸ªä¸‹è½½å¥½çš„äººè´Ÿè´£ç»™ä¸€ä¸ªæ²¡æœ‰ä¸‹è½½å¥½çš„äººä¼ é€æ–‡ä»¶ã€‚ä½†æ˜¯å› ä¸ºä¸€èˆ¬ç½‘å¡çš„ä¸Šä¼ å¸¦å®½éƒ½è¿œè¿œå°äºä¸‹è½½å¸¦å®½ï¼Œå› æ­¤è¿™ç§æ¨¡å‹ä¸‹ï¼Œæ–‡ä»¶ä¼ é€çš„æœ€å¤§é€Ÿç‡æœ€å¤§ä¹Ÿåªèƒ½ç­‰äºpeerçš„ä¸Šä¼ å¸¦å®½ã€‚ ä½†æ˜¯åœ¨ BitTorrent ä¸‹ï¼Œå¯¹äºä¸€ä¸ªéå¸¸ç«çˆ†çš„å·²ç»æœ‰å¾ˆå¤šäººä¸‹è½½å¥½çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŒæ—¶å‘ä»–ä»¬æ‰€æœ‰äººè¯·æ±‚æ–‡ä»¶å—ï¼Œå……åˆ†åˆ©ç”¨è‡ªå·±çš„ä¸‹è½½å¸¦å®½äº†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ BitTorrent ä¸€ç»æ¨å‡ºå°±ç»Ÿæ²»äº† p2p ä¸‹è½½ç•Œã€‚ æ¯”å¦‚ä¸Šé¢çš„æ–‡ä»¶ï¼Œæœ‰ 169 äººä¸Šä¼ ï¼Œåªæœ‰ 18 äººä¸‹è½½ï¼Œå¯æƒ³è€ŒçŸ¥ä¸‹è½½é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ BitTorrent çš„æ¶æ„ä¸­å«æœ‰å¦‚ä¸‹å®ä½“ï¼š ä¸€ä¸ªå…ƒä¿¡æ¯æ–‡ä»¶ï¼š torrent file ä¸€ä¸ªé›†ä¸­å¼ tracker ç¬¬ä¸€ä¸ªå‚ä¸è€…ï¼šseed å…¶ä»–å‚ä¸è€…ï¼šleecher tracker ä¼šè®°å½•å“ªäº› peer æ­£åœ¨ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶å¸®åŠ©ä»–ä»¬äº’ç›¸è®¤è¯†ã€‚peer é€šè¿‡ http åè®®å’Œ tracker è¿›è¡Œé€šä¿¡ï¼Œä»¥è·å–ç›¸å…³ä¿¡æ¯ã€‚ ä¸–ç•Œä¸Šæœ‰è®¸å¤šå…¬å¼€çš„ tracker æœåŠ¡å™¨ï¼Œæ¯”å¦‚è¿™ä¸ªåˆ—è¡¨é‡Œæ”¶å½•çš„ï¼štrackerlist åœ¨ä¸€å¼€å§‹ï¼Œä¸€ä¸ªç”¨æˆ·å†³å®šåˆ†å‘æŸä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šå…ˆåšç§ï¼ˆseedï¼‰ï¼šä»–ä¼šä½¿ç”¨æœ¬åœ°çš„btè½¯ä»¶ï¼ŒæŠŠæ–‡ä»¶åˆ†ä¸ºé€šå¸¸æ˜¯ 512 KB æˆ– 256Kb è®¸å¤šå°å—ï¼ˆpieceï¼‰ï¼Œå¹¶è®¡ç®—æ¯ä¸ªå°å—çš„ SHA-1 å“ˆå¸Œå€¼ ï¼Œç„¶åæŠŠæ‰€æœ‰çš„å“ˆå¸Œå€¼å’Œç›¸å…³å…ƒä¿¡æ¯å°è£…åœ¨ä¸€ä¸ª torrent æ–‡ä»¶é‡Œï¼Œä¼ ç»™åˆ«äººã€‚åŒæ—¶ä»–ä¹Ÿåœ¨ tracker å¤„ç™»è®°è‡ªå·±æŒæœ‰è¿™ä¸ªæ–‡ä»¶ã€‚ï¼ˆé€šå¸¸ torrent æ–‡ä»¶é‡Œä¹ŸåŒ…å«æ¨èçš„ trackerï¼‰ å½“æŸä¸ªç”¨æˆ·è¦ä¸‹è½½æ—¶ï¼Œä»–ä¼šå‘ tracker è¯·æ±‚ peer åˆ—è¡¨ï¼Œç„¶åå‘ peer ä»¬è¯·æ±‚ä¸åŒçš„æ–‡ä»¶å—ï¼Œå¹¶ç”¨ torrent æ–‡ä»¶é‡Œçš„å“ˆå¸Œå€¼éªŒè¯æ•°æ®æ˜¯å¦å‡ºé”™ã€‚ åœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼Œæœ‰ä¸¤ä¸ªç®—æ³•å†³å®šç€ bt ç½‘ç»œçš„æ­£å¸¸é«˜æ•ˆè¿è½¬ï¼š å†³å®šå…ˆå‘ peer è¯·æ±‚é‚£ä¸ªå—ï¼ˆThe Piece Selection Algorithmï¼‰ â€”â€” ä»¥è¾¾åˆ°æœ€å¤§ä¸‹è½½é€Ÿåº¦ å†³å®šæ˜¯å¦ç»™æŸä¸ª peer å‘é€æ•°æ®ï¼ˆResource Allocationï¼‰ â€”â€” ä»¥é¿å…æ‡’æ±‰ï¼ˆfree riderï¼‰ The Piece Selection Algorithm å¿«é€‰æ‹©ç®—æ³•çš„æ ¸å¿ƒç›®æ ‡æœ‰ä¸¤ä¸ªï¼š å°½å¿«åœ¨ä¸åŒ peer ä¸Šå¤åˆ¶ä¸åŒçš„å—ï¼ˆç¡®ä¿ä»»ä½•æ—¶åˆ»ç½‘ç»œä¸­æ€»èƒ½æ‹¼å‡‘å‡ºä¸€ä»½å®Œæ•´çš„æ–‡ä»¶ï¼‰ å°½å¿«ä¸‹è½½å®Œæˆæ–‡ä»¶ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:0:0","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"sub pieces BitTorrent peer ä¹‹é—´é€šè¿‡ TCP åè®®è¿›è¡Œè¿æ¥ï¼Œå› æ­¤éœ€è¦é¿å… TCP æ…¢å¯åŠ¨æœºåˆ¶ å¯¹ä¼ è¾“é€Ÿç‡çš„å½±å“ã€‚å—å¸¸å¸¸è¢«åˆ’åˆ†ä¸º 16kb å¤§å°çš„å­å—è¿›è¡Œä¼ è¾“ï¼ŒBitTorrent åè®®ä¿è¯å’Œä¸€ä¸ª peer ä¹‹é—´æ— è®ºä½•æ—¶æ€»æ˜¯æœ‰ä¸€äº› å­å— ç­‰å¾…è¢«ä¼ è¾“ï¼Œä»¥æ­¤æ¥ç»´æŒé«˜é€Ÿè¿æ¥ã€‚ä¸€ä¸ªå—çš„ä¸åŒå­å—å¯ä»¥ä»ä¸åŒçš„ peer å¤„ä¸‹è½½ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:0:1","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"policys strict policyï¼šæ¯å¼€å§‹ä¸‹è½½ä¸€ä¸ªå—æ—¶ï¼Œå°±ä¼˜å…ˆä¸‹è½½è¯¥å—çš„æ‰€æœ‰å­å—ã€‚ random first pieceï¼šåˆšå¼€å§‹ä¸‹è½½æ—¶ï¼Œä¸ºäº†å°½å¿«å¾—åˆ°èƒ½ç»™å…¶ä»– peer ä¸Šä¼ çš„å—ï¼Œå°±éšæœºé€‰æ‹©ä¸€ä¸ªå—è¿›è¡Œä¸‹è½½ã€‚ rarest firstï¼šä¼˜å…ˆä¸‹è½½ç½‘ç»œä¸­æœ€ç¨€æœ‰çš„å—ã€‚ endgame modeï¼šå½“åˆ°æœ€åä¸€å—æ—¶ï¼Œå‘æ‰€æœ‰ peer éƒ½è¯·æ±‚è¯¥å—çš„å­å—ï¼Œä»¥å¿«é€Ÿä¸‹è½½å®Œæ–‡ä»¶ã€‚ Resource Allocation Resource Alllocation ç®—æ³•ç”¨æ¥å†³å®šå’Œå“ªä¸ª peer è¿›è¡Œåˆä½œã€‚æˆ‘ä»¬é‡‡ç”¨â€œtit-for-tatâ€ ï¼ˆä»¥ç‰™è¿˜ç‰™ï¼‰ç­–ç•¥ï¼Œä»¥è¾¾åˆ°åˆ©ç›Šæœ€å¤§åŒ–ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä½ ä¸Šä¼ çš„è¶Šå¤šï¼Œä¸‹è½½çš„ä¹Ÿå°±è¶Šå¿«ã€‚ Enhancements è‡ªä» BitTorrent è¢«å‘æ˜ä»¥æ¥ï¼Œè®¸å¤š BEP æå‡ºäº†ä¸€äº›æ”¹è¿›ï¼Œä¸‹é¢ä»‹ç»ä¸€äº›æœ‰è¶£çš„æ”¹è¿›åŠŸèƒ½ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:0:2","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"Decentralized tracker youtubeè§†é¢‘ç®€ä»‹ BitTorrent ä¸­ï¼Œç”±äº tracker æœåŠ¡å™¨çš„å­˜åœ¨ï¼Œæ‰€ä»¥ä¸èƒ½è¾¾åˆ° â€œçœŸp2pâ€ï¼Œå› æ­¤å°±æœ‰äº† å»ä¸­å¿ƒåŒ–tracker æ‹“å±•ã€‚å®ƒåŸºäº DHT ï¼ˆDistributed hash tableï¼‰åœ¨ peer é—´å­˜å‚¨ peerlistï¼Œä»¥å–ä»£ä¸­å¿ƒåŒ– trackerã€‚ DHT çš„åŸºæœ¬æ€æƒ³ä¸ºï¼šå°†æ‰€æœ‰ node è¿æ¥æˆä¸€ä¸ªç¯ï¼Œç¯ä¸Šæ¯ä¸ª node éƒ½è´Ÿè´£å­˜å‚¨æŸä¸€èŒƒå›´å†…çš„ keyï¼Œä¸”çŸ¥é“ç›¸é‚» node çš„åœ°å€ã€‚æŸ¥è¯¢æ—¶æ²¿ç€ç¯å°±å¯ä»¥æ‰¾åˆ°ç›®æ ‡keyäº†ã€‚å½“æ·»åŠ æˆ–åˆ é™¤æ–° node æ—¶ï¼Œéƒ½è°ƒæ•´æ•°æ®åˆ†å¸ƒä»¥ä½¿å¾—ç¯ç»“æ„ä»ç„¶æˆç«‹ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:1:0","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"Upnp é—®é¢˜çš„èµ·å› æ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬çš„ btå®¢æˆ·ç«¯ å¤§éƒ½è¿è¡Œåœ¨å†…ç½‘ï¼Œå¯ä»¥é€šè¿‡è·¯ç”±å™¨çš„ NATæœºåˆ¶ è®¿é—®å¤–ç½‘ï¼Œå¯æ˜¯å¤–ç½‘è®¾å¤‡å°±è®¿é—®ä¸åˆ°æˆ‘ä»¬çš„ btå®¢æˆ·ç«¯ äº†ï¼Œè¿™å°±è®©å…¶ä»– peer æ²¡åŠæ³•ä¸»åŠ¨å’Œæˆ‘ä»¬å»ºç«‹è¿æ¥ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è·¯ç”±å™¨ä¸Šæ‰‹åŠ¨è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå½“ç„¶å‰ææ˜¯ä½ çš„è·¯ç”±å™¨å°±æ‹¥æœ‰å…¬ç½‘ IPï¼‰ï¼Œæˆ–è€…ä½¿ç”¨ VPNã€‚ Upnp ï¼ˆUniversal Plug and Playï¼‰æ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ï¼Œå¯ä»¥åœ¨è·¯ç”±å™¨ä¸Šå¼€å¯ï¼Œæ¥å—åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œè¿›è¡Œè‡ªåŠ¨ç«¯å£è½¬å‘ã€‚å…¶åŸæœ¬ç›®æ ‡æ˜¯ä¸ºäº†è®©è®¾å¤‡ä¹‹é—´æ— éœ€æ‰‹åŠ¨é…ç½®å°±èƒ½ç›¸äº’è¿æ¥ï¼Œä¸è¿‡è®¸å¤š btå®¢æˆ·ç«¯ ä¹Ÿå®ç°äº† Upnpåè®®ï¼Œå¯ä»¥å’Œè·¯ç”±å™¨åå•†è¿›è¡Œè‡ªåŠ¨ç«¯å£è½¬å‘ã€‚ä½†ç›®å‰ Upnpåè®® å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå¾ˆå®¹æ˜“æˆä¸ºé»‘å®¢æ”»å‡»çš„ç›®æ ‡ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:2:0","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"DDNS DDNS å³ åŠ¨æ€ï¼ˆdynamicï¼‰DNSæœåŠ¡ã€‚å¦‚æœæœºå™¨æ¯æ¬¡å¯åŠ¨éƒ½æ˜¯ä¸åŒçš„ IPï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ DDNS æœåŠ¡ï¼Œåœ¨æœºå™¨æ¯æ¬¡å¯åŠ¨æ—¶éƒ½å‘ DDNS æœåŠ¡å™¨å‘ŠçŸ¥æ–° IPã€‚è¿™é€‚ç”¨äºå½“ä½ çš„è·¯ç”±å™¨è¢«è¿è¥å•†åˆ†é…åŠ¨æ€å…¬ç½‘ IP æ—¶ï¼Œä¹Ÿèƒ½å¯¹å¤–ç•Œæä¾›ä¸€ä¸ªç¨³å®šçš„åœ°å€ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:3:0","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":"å†…ç½‘ç©¿é€ ä½†å½“è·¯ç”±å™¨æœ¬èº«å°±è¢«è¿è¥å•†åˆ†é…äº†å±€åŸŸç½‘ IP æ—¶ï¼Œå°±åªèƒ½é€šè¿‡å†…ç½‘ç©¿é€æ‰èƒ½ä½¿æˆ‘ä»¬çš„ btå®¢æˆ·ç«¯ æš´éœ²åœ¨å…¬ç½‘ä¸­ï¼Œæ¥å—å…¶ä»– peer çš„è¯·æ±‚äº†ã€‚å†…ç½‘ç©¿é€å³æ˜¯é€šè¿‡å¤–ç½‘ä¸­æŒæœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨æä¾›çš„ä¸­ä»‹æœåŠ¡ï¼Œæ¥æš´éœ²æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼ˆç›¸å½“äºç®€åŒ–ç‰ˆ VPNï¼‰ã€‚ ","date":"2024-11-16","objectID":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/:4:0","tags":["BitTorrent","Knowledge"],"title":"BitTorrentåè®®åŠå…¶æ‰©å±•","uri":"/posts/bittorrent%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"},{"categories":["System"],"content":" çºµæ¨ªè®¡ä¸å°±ï¼Œæ…·æ…¨å¿—çŠ¹å­˜ ä»Šå¹´5æœˆåˆ°8æœˆé—´å‚åŠ äº† CSCC ä¸¾åŠçš„ç¼–è¯‘ç³»ç»Ÿè®¾è®¡èµ›ï¼Œä½†å®é™…ä¸Šé›†ä¸­å¼€å‘ä¹Ÿå°±æ˜¯7æœˆã€‚å°½ç®¡è¾¾æˆäº†æœ€åˆçš„ç›®æ ‡â€”â€”â€œå­¦ä¹ ç¼–è¯‘å™¨åç«¯çŸ¥è¯†â€ä¸â€œæ‰¾å›å†™ä»£ç çš„æ„Ÿè§‰â€ï¼Œä½†æœ€åçš„åæ¬¡å´ä¸å°½äººæ„ã€‚è™½ç„¶æ¯”èµ›8æœˆæ—©å·²ç»“æŸï¼Œè¿‘æ—¥å†™æ€»ç»“ä¹Ÿä¸ç®—ä¸ºæ™šï¼ˆæ€»è¿˜æœªå®Œå…¨å¿˜è®°ï¼‰ã€‚ æˆ‘ä»¬çš„ç¼–è¯‘å™¨å®ç° ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:0:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"å‰ç«¯ ä½¿ç”¨antlr4ç”Ÿæˆlexerå’Œparserï¼Œæ„å»ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚ é‡‡ç”¨è®¿é—®è€…æ¨¡å¼éå†ASTï¼Œæ„å»ºä¸­é—´ä»£ç ï¼ˆIRï¼‰ã€‚ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:1:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"ä¸­ç«¯ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:2:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"IRè®¾è®¡ IRç»“æ„è®¾è®¡å‚è€ƒäº†LLVM IRçš„è®¾è®¡ï¼ŒåŸºæœ¬ç»„ä»¶åŒ…æ‹¬ï¼š Module: Moduleæ˜¯IRçš„é¡¶çº§å®¹å™¨ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„ç¨‹åºæˆ–ç¿»è¯‘å•å…ƒã€‚å®ƒåŒ…å«å‡½æ•°ã€å…¨å±€å˜é‡å’Œç›¸å…³çš„å…ƒæ•°æ®ã€‚ Function: Functionè¡¨ç¤ºç¨‹åºä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”±ä¸€ç³»åˆ—åŸºæœ¬å—ï¼ˆBasicBlockï¼‰ç»„æˆã€‚æ¯ä¸ªå‡½æ•°åœ¨Moduleä¸­å”¯ä¸€æ ‡è¯†ã€‚ BasicBlock: BasicBlockæ˜¯IRä¸­çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œç”±ä¸€ç³»åˆ—æŒ‡ä»¤ç»„æˆã€‚æ¯ä¸ªåŸºæœ¬å—ä»¥ç»ˆç»“æŒ‡ä»¤ï¼ˆå¦‚bræˆ–retï¼‰ç»“æŸï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸åŒ…å«æ§åˆ¶æµè·³è½¬ã€‚ Instruction: Instructionæ˜¯IRä¸­çš„æ“ä½œæŒ‡ä»¤ï¼Œç±»ä¼¼äºæœºå™¨æŒ‡ä»¤ã€‚æ¯ä¸ªæŒ‡ä»¤å¯ä»¥äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¹¶ä½œä¸ºå…¶ä»–æŒ‡ä»¤çš„æ“ä½œæ•°ã€‚å¸¸è§æŒ‡ä»¤åŒ…æ‹¬ç®—æœ¯è¿ç®—ï¼ˆå¦‚addã€subï¼‰ã€å†…å­˜è®¿é—®ï¼ˆå¦‚loadã€storeï¼‰å’Œæ§åˆ¶æµæŒ‡ä»¤ï¼ˆå¦‚brã€retï¼‰ã€‚ Value: Valueæ˜¯IRä¸­çš„æ•°æ®è¡¨ç¤ºï¼ŒåŒ…æ‹¬å˜é‡ã€å¸¸é‡å’ŒæŒ‡ä»¤çš„ç»“æœã€‚æ‰€æœ‰çš„Instructionå’ŒConstantéƒ½æ˜¯Valueçš„å­ç±»ã€‚ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:2:1","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"IRä¼˜åŒ– ä¸­ç«¯å®ç°äº†å„ç±»ä¼˜åŒ–ï¼Œæå‡äº†ä»£ç æ€§èƒ½ã€‚å®ç°çš„ä¼˜åŒ–åŒ…æ‹¬ï¼š MemToReg: å®ç°å¯„å­˜å™¨æå‡ï¼ˆPromote Memory to Registerï¼‰ï¼Œå‡å°‘å†…å­˜è®¿é—®ã€‚ CommonSubexpElimination: æ¶ˆé™¤å…¬å…±å­è¡¨è¾¾å¼ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚ MergeBlock: åˆå¹¶åŸºæœ¬å—ä»¥ç®€åŒ–æ§åˆ¶æµå›¾ã€‚ Inlining: å‡½æ•°å†…è”ï¼Œå‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ã€‚ LoopSimplify: ç®€åŒ–å¾ªç¯ç»“æ„ã€‚ LoopInvariantCodeMotion: å¾ªç¯ä¸å˜ä»£ç å¤–æã€‚ GlobalCodeMotion: å…¨å±€ä»£ç ç§»åŠ¨ã€‚ GlobalValueNumbering: å…¨å±€å€¼ç¼–å·ï¼Œä¼˜åŒ–å†—ä½™è®¡ç®—ã€‚ LoopUnroll: å¾ªç¯å±•å¼€ï¼Œæé«˜æ€§èƒ½ã€‚ TailRecursionElimination: æ¶ˆé™¤å°¾é€’å½’ã€‚ DeadCodeElimination: æ­»ä»£ç æ¶ˆé™¤ã€‚ ConstantFolding: å¸¸é‡æŠ˜å ï¼Œè®¡ç®—å¸¸é‡è¡¨è¾¾å¼ã€‚ GlobalVariableLocalize: å…¨å±€å˜é‡æœ¬åœ°åŒ–ï¼Œå‡å°‘å…¨å±€å˜é‡ä½¿ç”¨ã€‚ StrengthReduction: å¼ºåº¦å‰Šå‡ï¼Œç”¨æ›´ä½ä»£ä»·è¿ç®—ä»£æ›¿é«˜ä»£ä»·è¿ç®—ã€‚ LoadElimination: åŠ è½½æ¶ˆé™¤ï¼Œå‡å°‘ä¸å¿…è¦çš„å†…å­˜åŠ è½½ã€‚ Reassociate: é‡ç»“åˆè¿ç®—ã€‚ GEPSimplify: ç®€åŒ–GEPæŒ‡ä»¤ã€‚ CFGSimplify: æ§åˆ¶æµå›¾ç®€åŒ–ã€‚ StoreElimination.cc: å­˜å‚¨æ¶ˆé™¤ï¼Œå‡å°‘ä¸å¿…è¦çš„å†…å­˜å­˜å‚¨ã€‚ LruCache.cc: ç¼“å­˜é€’å½’çº¯å‡½æ•°çš„ç»“æœï¼Œé¿å…å†—ä½™å‡½æ•°è°ƒç”¨ã€‚ InductionVariableSimplify.cc: ç®€åŒ–å½’çº³å˜é‡ã€‚ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:2:2","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"åç«¯ Instruction Seletction: å°†ä¸­é—´ä»£ç è½¬æ¢ä¸ºé¢å‘ç›®æ ‡æœºå™¨çš„ä½å±‚IRã€‚ Register Allocation: é‡‡ç”¨SSAåˆ†é…ç®—æ³•ï¼Œå…ˆæº¢å‡ºä»¥å‡å°å¯„å­˜å™¨å‹åŠ›ï¼Œå†å¯¹å¯„å­˜å™¨è¿›è¡Œç€è‰²ã€‚ Peephole Optimization: å®æ–½ä¸€ç³»åˆ—å°è§„æ¨¡çš„ä»£ç ä¼˜åŒ–ï¼Œå¦‚æŒ‡ä»¤åˆå¹¶å’Œæ¶ˆé™¤å†—ä½™æŒ‡ä»¤ã€‚ Instruction Scheduling: é‡‡ç”¨ Local List Scheduling ç®—æ³•ï¼Œè¿›è¡Œç®€å•çš„æŒ‡ä»¤é‡æ’ï¼Œå¹¶é’ˆå¯¹ SIFive u74 çš„åŒå‘å°„ç‰¹æ€§è¿›è¡Œäº†ä¼˜åŒ–ã€‚ Branch Simplification: å®æ–½å’Œæ§åˆ¶æµç›¸å…³çš„ä¸€äº›ä¼˜åŒ–ï¼Œå¦‚æ¶ˆé™¤å†—ä½™è·³è½¬æŒ‡ä»¤ï¼ŒåŸºæœ¬å—æ’åºã€‚ å¼€å‘çš„æµç¨‹ä¸æ€è·¯ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:3:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"ç†æƒ³ vs ç°å® æœ€ä¸€å¼€å§‹ç¡®å®šçš„å¼€å‘åŸåˆ™æœ‰ä¸¤æ¡ï¼š æ¸è¿›å¼å¼€å‘ æµ‹è¯•é©±åŠ¨å¼€å‘ æ¸è¿›å¼å¼€å‘ ä¸»è¦æŒ‡å…ˆå®ç° Sysy çš„ä¸€ä¸ªå¯å·¥ä½œå­é›†ï¼Œç„¶åå†ä¸æ–­æ‰©å……åŠŸèƒ½ï¼Œç›´åˆ°å®ç°å®Œæ•´çš„ Sysy è¯­è¨€ã€‚åœ¨æ­¤ä¹‹åæ…¢æ…¢å¢åŠ å„ç§ä¼˜åŒ–ã€‚ è¿™æ ·åšçš„å¥½å¤„æœ‰ï¼š åœ¨å¤§éƒ¨åˆ†æ—¶é—´éƒ½æœ‰ä¸€ä¸ªå¯ä»¥æ­£å¸¸è¿ä½œçš„ç¼–è¯‘å™¨ï¼Œå¯ä»¥å¢å¼ºå¼€å‘è€…ä¿¡å¿ƒ æ¯æ¬¡å®ç°ä¸€å°éƒ¨åˆ†åŠŸèƒ½ï¼Œæ–¹ä¾¿å®ç°å’Œæµ‹è¯• æ­¤å¤–å°±æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œæ„æ€æ˜¯æ¯å½“å®ç°ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œå…ˆå†™å¥½æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åè¿›è¡Œå¼€å‘ã€‚ è¿™æ ·åšçš„å¥½å¤„æœ‰ï¼š å¼€å‘æ—¶æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼Œå¢å¼ºåŠ¨åŠ› æ¯ä¸€éƒ¨åˆ†ä»£ç éƒ½æœ‰æµ‹è¯•ï¼Œä¿è¯ä»£ç çš„æ­£ç¡®æ€§ åŒæ—¶ç¼–è¯‘å™¨åˆå¯ä»¥åˆ†ä¸ºå‰ç«¯ï¼Œä¸­ç«¯å’Œåç«¯ä¸‰ä¸ªéƒ¨åˆ†ã€‚ æœ€åˆçš„è®¡åˆ’æ˜¯å°ç»„å››åæˆå‘˜ï¼Œä¸€äººè´Ÿè´£å‰ç«¯å®ç°ï¼Œä¸¤äººè´Ÿè´£ä¸­ç«¯æ¡†æ¶å®ç°ï¼Œä¸€äººè´Ÿè´£åç«¯æ¡†æ¶ä»¥åŠæ— ä¼˜åŒ–ä¸‹çš„ç¿»è¯‘å®ç°ã€‚åœ¨åŸºæœ¬æ¡†æ¶å®ç°å®Œæˆåè¿›è¡Œè°ƒè¯•ï¼Œå¾—åˆ°ä¸€ä¸ªæœ€ç®€å•çš„æ— ä¼˜åŒ–ç¼–è¯‘å™¨ã€‚ä¹‹åå†åšè¿›ä¸€æ­¥è®¡åˆ’ï¼Œæ¸è¿›å¼ä¸æ–­å¢åŠ æ–°çš„ä¼˜åŒ–passã€‚ ç„¶è€Œè¿™ä¸ªè®¡åˆ’å´æ²¡æœ‰æˆåŠŸâ€”â€”æˆ‘ä»¬å‰åä¸­ä¸‰ç«¯å„è‡ªå®ç°äº†ä¸€ä¸ªæœˆï¼Œæ‰åˆ†åˆ«å®ç°å¥½ï¼Œæœ€åä¸€èµ·debugåä½™å¤©åå°±åˆ°ddläº†â€¦ ç©¶å…¶åŸå› ï¼Œæ˜¯å‰ç«¯æˆä¸ºäº†æˆ‘ä»¬çš„å¼€å‘ç“¶é¢ˆã€‚åœ¨åç«¯å’Œä¸­ç«¯å¼€å‘å®Œæˆåï¼Œå‰ç«¯ä¾ç„¶ä¸èƒ½æ­£å¸¸è¿è¡Œï¼Œä»¥è‡³äºä¸­åç«¯bugæ— æ³•åŠæ—¶æš´éœ²å’Œä¿®å¤ã€‚å¦‚æœæ²¡æœ‰å‰ç«¯ï¼Œä¸­åç«¯æµ‹è¯•æ—¶åªèƒ½é€šè¿‡ç›´æ¥è°ƒç”¨APIæ„é€ IRæµ‹è¯•ç”¨ä¾‹ï¼Œä½†è¿™åˆè¿‡äºç¹çï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥å†å®ç°ä¸€ä¸ª IR parserï¼Œè¿™å°±æ›´éº»çƒ¦äº†ï¼Œæ›´ä½•å†µæœ‰è®¸å¤šç°æˆçš„ Sysy è¯­è¨€æµ‹ä¾‹å¯ä»¥åˆ©ç”¨ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©ç­‰å¾…å‰ç«¯å®Œæˆåå†debugï¼Œåœ¨è¿™æ®µæ—¶é—´æŠ“ç´§æ—¶é—´å®ç°ä¸€äº›ä¼˜åŒ– passã€‚ä½†ç­‰åˆ°å‰ç«¯å®ç°å®Œæˆæ—¶ï¼Œä¸­åç«¯ä¹Ÿå·²ç»ç§¯ç´¯äº†éå¸¸å¤šçš„bugï¼Œæœ€åå¤§æŠŠæ—¶é—´éƒ½èŠ±åœ¨äº†debugä¸Šâ€¦ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:4:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"é™·å…¥debugå›°å¢ƒçš„åŸå›  é€ æˆè¿™æ ·ç¾éš¾æ€§åæœçš„åŸå› ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š ç¬¬ä¸€ï¼Œå¼€å‘è§„åˆ’ä¸æ˜ç¡®ã€‚ åœ¨ä¸€å¼€å§‹æˆ‘è®¤ä¸ºå‰ç«¯è¾ƒä¸ºç®€å•ï¼Œèƒ½åœ¨çŸ­æ—¶é—´å†…å®ç°å®Œæ•´çš„ Sysy parserï¼Œè€Œä¸­ç«¯åªæ˜¯ä»¿ç…§ LLVM å®ç°ï¼Œå¹¶ä¸å¤æ‚ï¼ˆè€Œä¸”ä¸­å‰ç«¯çš„è®¸å¤šçŸ¥è¯†åœ¨æœ¬é™¢è¯¾ç¨‹ä¸­éƒ½å·²ç»å­¦è¿‡ï¼‰ã€‚æ‰€ä»¥å®ç°ä¸€ä¸ªå¯ä»¥ work çš„æ— ä¼˜åŒ–ç¼–è¯‘å™¨åº”è¯¥å¹¶ä¸å›°éš¾ã€‚ å¯æ˜¯å½“å‰ç«¯æ˜æ˜¾æš´éœ²å‡ºçŸ­æ¿æ—¶ï¼Œæˆ‘æ‰æ„è¯†åˆ°ç›´æ¥å®ç°ä¸€ä¸ªå®Œæ•´å‰ç«¯çš„å·¥ä½œé‡è¾ƒå¤§ï¼Œä¹Ÿè®¸å…ˆå®ç°ä¸€ä¸ª Sysy çš„å­é›†æ˜¯æ›´åˆç†çš„ã€‚äºæ˜¯æˆ‘å‘Šè¯‰å‰ç«¯å¼€å‘åŒå­¦ï¼Œâ€œåªè¦å…ˆå®ç° Sysy çš„ä¸€ä¸ªå­é›†â€ï¼Œâ€œèƒ½å…ˆè·‘èµ·æ¥å°±å¥½â€ã€‚å¯æ˜¯å½“æ—¶çš„æˆ‘å´å¹¶æ²¡æœ‰ æ˜ç¡®è§„å®š Sysy çš„å“ªä¸ªå­é›†ï¼Ÿå¦‚æœæˆ‘ä¸å»æ˜ç¡®è§„å®šåˆ’åˆ†ï¼Œå‰ç«¯å¯èƒ½ä¹Ÿä¸çŸ¥é“å¦‚ä½•é€‰å–ä¸€ä¸ªæ˜“äºå®ç°çš„å­é›†â€”â€”å¦‚æœå‰ç«¯æœ‰é€‰å–æ˜“äºå®ç°å­é›†çš„èƒ½åŠ›ï¼Œé‚£ä¹ˆæ˜¾ç„¶ä»–ä¹Ÿèƒ½åœ¨çŸ­æ—¶é—´å†…å®ç°å®Œæ•´ä¸ªå‰ç«¯ã€‚æ‰€ä»¥ï¼Œå‰ç«¯å¼€å‘åŒå­¦æœ€åè¿˜æ˜¯èŠ±äº†ä¸€ä¸ªæœˆæ—¶é—´ï¼Œå®ç°äº†ä¸€ä¸ªå……æ»¡ bug çš„å®Œæ•´å‰ç«¯ã€‚ ç¬¬äºŒï¼Œæµ‹è¯•çš„åŸºç¡€è®¾æ–½ä¸å®Œå–„ã€‚ å…¶æ¬¡æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ï¼šåœ¨å‰ç«¯é‡åˆ°ç“¶é¢ˆæ—¶ï¼Œä¸­ç«¯å’Œåç«¯ä»ç„¶ä¸ç®¡ä¸é¡¾è’™å¤´å¼€å‘ã€‚å¯æ˜¯ç°åœ¨å›æƒ³ä¸€ä¸‹ï¼Œå°½ç®¡æ²¡æœ‰å‰ç«¯ä¸èƒ½è¿›è¡Œç³»ç»Ÿæµ‹è¯•ï¼Œä½†æ˜¯å¯¹éƒ¨åˆ†å‡½æ•°è¿›è¡Œå•å…ƒæµ‹è¯•æ€»æ˜¯å¯ä»¥çš„ã€‚å®é™…ä¸Šæˆ‘åœ¨ç¼–å†™ä»£ç æ—¶ä¹Ÿå¯¹éƒ¨åˆ†å‡½æ•°æ„Ÿåˆ°ä¸æ”¾å¿ƒï¼Œä½†è¿˜æ˜¯å†³å®šå…ˆæŠŠé—®é¢˜æ”¾ç€ï¼Œç­‰åˆ°é›†æˆæµ‹è¯•æ—¶å† debug â€”â€”æœ€åçš„é›†æˆæµ‹è¯•æ—¶å°±æˆäº†ä¸€åœºç¾éš¾ã€‚å®é™…ä¸Šï¼Œc++è™½ç„¶æ²¡æœ‰ rust é‚£ä¹ˆæ–¹ä¾¿åšå•å…ƒæµ‹è¯•ï¼Œä½†æ˜¯ä¹Ÿæœ‰ Google test ç­‰æ¡†æ¶æ¥å¸®å¿™ã€‚åœ¨å‰ç«¯è¿Ÿè¿Ÿæ²¡æœ‰å®Œæˆçš„æƒ…å†µä¸‹ï¼Œå•å…ƒæµ‹è¯•å°±æ›´ä¸ºå¿…è¦äº†ã€‚ ç¬¬ä¸‰ï¼Œå‡ºç°é—®é¢˜æ—¶æ²¡æœ‰åŠæ—¶è°ƒæ•´åˆ†å·¥ã€‚ åœ¨å‰ç«¯é‡åˆ°ç“¶é¢ˆæ—¶ï¼Œå½“æ—¶æ›´ä¼˜çš„è§£å†³æ–¹æ³•å…¶å®åº”è¯¥æ˜¯è®©åç«¯å’Œä¸­ç«¯çš„åŒå­¦å»ååŠ©å‰ç«¯ï¼Œè€Œä¸æ˜¯è®©ä»–ä»¬ä»ç„¶å¼€å‘å„è‡ªæ¨¡å—ã€‚ä½†æ˜¯å› ä¸ºå‰ç«¯åŒå­¦æ€»æ˜¯æ‰¿è¯ºé©¬ä¸Šå°±è¦åšå®Œäº†ï¼ˆå®é™…ä¸Šå´ä¸€æ‹–å†æ‹–ï¼‰ï¼Œä¸€ç›´åˆ°20ä½™å¤©åä¸­ç«¯å¼€å‘åŒå­¦æ‰å»å¸®å¿™å®ç°ã€‚æ‰¿è¯ºå¾€å¾€æ˜¯ä¸å¯é çš„ï¼Œè¿›è¡Œè®¡åˆ’è°ƒæ•´æ—¶å…¶å®åº”è¯¥æ›´é‡è§†è¿‡å¾€ç»éªŒï¼Œè€Œéå¼€å‘äººå‘˜çš„å£å¤´æ‰¿è¯ºã€‚ ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:5:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"äº®ç‚¹ä¸å……åˆ†çš„åŸå›  è¿™é‡Œçš„äº®ç‚¹æŒ‡æˆ‘ä»¬åœ¨æ¯”èµ›ä¸­ä¸å…¶ä»–é˜Ÿä¼ç›¸æ¯”ï¼Œè¾ƒä¸ºäº®çœ¼çš„éƒ¨åˆ†ã€‚å½“ç„¶ï¼Œæœ€åå°±æˆç»©æ¥çœ‹ï¼Œä¹Ÿå¹¶æ²¡æœ‰ä»€ä¹ˆéå¸¸äº®çœ¼ä¹‹å¤„äº†ã€‚ å¤§éƒ¨åˆ†ç»„çš„äº®ç‚¹åŸºæœ¬å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š å‡ºè‰²ï¼Œå®Œå¤‡çš„ä»£ç  å®ç°äº†å¥½çš„ç®—æ³• ä¼˜ç§€çš„åŸºç¡€è®¾æ–½ å› ä¸ºèµ¶å·¥ï¼ŒåŸºæœ¬å°±ä¸æ±‚ åŸºç¡€è®¾æ–½ å’Œ ä»£ç è´¨é‡ â€¦ å¯èƒ½å”¯ä¸€å€¼å¾—ä¸€æçš„æ˜¯ç®—æ³•ã€‚ ä¸­ç«¯å‚è€ƒäº†å¾€å¹´ä»£ç ï¼Œå®ç°äº†å¤§éƒ¨åˆ†çš„å¸¸è§ä¼˜åŒ–ã€‚åç«¯åœ¨å¯„å­˜å™¨åˆ†é…æ—¶ä½¿ç”¨äº†åŸºäºå¼¦å›¾çš„SSAåˆ†é…ç®—æ³•ï¼Œå¹¶ä¸”é’ˆå¯¹ç¡¬ä»¶åšäº†ç®€å•çš„ Instruction Schedulingã€‚ä¸è¿‡SSAåˆ†é…ç®—æ³•å¸¦æ¥çš„æ€§èƒ½æå‡å¹¶ä¸å¤§ï¼ˆå®ç°ä¸Šä¹Ÿç•¥æœ‰ç²—åˆ¶æ»¥é€ ä¹‹å¤„ï¼‰ï¼ŒæŒ‡ä»¤é‡æ’ä¹Ÿæ˜¯åæœŸä¸´æ—¶æ·»åŠ ï¼Œæå‡æ•ˆæœéå¸¸æœ‰é™ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå› ä¸ºä¸­åç«¯ä¼˜åŒ–å®ç°çš„éƒ½æ¯”è¾ƒå®Œå…¨,åœ¨åˆèµ›æ—¶ä¹Ÿæœ‰ä¸€ä¸ªä¸é”™çš„æˆç»©ã€‚ ä½†8æœˆå› ä¸ºç§ç§äº‹æƒ…ï¼Œåœ¨å†³èµ›ä»¥åŠä¹‹å‰å¹¶æ²¡æœ‰åšå¤šå°‘æ–°çš„ä¼˜åŒ–ï¼Œè€Œå…¶ä»–ç»„è¿™æœŸé—´å¤§éƒ½åœ¨ä¸­ç«¯åšäº†è®¸å¤šæ¿€è¿›çš„ä¼˜åŒ–ï¼šå¦‚å‡½æ•°è®°å¿†åŒ–ï¼Œæ•°ç»„è®¿é—®ä¼˜åŒ–ï¼Œä»¥åŠä¸€äº›é’ˆå¯¹ç‰¹æ®Šç”¨ä¾‹çš„ä¼˜åŒ–ã€‚ æœ€åä¹Ÿå¾—çŸ¥ï¼Œè®¸å¤šé˜Ÿä¼éƒ½å‚ç…§äº†å¾€å¹´ä»£ç ï¼ˆè¿™ä¹Ÿå°±æ˜¯æ¯”èµ›ä¸ºä»€ä¹ˆä¸€å¹´æ¯”ä¸€å¹´å·çš„åŸå› ï¼‰ï¼Œå› æ­¤ä»–ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼š å®ç°å¾€å¹´ç¬¬ä¸€åå®ç°è¿‡çš„æ‰€æœ‰ä¼˜åŒ– åœ¨æ­¤åŸºç¡€ä¸Šå†å¯»æ‰¾æ–°çš„ä¼˜åŒ–å¯èƒ½ è€Œæˆ‘ä»¬ç»„å°±åå‘äºè’™å¤´å†™ä»£ç ï¼Œæƒ³åˆ°ä»€ä¹ˆå†™ä»€ä¹ˆäº†ã€‚ è¿™é‡Œçš„æ•™è®­æ—¶ï¼šå¦‚æœå¯¹äºåæ¬¡è¿˜æ˜¯æ¯”è¾ƒåœ¨æ„ï¼Œæ¯”èµ›å¼€å§‹æ—¶å°±åº”è¯¥æ—©æ—©æœé›†ä¿¡æ¯ï¼Œæ˜ç¡®ç›®æ ‡ã€‚ å›¢é˜Ÿç®¡ç†çš„æ€»ç»“ å¼€å‘å‡ºç°é—®é¢˜çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯å›¢é˜Ÿç®¡ç†æ²¡æœ‰åšå¥½ã€‚è™½ç„¶æ˜¯å››ä¸ªäººçš„å°ç»„ï¼Œä½†å¤§éƒ¨åˆ†å·¥ä½œå´ç”±ä¸¤ä¸ªäººå®Œæˆã€‚å¯ä»¥é¢„æƒ³ï¼Œå¦‚æœåªæœ‰ä¸¤ä¸ªäººï¼Œå¼€å‘æ•ˆç‡åè€Œä¼šæ›´é«˜ã€‚æˆ–è®¸ï¼Œåœ¨å¼€å§‹æ—¶åº”è¯¥å¤šäº†è§£ä¸€äº›å›¢é˜Ÿç®¡ç†çš„æŠ€å·§çš„â€¦ æœ€ä¸€å¼€å§‹äººä»¬ç»“æˆå›¢é˜Ÿï¼Œè‚¯å®šæ˜¯æ‹¥æœ‰å…±åŒçš„ç›®æ ‡ã€‚æˆ‘ä»¬ç»è¿‡åˆ©ç›Šæƒè¡¡åé€‰æ‹©åŠ å…¥å›¢é˜Ÿï¼Œä»¥ä½¿å¾—è‡ªå·±çš„åˆ©ç›Šæœ€å¤§åŒ–ã€‚å¯æ˜¯åŠ å…¥å›¢é˜Ÿåï¼Œå´å¾€å¾€ä¸¢å¤±äº†ä¸»åŠ¨æ€§ï¼Œå¼€å§‹å˜å¾—ä¾èµ–ç®¡ç†è€…ï¼Œå¹¶å› ä¸ºå„ç§çäº‹è€Œæ¨è„±å›¢é˜Ÿäº‹ç‰©ã€‚ç»å¸¸ï¼Œåªæœ‰ç®¡ç†è€…æ‰ä¸€ç›´æŠŠå›¢é˜Ÿçš„åˆ©ç›Šæ”¾åœ¨å¿ƒç†ï¼ˆè¿™æ˜¯æˆ‘åœ¨å‡ æ¬¡åˆä½œä¸­çš„ä½“ä¼šï¼‰ã€‚ä¹Ÿè®¸è¿™ä¹Ÿå’Œä¸åŒæ–‡åŒ–æœ‰å…³ï¼Œå¦‚ã€Œæ–‡åŒ–ä¸ç»„ç»‡ã€è¿™æœ¬ä¹¦é‡Œè¯´çš„ï¼Œåäººåœ¨å›¢é˜Ÿåˆä½œä¸­å¾€å¾€ä¹ æƒ¯äºé›†æƒï¼Œç®¡ç†è€…å¾€å¾€å…·æœ‰æ›´å¤§æƒåŠ›ï¼Œä½†ç›¸åº”çš„ï¼Œæˆå‘˜ä¹Ÿä¼šæ›´ç¼ºä¹â€œä¸»äººç¿æ„è¯†â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®¡ç†è€…æ­£ç¡®è¿ç”¨è‡ªå·±çš„â€œæƒåŠ›â€ï¼Œåšå‡ºæ›´å¥½åœ°å†³ç­–å°±æ›´ä¸ºé‡è¦äº†ï¼Œåœ¨é€‚å½“æ—¶å€™ï¼Œä¸å¦¨æœæ–­ä¸€äº›â€¦ æˆ‘åœ¨å›¢é˜Ÿåˆä½œä¸­æ„Ÿå—åˆ°çš„é—®é¢˜æœ‰ï¼š ä¿¡æ¯äº¤æµä¸è¶³ å‡ ä¸ªé™Œç”Ÿäººç»„é˜Ÿï¼Œå¾ˆå®¹æ˜“é™·å…¥å°´å°¬çŠ¶æ€ï¼Œä¸èƒ½å……åˆ†è®¨è®ºï¼Œåšé‡‡ä¼—é•¿ã€‚ æ­¤æ—¶å°±éœ€è¦ç®¡ç†è€…ç ´å†°ï¼Œä¸»åŠ¨å¬å¼€ä¼šè®®ï¼Œå®¢è§‚åˆ†æç°çŠ¶ï¼Œè®©æ¯ä¸ªéƒ½å‘è¨€ï¼Œéƒ½èƒ½æœ‰å‚ä¸æ„Ÿ è¿™æ ·ç»è¿‡å……åˆ†è®¨è®ºåšå‡ºçš„å†³ç­–ï¼Œæ¯ä¸ªäººä¹Ÿæ›´è®¤åŒ åŠ¨æœºä¸è¶³ å·æ‡’æ˜¯äººçš„å¤©æ€§â€¦ å°¤å…¶æ˜¯æˆå‘˜ï¼Œå¦‚æœç®¡ç†è€…æ²¡æœ‰åˆ†é…ä»»åŠ¡ï¼Œæ˜ç¡®ç›®æ ‡ï¼Œå°±å¾ˆå®¹æ˜“å·æ‡’ æ‰€ä»¥å°±éœ€è¦ç®¡ç†è€…ä¸»åŠ¨ç»™æ¯ä¸ªäººåˆ†é…æœ‰æ˜ç¡®éªŒæ”¶æ ‡å‡†çš„ä»»åŠ¡ï¼Œå¹¶ç¡®å®šDDL éš¾ä»¥å†³ç­– å¯èƒ½å› ä¸ºåäººæ–‡åŒ–çš„ç‰¹ç‚¹ï¼Œå¤§å®¶éƒ½ä¹ æƒ¯äºå¬ä»ç®¡ç†è€…çš„å‘½ä»¤ï¼Œä¸æ„¿æ„ä¸»åŠ¨æå‡ºè‡ªå·±æƒ³æ³• æ­¤æ—¶å†³ç­–å°±éœ€è¦ç®¡ç†è€…æ›´è‡ªä¿¡ä¸€ç‚¹ï¼Œå»ä¸€é”¤å®šéŸ³äº† è™½ç„¶å¤§å®¶æ²¡æœ‰æ˜ç¡®æå‡ºè‡ªå·±æ„è§ï¼Œä½†æ˜¯ä»–ä»¬è®¤åŒå†³ç­–ä¸å¦å¯ä»¥é€šè¿‡æ‰§è¡Œå†³ç­–æ˜¯å¦ç§¯ææ¥åˆ¤æ–­ ä½†å‘ç°å¤§å®¶çš„åŠ¨åŠ›ä¸è¶³æ—¶ï¼Œåº”è¯¥ä¸»åŠ¨äº†è§£åŸå› ï¼Œè°ƒæ•´å†³ç­– åç«¯çŸ¥è¯†å­¦ä¹ ç»éªŒ æˆ‘ä¸»è¦è´Ÿè´£åç«¯çš„å®ç°ã€‚å› ä¸ºä¹‹å‰å¯¹äºç¼–è¯‘å™¨åç«¯äº†è§£è¾ƒå°‘ï¼Œå®ç°æ—¶ä¹Ÿåœ¨çŸ­æ—¶é—´å†…å­¦ä¹ äº†å¤§é‡æ–°çŸ¥è¯†ã€‚ åœ¨å­¦ä¹ æ–°çŸ¥è¯†æ—¶ï¼Œå¾€å¾€ä¼šé‡åˆ°è®¸å¤šå›°éš¾ã€‚æ¯”å¦‚åœ¨å­¦ä¹ æŸä¸ªå¯„å­˜å™¨åˆ†é…ç®—æ³•æ—¶ï¼Œæˆ‘ä¼šå…ˆå»çœ‹çœ‹ä¸€äº›ç»å…¸çš„å¤§éƒ¨å¤´æ•™ç§‘ä¹¦ï¼Œæå‡ºç®—æ³•çš„ paperï¼Œä»¥åŠç›¸å…³è¯¾ç¨‹çš„slideï¼Œæˆ–è€… youtube ä¸Šçš„è®²è§£è§†é¢‘ï¼Œæœ€åæ˜¯ä¸€äº›ç¨‹åºå‘˜çš„åšå®¢ï¼Œä¸­æ–‡æ‰€å†™çš„ç»¼è¿°ã€‚ä¸è¿‡åœ¨å­¦ä¹ æ—¶æˆ‘ä¹Ÿå¹¶æ²¡æœ‰æ˜ç¡®è§„åˆ’ï¼Œè€Œæ˜¯è¿™ä¸ªçœ‹ä¸€ç‚¹é‚£ä¸ªçœ‹ä¸€ç‚¹ï¼Œæœ€åè¿˜æ˜¯æ„Ÿåˆ°ä¸€å¤´é›¾æ°´ã€‚ ç»å…¸æ•™ç§‘ä¹¦çš„é—®é¢˜æœ‰ï¼š è‹±è¯­æ‰€å†™ï¼Œè¾ƒéš¾æŠ“ä½é‡ç‚¹å’Œå…³é”®çš„æ€æƒ³ï¼›å·¥ä½œè®°å¿†æœ‰é™ï¼Œæ¢³ç†ä¸æ¸…æ¡ç† éƒ½æ˜¯è®²æœ€ç»å…¸çš„å®ç°ï¼Œç”¨ç®€å•çš„ä¾‹å­æ…¢æ…¢å¼•å…¥ï¼Œå­¦ä¹ æ—¶è¾ƒä¸ºè€—è´¹æ—¶é—´ï¼Œä¸”å¾ˆéš¾çŸ¥é“ç ”ç©¶ç°çŠ¶å’Œè¯¥é—®é¢˜å„ç§ç®—æ³•çš„ç»¼åˆæ¯”è¾ƒ paperçš„é—®é¢˜æœ‰ï¼š å› ä¸ºé˜…è¯»ç»éªŒä¸è¶³ï¼Œä¹Ÿéš¾æŠ“ä½é‡ç‚¹ contextè¾ƒå¤šï¼Œå°±ä¼šå˜å¾—éš¾ä»¥ç†è§£ï¼›è€Œä¸”ä¸çŸ¥é“è¯¥è®ºæ–‡åœ¨é¢†åŸŸå†…å¤„äºä¸€ä¸ªä»€ä¹ˆæ ·çš„ä½ç½® slideçš„é—®é¢˜æœ‰ï¼š è™½ç„¶èƒ½æŠ“ä½æ ¸å¿ƒï¼Œä½†å¤ªç®€ç•¥éš¾æ‡‚ï¼Œè®¸å¤šå›¾åƒæ„ä¹‰éœ€è¦è„‘è¡¥ï¼Œä¸å¥½ç†è§£ youtubeè§†é¢‘ä»¥åŠåšå®¢çš„é—®é¢˜æœ‰ï¼š è™½ç„¶è®¸å¤šèµ„æ–™æ·±å…¥æµ…å‡ºï¼Œä½†è®¸å¤šæ·±å…¥å†…å®¹çš„è¾ƒå°‘ï¼Œä¹Ÿæœ‰è®¸å¤šä»·å€¼ä¸é«˜çš„å†…å®¹ â€¦. ç»è¿‡ä¸€äº›æŒ«æŠ˜åï¼Œæˆ‘å°è¯•ç€ç»™å‡ºä¸€ä¸ªè¾ƒä¸ºç³»ç»ŸåŒ–çš„æ–°çŸ¥è¯†å­¦ä¹ æ–¹æ¡ˆï¼Œä¹Ÿè®¸èƒ½ä»¥åä½œä¸ºå‚è€ƒã€‚ STFW æœé›†å„ç§ä¿¡æ¯ï¼Œå¹¶åˆ†ç±»æ•´ç†æœé›†åˆ°çš„ä¿¡æ¯ äº†è§£ç›¸å…³èƒŒæ™¯çŸ¥è¯†å’Œå‘å±•å†ç¨‹ï¼Œå¿ƒé‡Œæœ‰ä¸€ä¸ªå¤§æ¦‚çš„æ¡†æ¶ æ·±å…¥å­¦ä¹ å…¶ä¸­ä¸€ä¸ªç»å…¸æ¡ˆä¾‹ï¼Œææ¸…æ¥šæ ¸å¿ƒçš„æ€æƒ³ï¼ŒåŸºæœ¬çš„æŠ½è±¡ï¼›è¿™ä¸€æ­¥å¯ä»¥åšä¸€äº›ç¬”è®°ï¼Œæˆ–è€…åœ¨è‰ç¨¿çº¸ä¸Šæ¨¡æ‹Ÿï¼Œä»¥åŠ æ·±ç†è§£ å†å»æœé›†ä¸€äº›ç»¼è¿°ï¼Œäº†è§£è¯¥é¢†åŸŸå‘å±•ç°çŠ¶ï¼Œèƒ½æœ‰ä¸€ä¸ªæ›´ç»†è‡´çš„æ¡†æ¶ æ­¤æ—¶æ ¹æ®è‡ªå·±çš„ç›®æ ‡ ä»¥åŠ åˆšåˆšå­¦ä¹ åˆ°çš„æ¡†æ¶ï¼Œä¸ºç›®æ ‡é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„ç›®æ ‡ç®—æ³•ï¼Œç„¶åå»å­¦ä¹  å½“é€‰å®šç›®æ ‡ç®—æ³•å¹¶å®ç°æ—¶ï¼Œå¯ä»¥å‚è€ƒå¼€æºé¡¹ç›®ä»£ç ä»¥åŠå¼€å‘äººå‘˜çš„å®ç°ç›¸å…³åšå®¢ æ€»ç»“ é¡¹ç›® æ˜ç¡®è§„å®šç›®æ ‡ï¼šå¯ä»¥æ–‡æ¡£åŒ–è§„èŒƒåŒ–éœ€æ±‚ å®Œå–„åŸºç¡€è®¾æ–½ï¼šæ—¢æœ‰é›†æˆæµ‹è¯•ï¼Œä¹Ÿæœ‰å•å…ƒæµ‹è¯• åŠæ—¶è¯†åˆ«ç“¶é¢ˆå¹¶å¤„ç† ç•™å¤Ÿæ—¶é—´åškiller feature ç®¡ç† äº¤æµï¼šå……åˆ†åå•†ï¼Œæ‰“å¼€æ€è·¯ï¼Œè®©æ¯ä¸ªäººè·å¾—å‚ä¸æ„Ÿ åŠ¨æœºï¼šè®¾ç½®ddl å†³ç­–ï¼šæœæ–­å†³ç­–ï¼Œä¸æ–­è¿­ä»£ï¼ˆå¯¹äºé›†ä¸­å¼å›¢é˜Ÿï¼‰ æ¯”å¦‚ï¼šé€šè¿‡ddlå®Œæˆæƒ…å†µæ¥äº†è§£æ¯ä¸ªäººçš„åŠ¨åŠ›å€¼ï¼ŒåŠæ—¶ç»™åŠ¨åŠ›å€¼ä¸è¶³çš„äººé‡æ–°åˆ†é…ä»»åŠ¡ å­¦ä¹  ç³»ç»ŸåŒ– ","date":"2024-11-09","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/:6:0","tags":["Reflection","Compiler"],"title":"ç¼–è¯‘å™¨å¼€å‘åæ€","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E5%BC%80%E5%8F%91%E5%8F%8D%E6%80%9D/"},{"categories":["System"],"content":"æŸ¥çœ‹æœ¬æ–‡é…å¥—çš„ slide ç‚¹è¿™é‡Œ å¤§å®¶å¥½ï¼Œä»Šå¤©æˆ‘åˆ†äº«çš„ä¸»é¢˜æ˜¯ã€Œæ‰“ç ´å£å’ï¼šä»£ç†æŠ€æœ¯åœ¨å®¶åº­ç½‘ç»œä¸­çš„åº”ç”¨ã€ã€‚ä¸»è¦æ˜¯å‘å¤§å®¶ä»‹ç»ï¼Œå‡å¦‚åœ¨å®¶åº­ç½‘ç»œä¸­ï¼Œæœ‰é»‘å®¢æŒŸæŒäº†ç½‘å…³ï¼Œå¹¶å¯¹æ­£å¸¸è®¿é—®äº’è”ç½‘äº§ç”Ÿäº†å¹²æ‰°ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ä»£ç†æŠ€æœ¯æ¥çªç ´å°é”ï¼Œæ‰“ç ´å£å’ï¼Œæ­£å¸¸åœ°è®¿é—®äº’è”ç½‘ã€‚ è¿è¡Œè‰¯å¥½çš„å®¶åº­ç½‘ç»œ é¦–å…ˆæˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹åœ¨ä¸€ä¸ªè¿è¡Œè‰¯å¥½çš„å®¶åº­ç½‘ç»œä¸­ï¼Œç”¨æˆ·æ˜¯å¦‚ä½•è®¿é—®äº’è”ç½‘ï¼Œä»¥åŠç½‘å…³åœ¨å…¶ä¸­èµ·åˆ°äº†ä»€ä¹ˆä½œç”¨çš„ã€‚ ä¸Šå›¾æ˜¯ä¸€ä¸ªæœ€ç®€åŒ–çš„å®¶åº­ç½‘ç»œçš„åŸºæœ¬æ¶æ„ã€‚ISPï¼Œä¹Ÿå°±æ˜¯äº’è”ç½‘æœåŠ¡æä¾›å•†å‘ä½ æä¾›ä¸€ä¸ªå†…ç½®å…‰çŒ«çš„è·¯ç”±å™¨ã€‚å…‰çŒ«æŠŠå…‰ç¼†ä¸­çš„å…‰ä¿¡å·è½¬åŒ–ä¸ºè·¯ç”±å™¨èƒ½å¤Ÿè§£æçš„ç”µä¿¡å·ã€‚è·¯ç”±å™¨æ˜¯åœ¨ç½‘ç»œå±‚è¿›è¡Œè·¯ç”±è½¬å‘çš„è®¾å¤‡ï¼Œå¾€å¾€ä¹Ÿæ˜¯ä¸€ä¸ªé€šç”¨è®¡ç®—æœºã€‚è·¯ç”±å™¨ä¹Ÿå¾€å¾€å……å½“äº†æ— çº¿å±€åŸŸç½‘ç»œWi-Fiçš„APï¼Œæ¥å…¥ç‚¹ã€‚ æˆ‘ä»¬çš„è®¾å¤‡åœ¨è¿æ¥åˆ°Wi-Fiæ—¶ï¼Œå°±ç›¸å½“äºæ¥å…¥åˆ°äº†è¿™ä¸ªè¿™ä¸ªæ— é™å±€åŸŸç½‘ã€‚å…·æœ‰Wi-FiåŠŸèƒ½çš„è·¯ç”±å™¨ä¸€èˆ¬ä¹Ÿå……å½“äº†dhcpæœåŠ¡å™¨çš„è§’è‰²ã€‚dhcpæœåŠ¡å™¨åœ¨å±€åŸŸç½‘ä¸­å¹¿æ’­å‘ŠçŸ¥è‡ªå·±çš„å­˜åœ¨ï¼Œå½“è®¾å¤‡æ£€æµ‹åˆ°åå°±å‘dhcpæœåŠ¡å™¨è¯·æ±‚åˆ†é…IPã€‚dhcpä¸ä»…ä»…ä¼šå‘ŠçŸ¥è®¾å¤‡è‡ªå·±è¢«åˆ†é…çš„IPï¼Œè¿˜ä¼šå‘ŠçŸ¥è®¾å¤‡å½“å‰ç½‘æ®µçš„å­ç½‘æ©ç ä»¥åŠç½‘å…³IPåœ°å€ã€‚åœ¨æ­¤ä¹‹åï¼Œç”¨æˆ·æ‰€æœ‰çš„ç½‘ç»œæŠ¥æ–‡éƒ½ä¼šè¢«è½¬å‘ç»™ç½‘å…³ï¼Œç„¶åç»ç”±ç½‘å…³å†è½¬å‘ç»™çœŸæ­£çš„ç›®æ ‡ã€‚ç½‘å…³ä¹Ÿå¾€å¾€æ˜¯ç”±è¿™é‡Œçš„è·¯ç”±å™¨æ‹…ä»»ã€‚ é»‘å®¢ã€è¥²æ¥ é‰´äºè·¯ç”±å™¨â€œä¸€å¤«å½“å…³ï¼Œä¸‡å¤«è«å¼€â€çš„åœ°ä½ï¼Œå®ƒå¾ˆå®¹æ˜“æˆä¸ºè¢«æ”»å‡»çš„å¯¹è±¡ã€‚å‡è®¾æˆ‘ä»¬å¤„äºä¸€ä¸ªåˆç§Ÿæˆ¿é‡Œï¼Œé»‘å®¢é˜¿è‡³æ˜¯æˆ‘ä»¬çš„æˆ¿ä¸»ã€‚é˜¿è‡³æ˜¯ä¸€ä¸ªç‹‚çƒ­çš„ç™¾åº¦åŒæ¶è€…ï¼Œä»–åƒæ–¹ç™¾è®¡åœ°é˜»æ­¢åˆ«äººè®¿é—®ç™¾åº¦ï¼Œç”šè‡³ä¸æƒœå¯¹è·¯ç”±å™¨å·å·åšæ‰‹è„šï¼Œä»¥ä½¿å¾—ç§Ÿå®¢æ— æ³•è®¿é—®ç™¾åº¦ã€‚ ç”±äºå®¶ä¸­åœ°è·¯ç”±å™¨å°±æ˜¯ä¸€ä¸ªé€šç”¨è®¡ç®—æœºï¼Œé˜¿è‡³é€šè¿‡åˆ·æœºçš„æ–¹å¼æŒæ¡äº†è¿™å°è·¯ç”±å™¨çš„rootæƒé™ï¼Œä»æ­¤ä»–å°±å¯ä»¥å¯¹è·¯ç”±å™¨èƒ¡ä½œéä¸ºäº†ã€‚ä»–æŠŠè¿™å°è·¯ç”±å™¨åˆ·æˆäº†Linuxçš„ç³»ç»Ÿï¼Œå¹¶è¾“å…¥äº†ä¸‹é¢å‘½ä»¤ï¼š iptables -A OUTPUT -d baidu.com -j DROP iptables -A INPUT -s baidu.com -j DROP ä¸‹é¢ä¸¤æ¡å‘½ä»¤ä¼šä½¿è·¯ç”±å™¨æ‹’ç»ä¸€åˆ‡ç”±ç™¾åº¦å‘é€è€Œæ¥ï¼Œæˆ–è€…å‘å‘ç™¾åº¦çš„æŠ¥æ–‡ã€‚iptablesæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨linuxç”¨æˆ·æ€çš„å·¥å…·ï¼Œä½†ä»–å¯ä»¥å¯¹å†…æ ¸ç½‘ç»œæ ˆçš„å¤„ç†è§„åˆ™è¿›è¡Œé…ç½®ã€‚å…·ä½“è€Œè¨€ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å®ƒæ¥ä¸ºå†…æ ¸æ·»åŠ ä¸€äº›hookå‡½æ•°ï¼Œå†…æ ¸ä¼šåœ¨å¤„ç†ç½‘ç»œæŠ¥æ–‡æ—¶è°ƒç”¨è¿™äº›hookå‡½æ•°ï¼Œå¹¶æ ¹æ®ç»“æœå¯¹æŠ¥æ–‡è¿›è¡Œä¸€äº›å¤„ç†ã€‚æ¯”å¦‚ç¬¬ä¸€æ¡å‘½ä»¤ï¼Œiptables ä¼šé¦–å…ˆé€šè¿‡DNSæŸ¥è¯¢è·å¾—baidu.comçš„IPåœ°å€ï¼Œç„¶ååœ¨ä¸€ä¸ªç½‘ç»œå±‚æŠ¥æ–‡ç»è¿‡å†…æ ¸æ ˆå¤„ç†å¹¶å‘é€ä¹‹å‰ï¼Œåˆ¤æ–­è¯¥æŠ¥æ–‡çš„ç›®æ ‡æ˜¯å¦æ˜¯baidu.comï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒè¯¥æŠ¥æ–‡ã€‚ç¬¬äºŒæ¡å‘½ä»¤åšçš„ä¹Ÿæ˜¯ç±»ä¼¼çš„äº‹æƒ…ï¼Œä»–ä¼šä¸¢å¼ƒä»baidu.comå‘æ¥çš„æŠ¥æ–‡ã€‚ è¿™æ ·é˜¿è‡³å°±æˆåŠŸåœ°é˜»æ­¢äº†æˆ‘ä»¬è®¿é—®baidu.comã€‚ ä»£ç†æœåŠ¡å™¨ åœ¨é˜¿è‡³å¯¹è·¯ç”±å™¨åšäº†æ‰‹è„šåï¼Œæˆ‘ä»¬å°±ä¸èƒ½å†è®¿é—®ç™¾åº¦äº†ã€‚ä½†æ˜¯ç™¾åº¦ä¹‹å¤–çš„ç½‘ç«™å´åˆå¯ä»¥æ­£å¸¸è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå¿«å°±çŒœåˆ°é˜¿è‡³åšäº†ä»€ä¹ˆã€‚æˆ‘ä»¬å¯ä¸ä¼šå‘é»‘å®¢å±ˆæœçš„ï¼å¦‚æœé™¤ç™¾åº¦ä¹‹å¤–çš„ç½‘ç«™éƒ½å¯ä»¥è®¿é—®â€¦é‚£ä¹ˆåªè¦æˆ‘ä»¬åœ¨å¤–ç½‘ä¸Šè¿˜æœ‰ä¸€å°æœåŠ¡å™¨ï¼Œé€šè¿‡è¿™å°æœåŠ¡å™¨çš„ä¸­è½¬æ¥è®¿é—®ç™¾åº¦ï¼Œè¿™æ ·ç»è¿‡è·¯ç”±å™¨æŠ¥æ–‡çš„æºIPå’Œç›®çš„IPéƒ½ä¼šå˜æˆæœåŠ¡å™¨IPè€Œä¸æ˜¯ç™¾åº¦IPäº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ­£å¸¸è®¿é—®ç™¾åº¦äº†ï¼ ç»è¿‡ç™¾åº¦æŸ¥è¯¢ä¹‹åï¼Œæˆ‘ä»¬å‘ç°äº†socks5ä»£ç†è¿™ä¸€åº”ç”¨å±‚åè®®ã€‚åœ¨è¿™ä¸ªåè®®ä¸­ï¼Œç”¨æˆ·ç¨‹åºéœ€è¦å’Œç›®æ ‡é€šè¿‡TCP/UDPåè®®é€šä¿¡æ—¶ï¼Œå¯ä»¥å…ˆé€šè¿‡socks5åè®®ä¸å®ç°äº†è¯¥åè®®çš„ä»£ç†æœåŠ¡å™¨é€šä¿¡ï¼Œç„¶åä»£ç†æœåŠ¡å™¨å†å’Œç›®æ ‡é€šä¿¡ï¼Œå°†è¿”å›æŠ¥æ–‡è½¬å‘ç»™ç”¨æˆ·ç¨‹åºã€‚HTTP/HTTPSåè®®èµ·åˆ°çš„ä½œç”¨ä¸socks5åè®®ç±»ä¼¼ã€‚å¤§å¤šæ•°ä½¿ç”¨ç½‘ç»œçš„ç”¨æˆ·ç¨‹åºéƒ½å®ç°äº†è¯¥åè®®ï¼Œæ¯”å¦‚ curlï¼Œå¤§éƒ¨åˆ†æµè§ˆå™¨ ä»–ä»¬ä¼šåœ¨å‘é€ç½‘ç»œè¯·æ±‚æ—¶å…ˆæŸ¥çœ‹ç¯å¢ƒå˜é‡ä¸­æ˜¯å¦å®šä¹‰äº† http_proxy socks_proxy ç­‰ï¼Œå¦‚æœå®šä¹‰äº†ï¼Œåˆ™é€šè¿‡ä»£ç†æœåŠ¡å™¨ä¸ç›®æ ‡é€šä¿¡ï¼Œå¦åˆ™ç›´æ¥é€šä¿¡ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›ç”¨æˆ·ç¨‹åºï¼Œæ¯”å¦‚ wgetï¼Œå¹¶ä¸ä¼šä¸»åŠ¨æ£€æŸ¥å¹¶ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„ä»£ç†ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œå°±å¯ä»¥ç»•å¼€é˜¿è‡³çš„å°é”äº†ï¼ é»‘å®¢ã€ä¾µå…¥ ä¸è¿‡ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œé˜¿è‡³å‘ç°æˆ‘ä»¬ç»è¿‡è·¯ç”±å™¨çš„æŠ¥æ–‡æ€»æ˜¯å‘å‘åŒä¸€ä¸ªåœ°å€ï¼Œä»–å¾ˆå¿«å°±çŒœåˆ°æˆ‘ä»¬æ˜¯ä½¿ç”¨äº†ä»£ç†æœåŠ¡å™¨æ¥ç»•å¼€è·¯ç”±å™¨çš„å°é”ã€‚ä»–å¯¹ç»è¿‡è·¯ç”±å™¨è½¬å‘çš„æ•°æ®åŒ…åˆ†æåå‘ç°ï¼Œè®¸å¤šåŒ…ä¸­éƒ½å­˜åœ¨ baidu è¿™æ ·çš„å­—æ®µâ€¦ äºæ˜¯é˜¿è‡³åˆæƒ³åˆ°äº†ä¸€ä¸ªç‚¹å­ï¼Œä»–åœ¨è·¯ç”±å™¨ä¸­è¾“å…¥äº†å¦‚ä¸‹å‘½ä»¤ï¼š iptables -I INPUT -m string --string \"/baidu/i\" --algo regex -j DROP è¿™æ ·ï¼Œåªè¦æŠ¥æ–‡ä¸­å«æœ‰ â€œbaiduâ€ è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±ä¼šè¢«è·¯ç”±å™¨ä¸¢å¼ƒï¼Œå®å¯é”™æ€ä¸€ç™¾ï¼Œä¸å¯æ”¾è¿‡ä¸€ä¸ªï¼ åŠ å¯†çš„ä»£ç† ä¸ä¹…åï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°baiduåˆä¸èƒ½æ­£å¸¸è®¿é—®äº†ï¼Œç”šè‡³ç”¨bingæœç´¢â€œbaiduâ€éƒ½ä¸è¡Œï¼Œä¼¼ä¹åªè¦å«æœ‰â€œbaiduâ€è¿™ä¸ªå…³é”®è¯ï¼ŒæŠ¥æ–‡å°±ä¼šè¢«ä¸¢å¼ƒã€‚äºæ˜¯æˆ‘ä»¬æƒ³å‡ºäº†ä¸€ä¸ªåŠæ³•ï¼šæ—¢ç„¶ä½ åšå…³é”®è¯åŒ¹é…ï¼Œé‚£ä¹ˆåªè¦æˆ‘çš„æŠ¥æ–‡é‡Œæ²¡æœ‰å…³é”®è¯å°±å¥½äº†ã€‚å¦‚æœç»è¿‡è·¯ç”±å™¨çš„æŠ¥æ–‡éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œé˜¿è‡³è‚¯å®šå°±ä¸çŸ¥é“æˆ‘ä»¬æŠ¥æ–‡çš„çœŸå®å†…å®¹æ˜¯ä»€ä¹ˆäº†ï¼Œä»–ä¹Ÿä¸è‡³äºå’Œæˆ‘ä»¬å½»åº•é—¹ç¿»ï¼Œä¸¢æ‰æ‰€æœ‰æŠ¥æ–‡ï¼Œä¸è®©æˆ‘ä»¬è¿æ¥äº’è”ç½‘å§ã€‚ æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„æ˜¯ï¼Œå¯¹socks5ä»£ç†è¿›è¡Œå¢å¼ºï¼Œè®©åº”ç”¨ç¨‹åºä¸ä»£ç†æœåŠ¡ä¹‹é—´è¿›è¡ŒåŠ å¯†é€šè¯ã€‚å¯æ˜¯å¸‚åœºä¸Šçš„åº”ç”¨ç¨‹åºåŸºæœ¬éƒ½åªå®ç°äº†ç®€å•çš„socks5ä»£ç†ï¼Œå¦‚æœè¦è®©ä»–ä»¬æ”¯æŒåŠ å¯†åŠŸèƒ½åˆ™éœ€è¦æŠŠä»–ä»¬çš„æºä»£ç éƒ½æ”¹äº†ï¼Œè¿™ä¸ªå·¥ä½œé‡å¯å¤ªå¤§äº†ï¼ ç»è¿‡æ€è€ƒï¼Œæˆ‘ä»¬æƒ³åˆ°å¯ä»¥åˆ©ç”¨å·²æœ‰çš„socks5ä»£ç†åè®®ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå®ç°è‡ªå·±çš„åŠ å¯†ç‰ˆæœ¬ã€‚æˆ‘ä»¬å†™äº†ä¸€ä¸ªsocks5ä»£ç†æœåŠ¡å™¨SS Localï¼Œlocalæ¥æ”¶åº”ç”¨ç¨‹åºçš„ä»£ç†è¯·æ±‚ï¼Œå¯æ˜¯localä¸è¿è¡Œåœ¨å¤–ç½‘ï¼Œè€Œæ˜¯è¿è¡Œåœ¨å†…ç½‘ï¼Œå®ƒä¼šæŠŠåº”ç”¨ç¨‹åºå‘é€ç»™ä»–çš„æŠ¥æ–‡å…ˆåŠ å¯†ï¼Œç„¶åå‘é€ç»™å¤–ç½‘çš„å¦ä¸€ä¸ªsocks5æœåŠ¡å™¨SS Serverï¼Œserverä¼šè§£å¯†æŠ¥æ–‡ï¼Œå¾—åˆ°çœŸæ­£éœ€è¦ä»£ç†çš„è¯·æ±‚ã€‚å½“è¯·æ±‚è¿”å›æ—¶serverä¹Ÿä¼šå…ˆæŠŠæŠ¥æ–‡åŠ å¯†ï¼Œå‘é€ç»™localï¼ŒlocalæŠŠæŠ¥æ–‡è§£å¯†ï¼Œå†å‘é€ç»™ç”¨æˆ·ç¨‹åºã€‚ è¿™æ ·ï¼Œå°½ç®¡ç”¨æˆ·ç¨‹åºä»¥ä¸ºè‡ªå·±è¿˜åœ¨ä½¿ç”¨æ™®é€šçš„socks5ä»£ç†ï¼Œå¯æ˜¯æˆ‘ä»¬å·²ç»æ‚„æ‚„å¯¹socks5åè®®è¿›è¡Œäº†å‡çº§ï¼Œå®é™…ä¸Šç»è¿‡è·¯ç”±å™¨çš„æŠ¥æ–‡éƒ½æ˜¯åŠ å¯†è¿‡çš„äº†ï¼Œé˜¿è‡³å†ä¹Ÿæ— æ³•çŸ¥é“æˆ‘ä»¬åœ¨çœ‹äº›ä»€ä¹ˆäº†ï¼ é€æ˜çš„ä»£ç† è™½ç„¶æˆ‘ä»¬å·²ç»æˆ˜èƒœäº†é˜¿è‡³ï¼Œåšåˆ°äº†å‡ ä¹å®Œç¾çš„åŠ å¯†ï¼Œä½†æˆ‘ä»¬è¿˜ä¸æ»¡è¶³äºæ­¤ã€‚ ä¸Šé¢çš„ä»£ç†å¾—è¦ç”¨æˆ·ç¨‹åºä¸»åŠ¨ä½¿ç”¨ï¼Œæœ‰æ²¡æœ‰å¯èƒ½å®ç°é€æ˜çš„ä»£ç†æ–¹æ³•ï¼Œè®©æ‰€æœ‰ç½‘ç»œæŠ¥æ–‡éƒ½ç»è¿‡ä»£ç†ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚åªè¦é€šè¿‡æ–°å»ºè™šæ‹Ÿç½‘å¡ï¼ŒæŠŠé€šè¿‡å…¶ä¸­çš„æŠ¥æ–‡éƒ½ä»£ç†äº†å°±å¥½äº†â€¦ VPNçš„åŸç†å°±æ˜¯è¿™æ ·â€¦ æ¼«æ— æ­¢å¢ƒçš„æˆ˜æ–— ä¸è¿‡ï¼Œç½‘ç»œå°é”ä¸çªç ´ï¼Œå°†æ°¸è¿œæ˜¯ä¸€åœºæ¼«æ— æ­¢å¢ƒçš„æˆ˜æ–—ã€‚ äº‹å®ä¸Šé˜¿è‡³è¿˜å¯ä»¥ åš DNS æ±¡æŸ“ï¼Œ è¯†åˆ«åŠ å¯†æ•°æ®è§„å¾‹ ä¸»åŠ¨å—…æ¢â€¦ ä½†åŒæ—¶ï¼Œå…µæ¥å°†æŒ¡ï¼Œæ°´æ¥åœŸæ©ï¼Œæˆ‘ä»¬ä¹Ÿæ°¸è¿œæœ‰æ–°çš„çªç ´ç½‘ç»œå°é”çš„æ–¹å¼ â€œçŒ«é¼ æ¸¸æˆ\"æ°¸è¿œä¸ä¼šå®Œç»“ æ€»ç»“ é»‘å®¢çš„æ‰‹æ®µ æˆ‘ä»¬çš„ä¸¾æª ipå®¡æŸ¥ ä»£ç† å†…å®¹å®¡æŸ¥ åŠ å¯†ä»£ç† æµé‡è§„å¾‹ æ¢åŠ å¯†æ–¹å¼ ä¸»åŠ¨å—…æ¢ æ›´å¥½çš„ä¼ªè£… â€‹ â€‹ ","date":"2024-11-06","objectID":"/posts/%E4%BB%A3%E7%90%86%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/:0:0","tags":["Share","Network","Proxy"],"title":"æ‰“ç ´å£å’ï¼šä»£ç†æŠ€æœ¯åœ¨å®¶åº­ç½‘ç»œä¸­çš„åº”ç”¨","uri":"/posts/%E4%BB%A3%E7%90%86%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"},{"categories":["System"],"content":" Programming languages should be designed not by piling feature on top of feature, but by removing the weaknesses and restrictions that make additional features appear necessary ä¹‹å‰åœ¨ Twitter ä¸Šå¬ Robert Nystrom çš„ä¸€ä¸ªæ¼”è¯´æ—¶ï¼Œæœ‰è§‚ä¼—é—®ä»–â€œå¦‚ä½•çœ‹å¾… ChatGPTï¼ŒCopilot å¯¹äºç¼–ç¨‹çš„å½±å“â€ã€‚Robert å›é“ï¼šä»–è®¤ä¸ºç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œmake somethingâ€ï¼Œè€Œ Copilot è¿™ç±»å·¥å…·å´å¾ˆæœ‰å¯èƒ½æŠŠ programmer å˜æˆä»£ç å®¡æ ¸å‘˜ï¼Œä»è€Œä¸§å¤±äº†â€œmake somethingâ€çš„ä¹è¶£ã€‚å¯æ˜¯å°±ç®—åœ¨å‰ ChatGPT æ—¶ä»£ï¼Œæˆ‘åˆçœŸæ­£ä½“ä¼šåˆ°è¿‡â€œmake somethingâ€çš„ä¹è¶£å—ï¼Ÿä¹‹å‰æˆ‘çš„ç¼–ç¨‹å®è·µæ€»æ˜¯ä¸€äº›è¯¾ç¨‹ä½œä¸šï¼Œè¿™äº›ä½œä¸šçš„ idea æˆ–æ˜¯æ¡†æ¶æ€»æ˜¯ç”±ä»–äººæå‡ºï¼Œç›®çš„ä¹Ÿå¾€å¾€æ˜¯é€šè¿‡ OJã€‚è¿™æ ·çš„ç¼–ç¨‹å®è·µç»™äººå¸¦æ¥çš„â€œmake somethingâ€ä¹‹æ„Ÿè‡ªç„¶å°±å¤§æ‰“æŠ˜æ‰£äº†ã€‚äºæ˜¯åœ¨å¯èƒ½å‘ç”Ÿçš„â€œAI é©å‘½â€çš„å‰å¤œï¼Œæˆ‘å†³å®šè‡ªå·±åŠ¨æ‰‹å†™ä¸€ä¸ªå…¼å®¹ R7RS çš„ Scheme è§£é‡Šå™¨ï¼ŒçœŸæ­£â€œmake somethingâ€ã€‚ åœ¨å¤§ä¸€æ—¶æ›¾è¯»è¿‡éƒ¨åˆ† SICPï¼Œå¯¹ Scheme æœ‰ä¸€ç‚¹ç‚¹è®¤çŸ¥ã€‚ä½†å¯¹äºå…¶å¾ˆå¤šé«˜çº§ç‰¹æ€§è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå°¤å…¶æ˜¯ continuation å’Œ macroã€‚äºæ˜¯åœ¨åŠ¨å†™è§£é‡Šå™¨å‰ï¼Œæ‰“ç®—å…ˆç†Ÿæ‚‰ä¸€ä¸‹ Scheme çš„ç‰¹æ€§ã€‚ S-Expression 1960å¹´ï¼ŒJohn McCarthy åœ¨å‡½æ•°å¼ç¼–ç¨‹çš„å¼€å±±ä¹‹ä½œ Recursive Functions of Symbolic Expressions and Their Computation by Machine ä¸­æå‡ºäº† LSIP è¯­è¨€ï¼Œè¿™ä¹Ÿæ˜¯ Scheme çš„å‰èº«ã€‚LISP è¯­è¨€æœ€åˆä¹Ÿæ˜¯ä¸ºäº†æ”¯æŒäººå·¥æ™ºèƒ½ç³»ç»Ÿ Advice Taker è€Œåˆ›é€ çš„(å¯æƒœ Advice Taker ä»£è¡¨çš„ç¬¦å·ä¸»ä¹‰ AI ç ”ç©¶æ–¹æ³•åœ¨å½“å‰çš„ AI æµªæ½®ä¸­ä¼¼ä¹ä¸è§äº†èº«å½±)ï¼Œå…¶ç›®çš„åœ¨äºæä¾›ä¸€ç§æ“ä½œ expression çš„åŠŸèƒ½ä»¥ä½¿å¾— Advice Taker èƒ½åœ¨å…¶ä¸Šæ¨ç†ã€‚ åœ¨ LISP System ä¸­ï¼Œæœ‰ S-Expressions å’Œ S-Functions(å¯¹åº” Scheme ä¸­çš„è¿‡ç¨‹/procedure) ä¸¤ä¸ªæ¦‚å¿µã€‚S-Expressions å³æ˜¯ Symbolic Expressionï¼Œå’Œæ•°å­¦æ„ä¹‰ä¸Šçš„ expression (è¡¨è¾¾å¼)æ„ä¹‰ç›¸åŒã€‚S-expressions æœ¬èº«ä»…ä»…æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ²¡æœ‰ä»»ä½•æ±‚å€¼çš„å«ä¹‰ã€‚ S-Expression çš„å®šä¹‰å¦‚ä¸‹ï¼š (ä»¥åŠlistçš„å®šä¹‰å¦‚ä¸‹) åœ¨ S-Expression ä¹‹ä¸Šï¼Œæˆ‘ä»¬åˆå¯ä»¥å®šä¹‰å¯¹å…¶è¿›è¡Œæ“ä½œçš„ S-function (S-functionäº‹å®ä¸Šä¸º partial functionï¼Œå› ä¸ºæœ‰å¯èƒ½æ— é™å¾ªç¯) atom. atom[x] has the value of T or F according to whether x is an atomic symbol. atom [X] = T atom [(X Â· A)] = F car. car[x] is defined if and only if x is not atomic. car [(e1 Â· e2)] = e1. Thus car [X] is undefined. car [(X Â· A)] = X car [((X Â· A) Â· Y )] = (X Â· A) å½“ç„¶S-functionä¹Ÿå¯ä»¥é€’å½’ï¼š ff[x]. The value of ff[x] is the first atomic symbol of the S-Expression x with the parentheses ignored. Thus ff[((A Â· B) Â· C)] = A å‘ä¸Šé¢çš„å¼å­å«åš M-expressions (meta-expressions)ã€‚(æ³¨æ„åˆ° M-expression ä¹‹ä¸Šå°±æœ‰æ±‚å€¼çš„è¯­ä¹‰äº†) æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ S-Expressions æ¥è¡¨ç¤º S-Functionsï¼ŒåŒç†å¯ä»¥æŠŠä»»æ„ä¸€ä¸ª M-expression ç”¨ S-Expression è¡¨è¾¾ï¼š (è¿™æ ·å°±æœ‰å¹³æ—¶ç”¨çš„ Scheme çš„æ„Ÿè§‰äº†ï¼Œï¼Œ) ç„¶è€Œå•æ˜¯è¿™ä¸ªè½¬æ¢æœ¬èº«æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªå‡½æ•° eval æ¥å¯¹è½¬æ¢åçš„ S-Expression è¿›è¡Œæ±‚å€¼ï¼Œå…¶ç»“æœç›¸å½“äºå¯¹åº”çš„ M-Expression çš„æ±‚å€¼ç»“æœã€‚æˆ‘ä»¬åœ¨å†™ LSIP ç¨‹åºæ—¶å…¶å®å°±æ˜¯åœ¨å†™ S-Expressionï¼Œä½†è¡¨ç¤ºçš„å´æ˜¯ M-Expressionã€‚è§£é‡Šå™¨è¿è¡Œç¨‹åºå°±ç›¸å½“äºæŠŠä½ å†™å¥½çš„ S-Expression ä¸¢ç»™ eval å‡½æ•°å¹¶è¿”å›ç»“æœã€‚ S-Expression è¿™ç§ç¨‹åºçš„è¡¨ç¤ºæ–¹å¼è‡ªç„¶ä¹Ÿè¢« Scheme æ‰€ç»§æ‰¿ï¼Œä¸è¿‡åœ¨ Scheme ä¸­è¿™äº›ä¸œè¥¿éƒ½æ˜¯å°å†™ã€‚è€Œç¬¬ä¸€æ¡è½¬æ¢è§„åˆ™ä¸­çš„ Atom QUOTE å¯ä»¥ç®€å†™ä¸ºâ€™ã€‚ é™¤äº† S-Expressionï¼ŒScheme è¿˜ä» LISP ä¸­ç»§æ‰¿äº† GC,åŠ¨æ€ç±»å‹ã€‚é«˜é˜¶å‡½æ•°ç­‰ç‰¹å¾ã€‚ Fun Facts: John McCarthy çˆ¶äº²ä¸ºçˆ±å°”å…°ç§»æ°‘ï¼Œæ¯äº²ä¸ºç«‹é™¶å®›çŠ¹å¤ªäººç§»æ°‘ï¼ŒäºŒäººéƒ½æ€æƒ³å¼€æ”¾ï¼ŒåŠ å…¥äº†ç¾å›½å…±äº§å…š(Communist Party USA)ã€‚John å‡ºèº«ç”Ÿäº1927å¹´ï¼Œå°‘æ—¶é€šè¿‡é˜…è¯»ä¿„æ–‡è¯‘ä½œ 100,000 Whys (éš¾é“ä¸­æ–‡ç‰ˆçš„ã€Šåä¸‡ä¸ªä¸ºä»€ä¹ˆã€‹ä¹Ÿæ¥è‡ªè‹è”ï¼Ÿ)ç‡ƒèµ·äº†å¯¹ç§‘å­¦çš„å…´è¶£ã€‚Johnåæ¥ä¹Ÿç²¾é€šä¿„è¯­ï¼Œä¸å¤šè‹è”ç§‘å­¦å®¶ç›¸è¯†ã€‚ä½†å½“ä»–åœ¨ 1968 å¹´æ­£çœŸå»è‹è”æ—…è¡Œä¹‹åå¾ˆå¿«å°±å¤±æœ›äº†ï¼Œè½¬å˜ä¸ºå…±å’Œå…šæ”¯æŒè€…ã€‚ Continuation Scheme äº1970å¹´ä»£åœ¨ MIT AI Lab è¢« Guy L. Steele å’Œ Gerald Jay Sussmanå‘æ˜(åˆæ˜¯AIï¼Ÿ)ã€‚ä¸çˆ¶äº² LISP ä¸åŒ, Scheme å®ç°äº†å°¾é€’å½’ä¼˜åŒ–ï¼Œå¹¶å¼•å…¥äº†å®å’Œ first class continuationsï¼Œæœ¬èŠ‚ä¸»è¦ä»‹ç» continuationï¼Œä¸‹ä¸€èŠ‚ä»‹ç»å®(Macro)ã€‚ ä¸Šä¸€èŠ‚è¯´äº† M-Expression æœ‰æ±‚å€¼è¯­ä¹‰ï¼Œeval å‡½æ•°ä¹Ÿèƒ½æ±‚å€¼ï¼Œä½†å¹¶æœªè¯´æ˜åˆ°åº•æ€æ ·æ±‚å€¼ã€‚å…·ä½“æ¥è¯´ï¼Œeval æ¥æ”¶åˆ°ä¸€ä¸ª S-Expression åï¼Œå¯¹ S-Expression çš„æ‰€æœ‰å­Expression(æ¥æ”¶åˆ°çš„ S-Expression åº”ä¸ºä¸€ä¸ªlistï¼Œå­ Expression æŒ‡çš„æ˜¯ list ä¸­çš„å„ä¸ªå­é¡¹)é€ä¸ªè°ƒç”¨evalå‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå­ Expression åº”ä¸ºä¸€ä¸ªè¿‡ç¨‹ï¼Œå‰©ä½™çš„ expression ä¸ºè¿™ä¸ªè¿‡ç¨‹çš„å‚æ•°ï¼Œç„¶åevalä¼šè°ƒç”¨applyå°†å‚æ•°ä½œç”¨åˆ°è¿‡ç¨‹ä¸Šå¹¶è¿”å›ç»“æœã€‚å¯¹äº Scheme è¯­è¨€ä¸­å®šä¹‰çš„åŸºæœ¬è¿‡ç¨‹ï¼Œapply ä¼šç›´æ¥è®¡ç®—å¹¶è¿”å›ç»“æœï¼Œå¯¹äºå¤åˆè¿‡ç¨‹ï¼Œapply ä¼šå°†å‡½æ•°å½¢å‚æ›¿æ¢ä¸ºå®é™…å€¼ï¼Œå†è°ƒç”¨ eval å¯¹å‡½æ•°ä½“æ±‚å€¼å¹¶è¿”å›ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¯¹ä¸€ä¸ª S-Expression æ±‚å€¼çš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œä¸€æ¬¡æ¬¡çš„å¯¹ eval çš„è°ƒç”¨ã€‚è€Œæ¯ä¸ª eval è°ƒç”¨ç»“æŸä¹‹åéƒ½æœ‰ä¸‹é¢è¿˜è¦è¿›è¡Œçš„æ±‚å€¼ï¼Œè¿™ä¸ªåé¢è¿˜è¦è¿›è¡Œçš„æ±‚å€¼å°±å«åšå½“å‰æ±‚å€¼çš„ Continuation(å»¶ç»­)ã€‚ Scheme ä¸­çš„ Continuation æ˜¯ä¸€ä¸ªå¾ˆæŠ½è±¡çš„æ¦‚å¿µï¼Œåœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸­å¾€å¾€ç¼ºå°‘å¯¹äºæ¦‚å¿µã€‚ä½†åœ¨Cè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æœºå™¨çŠ¶æ€æ¥ç†è§£ Continuationã€‚åœ¨Cè¯­è¨€ä¸­ï¼Œå‡å¦‚è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•° fï¼Œä¼šåœ¨æ ˆä¸Š push f çš„å¸§ï¼Œfè°ƒç”¨ç»“æŸä¹‹åä¼šå°†è¿”å›å€¼ push åˆ°æ ˆä¸Šï¼Œå†æ¥ç€åšåç»­è®¡ç®—ã€‚å¦‚æœå†å°†è¿”å›å€¼ push åˆ°æ ˆä¸Šçš„ä¸€ç¬é—´ï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªè¿›ç¨‹åšä¸€ä¸ªå¿«ç…§ï¼Œè¿™ä¸ªå¿«ç…§è¯´æ˜äº†åœ¨ f è¿”å›ååº”è¯¥è¦åšçš„è®¡ç®—ï¼Œå®ƒå…¶å®å°±æ˜¯ f çš„ Continuationã€‚åœ¨Cè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡int setjmp(jmp_buf env)æ¥æ•è·åœ¨è°ƒç”¨setjmpæ—¶çš„ Continuation å¹¶ä¿å­˜åœ¨ env ä¸­ï¼Œè€Œåœ¨æœªæ¥è°ƒç”¨void longjmp(jmp_buf env, int val) ä¼šç»§ç»­è¿›è¡Œ setjmp æ—¶ä¿å­˜çš„ Continuationï¼Œå¹¶æŠŠ val ä½œä¸º setjmp çš„è¿”å›å€¼ã€‚çœ‹èµ·æ¥å°±åƒè¿›è¡Œäº†ä¸€æ¬¡â€œæ—¶ç©ºç©¿è¶Šâ€ã€‚ Cè¯­è¨€ä¸­ setjmp å’Œ longjmp çš„å®ç°å¾ˆå¥½ç†è§£â€”â€”setjmp ä¿å­˜å½“å‰çš„ pc æŒ‡é’ˆä»¥åŠå¯„å­˜å™¨çš„çŠ¶æ€ï¼Œlongjmpæ—¶å¤åŸå°±è¡Œâ€”â€”å½“ç„¶è¿™æ ·ä¹Ÿå°±å¼•å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šcè¯­è¨€ä¸­çš„ setjmp å¹¶ä¸èƒ½çœŸæ­£ä¿å­˜ Continuationï¼Œå› ä¸º setjmp ä¸å¯èƒ½å°†æ ˆä¸Šçš„å€¼ä¹Ÿä¿å­˜äº†ã€‚ä½† Scheme ä¸­çš„ Continuation å´æ˜¯çœŸæ­£çš„ Continuation Scheme æ˜¯é€šè¿‡ call/cc è¿™ä¸€è¿‡ç¨‹èµ·åˆ°å’ŒCè¯­è¨€ä¸­ setjmp ç±»ä¼¼å´æ›´å®Œå¤‡çš„åŠŸèƒ½çš„ã€‚call/cc æ¥æ”¶ä¸€ä¸ªä¸€å…ƒ lambda å‡½æ•°ï¼Œå¯¹å…¶æ±‚å€¼æ—¶ç›¸å½“äºå°†å½“å‰çš„ Continuationä¼  å…¥è¯¥ä¸€å…ƒ lambda å‡½æ•°åå¯¹è¯¥å‡½æ•°ä½“æ±‚å€¼ã€‚å¦‚æœä¸€å…ƒ lambda å‡½æ•°æ­£å¸¸è¿”å›ï¼Œåˆ™ call/cc è¿‡ç¨‹çš„è¿”å›å€¼å°±æ˜¯ä¸€å…ƒ lambda å‡½æ•°çš„è¿”å›å€¼ã€‚å¦‚è¿‡åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨äº† Continuation(Continuation ä¹Ÿæ˜¯ä¸€ä¸ªä¸€å…ƒè¿‡ç¨‹)ï¼Œå½“å‰çš„æ‰€è¦è¿›è¡Œçš„è®¡ç®—å°±ä¼šå˜æˆ Continuation æ‰€è®°å½•çš„è®¡ç®—ï¼Œå°±å¥½åƒ call/cc è¿‡ç¨‹åˆšåˆšè¿”å›ä¸€æ ·ï¼Œè€Œæ­¤æ—¶ call/cc çš„è¿”å›å€¼ä¸ºè°ƒç”¨ Continuation æ—¶ä¼ å…¥çš„å‚æ•°ï¼š (call/cc (lambda (k) (* 5 4))) =\u003e 20 (call/cc (","date":"2023-03-30","objectID":"/posts/scheme%E6%8B%BE%E9%81%97/:0:0","tags":["Scheme","PL","Knowledge"],"title":"Scheme æ‹¾é—ï¼šS-Expressionï¼ŒContinuation ä»¥åŠ Macro","uri":"/posts/scheme%E6%8B%BE%E9%81%97/"},{"categories":["Backend"],"content":" When you are on the dancefloor, there is nothing to do but dance. â€”â€” Umberto Eco, *The Mysterious Flame of Queen Loana* æœ‰ä¸€é“ç»å…¸çš„Javaé¢è¯•é¢˜ï¼š Integer i = 100; Integer j = 100; System.out.print(i == j); // true or false? ç”±äºä¹‹å‰æ²¡æœ‰å‡†å¤‡ç›´æ¥ä¸Šé˜µï¼Œåœ¨ç¢°åˆ°è¿™é“é¢˜æ—¶ä¸€æ—¶ä¸è§£ã€‚ä½†æ˜¾ç„¶è¿™æ˜¯è€ƒå¯Ÿautoboxing(è‡ªåŠ¨è£…ç®±)æœºåˆ¶ï¼Œè€Œä¸€èˆ¬æ•´æ•°è½¬åŒ–ä¸ºIntegerå¯¹è±¡æ—¶è‚¯å®šæ˜¯newä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒæŒ‰ç†è¯´ç»“æœåº”è¯¥ä¸ºfalseï¼Œä½†æ˜¯è€ƒè™‘åˆ°åœ¨å…·ä½“å®ç°ä¸­å¯èƒ½ä¸ºäº†æ•ˆç‡è€ƒè™‘ä¼šé¢„å…ˆç¼“å­˜ä¸€éƒ¨åˆ†æ•´æ•°å¯¹è±¡ï¼Œäºæ˜¯ä¾¿çŒœæµ‹ç­”æ¡ˆä¸ºtrueã€‚ä¸‹æ¥ç½‘ä¸Šä¸€æŸ¥ï¼Œç­”æ¡ˆæœç„¶ä¸ºtrueï¼Œä½†è§£é‡Šå´æ˜¯å¦‚ä¸‹ï¼š è¿™å°±æœ‰ç‚¹å¥‡æ€ªäº†â€”â€”æˆ‘æ€»è§‰å¾—ç¼“å­˜å¤šå°‘æ˜¯å…·ä½“çš„ç¼–è¯‘å™¨æˆ–è€…JVMæŠ‘æˆ–æ˜¯ç›¸å…³ç±»åº“å®ç°çš„é—®é¢˜ï¼Œè€Œä¸è¯¥å®šä¹‰åœ¨è¯­è¨€è§„èŒƒä¸­ï¼Œè€Œå¦‚æœæ˜¯å’Œå…·ä½“å®ç°ç›¸å…³çš„ï¼Œé‚£ä¹ˆè¨€ä¹‹å‡¿å‡¿256ä¸ªæ•°å­—éœ€è¦ç¼“å­˜å°±æœ‰ç‚¹å¥‡æ€ªäº†ã€‚ä¸Šç½‘æŸ¥æŸ¥èµ„æ–™ä¹‹åï¼Œå‘ç°256è¿™ä¸ªæ•°å­—æœç„¶è¿˜æ˜¯Integerç±»çš„é»˜è®¤å®ç°ä¸­å†³å®šçš„ã€‚ä¸‹é¢æˆ‘å°±ç»¼åˆæŸ¥æ‰¾çš„èµ„æ–™ï¼Œä»‹ç»ä¸€ä¸‹è¿™é“é¢˜èƒŒåå¯èƒ½æ¶‰åŠçš„çŸ¥è¯†ã€‚ Reference Type å’Œ Primitive Type é¦–å…ˆJavaç±»å‹ç³»ç»Ÿä»¥åŠJVMä¸­ï¼Œä»»ä½• Value(å€¼) è¦ä¹ˆæ˜¯ reference type(å¼•ç”¨ç±»å‹)ï¼Œè¦ä¹ˆæ˜¯ primitive type(åŸºæœ¬ç±»å‹)ã€‚æ‰€è°“reference typeå°±æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡çš„å€¼ï¼Œæ€»æ˜¯ä¸€æ¡newæŒ‡ä»¤çš„è¿”å›å€¼ï¼Œå¾€å¾€æ˜¯è‡ªèº«å…·æœ‰ä¸€å®šçŠ¶æ€ï¼Œå¹¶å¯ä»¥æ”¹å˜çš„(mutable)ï¼Œåœ¨JVMå®ç°ä¸­ä¸ºä¸€ä¸ªæŒ‡å‘å…·ä½“å¯¹è±¡çš„æŒ‡é’ˆï¼›è€Œ primitive typeçš„å€¼ åˆ™åªèƒ½é€šè¿‡å­—é¢é‡æˆ–æ˜¯é¢„å…ˆå®šä¹‰çš„åœ¨primitive typeä¸Šçš„æ“ä½œè·å¾—ï¼Œè€Œæ“ä½œå¹¶ä¸æ”¹å˜å€¼æœ¬èº«ï¼Œåªæ˜¯äº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„å€¼ï¼Œå³æ˜¯ä¸å¯å˜çš„(immutable)çš„ï¼Œåœ¨JVMå®ç°ä¸­ä¹Ÿå¯¹åº”å®ç°è¯­è¨€çš„primitive type(å¯ä»¥ç†è§£ä¸ºc++ä¸­çš„Int)ã€‚ ä½†æ˜¯åœ¨è®¸å¤šå…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€ä¸­(å¦‚Python)ï¼Œä¸€åˆ‡çš†æ˜¯å¯¹è±¡ï¼Œä¸€åˆ‡å€¼çš†æ˜¯å¼•ç”¨ã€‚è¿™æ ·åšæ¯”Javaå¥½ç†è§£è®¸å¤šï¼Œå…·ä½“å®ç°ä¸Šä¹Ÿæ˜“äºå®ç°äº†ã€‚ä½†æ˜¯å´å¸¦æ¥äº†æ•ˆç‡çš„ä½ä¸‹ï¼Œè¿™ä¸»è¦æœ‰ä¸¤ç‚¹åŸå› ï¼š å¯¹äºæ•´æ•°è¿™æ ·çš„åœ¨ç¼–ç¨‹ä¸­æœ€åŸºæœ¬ä¸”å¸¸ç”¨çš„å€¼ï¼Œå¦‚æœæ¯æ¬¡ä¸¤æ•°ç›¸åŠ éƒ½è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œåˆ™æ˜¯å¯¹èµ„æºçš„æå¤§æµªè´¹ã€‚ ä½ å¯èƒ½ä¼šæƒ³ï¼šä¸ºä»€ä¹ˆä¸æŠŠæ•´æ•°å¯¹è±¡åšæˆå•ä¾‹çš„ï¼Ÿä¹Ÿå°±æ˜¯ä¸€ä¸ªåªæœ‰ä¸€ä¸ª1å¯¹è±¡ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ª2å¯¹è±¡ï¼Œæ¯æ¬¡ 1 + 1 æ€»èƒ½å¾—åˆ°åŒä¸€ä¸ª2 â€”â€” ä½†æ³¨æ„reference typeçš„ç‰¹å¾å°±æ˜¯mutableï¼Œå¦‚æœè¿™æ ·å°±åšä¸åˆ°mutableäº†ï¼Œå’Œç”¨primitive typeè¡¨ç¤ºæ•´æ•°ä¹Ÿå°±æ²¡æœ‰åŒºåˆ«äº†ã€‚ åœ¨JVMæ‰§è¡Œæ—¶ï¼Œé‡åˆ°å¼•ç”¨éœ€è¦å…ˆè§£å¼•ç”¨æ‰èƒ½è·å–æ•´æ•°å€¼ï¼Œç„¶åå†ç›¸åŠ ï¼Œä¹‹åå°è£…æˆæ•´æ•°å¯¹è±¡å¹¶è¿”å›å¼•ç”¨ï¼Œä¸ç›´æ¥å°†æ•´æ•°è¡¨ç¤ºä¸ºå®ç°è¯­è¨€çš„primitive typeç›¸æ¯”æ•ˆç‡å¤©å·®åœ°åˆ«ã€‚ å› æ­¤ï¼Œä¸ºäº†æ•ˆç‡è€ƒè™‘ï¼Œåˆ™éœ€è¦æŠŠæ•´æ•°ï¼Œæµ®ç‚¹æ•°ç­‰å½’å…¥primitive typeã€‚è¿™æ ·åšå°±åˆäº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼šåœ¨JVMä¸­ï¼Œä¸€ä¸ªå€¼å³å¯èƒ½æ˜¯ç”¨å®ç°è¯­è¨€çš„primitive typeè¡¨ç¤ºï¼Œä¹Ÿå¯èƒ½ç”¨æŒ‡é’ˆè¡¨ç¤ºï¼Œæˆ‘ä»¬å¦‚ä½•å¯¹äºŒè€…è¿›è¡ŒåŒºåˆ†å‘¢ï¼Ÿå¹¸å¥½Javaæ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œåœ¨ç¼–è¯‘ä¹‹åæ¯æ¡æŒ‡ä»¤æ‰€æ“ä½œçš„å€¼çš„ç±»å‹ä¹Ÿæ˜¯ç¡®å®šçš„ã€‚æ¯”å¦‚å½“æ‰§è¡ŒiaddæŒ‡ä»¤æ—¶æ ˆä¸Šå­˜çš„å€¼å°±ä¸€å®šä¸ºä¸¤ä¸ªæ•´æ•°ã€‚ä½†åœ¨åŠ¨æ€è¯­è¨€ä¸­å°±ä¸ä¸€å®šäº†ï¼Œæˆ‘ä»¬å¿…é¡»è¦å…ˆæ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œç„¶åè¿›è¡Œæ“ä½œã€‚æ­¤æ—¶ä¸ºäº†æ ‡æ˜ä¸€ä¸ªå€¼ç©¶ç«Ÿæ˜¯primitive typeè¿˜æ˜¯reference typeï¼Œæˆ‘ä»¬å¿…é¡»æŠŠå€¼çš„é«˜ä½ç•™å‡ºæ¥ä½œä¸ºç±»å‹tagä»¥ç¤ºåŒºåˆ†ã€‚ // åŠ¨æ€è¯­è¨€è™šæ‹Ÿæœºä¸­çš„ä¸€ä¸ªå€¼å¾€å¾€æ˜¯è¿™ä¸ªæ ·å­çš„ struct Value_t { Type type; union { double number; bool boolean; HeapObject* object; } data; }; Generic æ—¢ç„¶æœ‰äº†primitive typeçš„æ•´æ•°ï¼Œä¼¼ä¹å†ä¹Ÿä¸éœ€è¦ä½œä¸ºå¯¹è±¡çš„æ•´æ•°äº†ï¼Ÿçœ‹èµ·æ¥ä¼¼ä¹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯Javaå´ä¾ç„¶æä¾›äº†Integerç±»è¡¨ç¤ºä½œä¸ºå¯¹è±¡çš„æ•´æ•°â€”â€”è¿™ä¸»è¦è¿˜æ˜¯å› ä¸ºä¸ºäº†æ”¯æŒæ³›å‹çš„å­˜åœ¨ã€‚ Javaçš„æ³›å‹æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯æ³›å‹ä¿¡æ¯åªåœ¨ç¼–è¯‘æœŸå¯è§ï¼Œè€Œåœ¨è¿è¡ŒæœŸ(ä¹Ÿå°±æ˜¯JVM)ä¸å¯è§ã€‚æ— è®ºä½ æ˜¯å†™æˆList\u003cString\u003e è¿˜æ˜¯ List\u003cA\u003e ï¼Œå®ƒä»¬åœ¨ç¼–è¯‘åéƒ½ä¼šå˜æˆåŒä¸€ä¸ªListï¼Œè€Œè¿™ä¸ªListå­˜å‚¨çš„æ˜¯Objectå¯¹è±¡ã€‚ // æ³›å‹ç±»ï¼š public class Box\u003cT\u003e { private T t; public void set(T t) { this.t = t; } public T get() { return t; } } // ä¸Šé¢çš„æ³›å‹ç±»åœ¨ç¼–è¯‘æˆå­—èŠ‚ç å public class org/example/Box { private Ljava/lang/Object; t public \u003cinit\u003e()V ... public set(Ljava/lang/Object;)V ... public get()Ljava/lang/Object; ... } å› ä¸ºå®é™…ä¸Šç”¨Objectå­˜å‚¨ï¼Œæ‰€ä»¥æ¯æ¬¡getéƒ½æ˜¯åšäº†ä¸€æ¬¡å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ŒJavaç¼–è¯‘å™¨ä¼šç”ŸæˆCHECKCASTæŒ‡ä»¤æ¥ä¿è¯ç±»å‹è½¬æ¢æ—¶çš„æ­£ç¡®æ€§ã€‚ // javaä»£ç  System.out.println(stringBox.get()); // ç¼–è¯‘åçš„å­—èŠ‚ç  INVOKEVIRTUAL org/example/Box.get ()Ljava/lang/Object; CHECKCAST java/lang/String INVOKEVIRTUAL java/io/PrintStream.println (Ljava/lang/String;)V ä½†æ˜¯å¦‚æœæ³›å‹å·²ç»ç”±ç¼–è¯‘å™¨ä¿è¯æ²¡æœ‰ç±»å‹é”™è¯¯ï¼Œä¸ºä»€ä¹ˆåˆè¦åŠ CHECKCASTæŒ‡ä»¤æ¥è¿è¡Œæ—¶å†æ¬¡æ£€æŸ¥å‘¢ï¼Ÿè€ƒè™‘å¦‚ä¸‹æ³›å‹ç¨‹åºï¼Œåœ¨å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†åœ¨è¿è¡Œæ—¶CHECKCASTä¼šæŠ¥é”™ï¼š public class Main { public static void main(String[] args) { Box stringBox = new Box\u003c\u003e(); stringBox.set(5); foo(stringBox); } public static void foo(Box\u003cString\u003e box) { System.out.println(box.get() + \"123\"); } } //Exception in thread \"main\" java.lang.ClassCastException: class java.lang.Integer cannot be cast to class //java.lang.String (java.lang.Integer and java.lang.String are in module java.base of loader 'bootstrap') // at org.example.Main.foo(Main.java:14) // at org.example.Main.main(Main.java:10) è¿™æ˜¯å› ä¸ºJavaä¸ºäº†è®©æ–°ä»£ç å’Œæ²¡æœ‰æ³›å‹ä¹‹å‰(Java8)çš„ä»£ç å…¼å®¹ï¼Œè€Œå¼•å…¥äº†Raw Typeï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ³›å‹å‚æ•°çš„æ³›å‹â€”â€”å¯¹è¿™ç§ç±»å‹çš„æ£€æŸ¥ä¼šé€‚å½“æ”¾æ¾â€”â€”ä»£ä»·å°±æ˜¯åŠ¨æ€æ£€æŸ¥çš„å¼€é”€ã€‚ å½“ç„¶æ³›å‹ä¸ä»…ä»…å¯ä»¥é€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼ŒåƒC++çš„æ¨¡æ¿å°±æ˜¯èµ°å‘äº†å¦å¤–ä¸€ä¸ªæç«¯â€”â€”ä¸ºæ¯ä¸ªç±»å‹éƒ½ç”Ÿæˆç›¸åº”çš„ç±»â€”â€”è¿™æ ·çš„ç¼ºç‚¹è‡ªç„¶æ˜¯ä»£ç è†¨èƒ€ï¼Œå¥½å¤„å´æ˜¯å¯ä»¥åŠ¨æ€è·å–ç±»å‹ä¿¡æ¯(C++æ˜¯å¦æ”¯æŒåå°„æš‚ä¸”ä¸è®ºï¼Œä½†å¦‚æœJavaé‡‡å–å’ŒC++ä¸€æ ·æ³›å‹æœºåˆ¶å°±ä¸€å®šä¼šæ”¯æŒè¿™æ ·çš„åå°„çš„)ï¼Œä¸éœ€è¦åŠ¨æ€ç±»å‹æ£€æŸ¥ï¼Œä¹Ÿä¸éœ€è¦åƒJavaä¸€æ ·çš„Integerç±»ã€‚ å¥½ï¼Œè¯é¢˜åˆå›åˆ°Javaçš„Integerç±»ï¼Œæ­£æ˜¯åº”ä¸ºJavaçš„æ³›å‹æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ³›å‹åœ¨èƒŒåéƒ½æœ‰ä¸€å¥—ç»Ÿä¸€çš„è¡¨ç¤ºâ€”â€”ä¹Ÿå°±æ˜¯Objectã€‚ä½†æ˜¯primitive typeå´åœ¨Java OOç»§æ‰¿é“¾ä¹‹å¤–ï¼Œä¹Ÿå°±æ— æ³•ä½¿ç”¨æ³›å‹äº†â€”â€”æ‰€æœ‰å°±å¼•å…¥äº†å°†primitive typeå°è£…æˆwrapper typeçš„æœºåˆ¶ã€‚å°†intå°è£…ä¸ºIntegerå³æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ Autoboxing and Integer Cache è™½ç„¶å·²ç»æœ‰äº†wrapper typeï¼Œä½†æ¯æ¬¡æ‰‹åŠ¨å°è£…ä¹Ÿæ˜¯éå¸¸éº»çƒ¦çš„ã€‚æ‰€ä»¥ç¼–è¯‘å°±åŠ å…¥äº†è‡ªåŠ¨æ£€æµ‹ç±»å‹ï¼Œåœ¨åˆé€‚çš„æ—¶å€™å°†primitive typeè½¬åŒ–ä¸ºç›¸åº”çš„wrapper typeï¼Œå°†wrapper typeè½¬åŒ–ä¸ºç›¸åº”çš„primitive typeçš„æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯â€œAutoboxingâ€ä¸â€œUnboxingâ€ æ‰€ä»¥è¯´ï¼Œé¢è¯•é¢˜ä¸­Integer i = 100;ç­‰å³é‡‡ç”¨äº†Autoboxing æœºåˆ¶ï¼Œä¸Šé¢çš„ä»£ç åœ¨ç¼–è¯‘å¤„ç†è¿‡ä¹‹åå°±ç­‰ä»·ä¸ºä¸‹é¢çš„ä»£ç ï¼š Integer i = Integer.valueOf(100); Integer j = Integer.valueOf(100); System.out.print(i == j); // true or false? å·²çŸ¥å¼•ç”¨æ¯”è¾ƒåœ¨javaä¸­æ˜¯ç›´æ¥æ¯”è¾ƒåœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦çŸ¥é“Integer.valueOfåšäº†ä»€ä¹ˆå°±çŸ¥é“é¢è¯•é¢˜çš„ç­”æ¡ˆäº†ã€‚ æŸ¥é˜… java docï¼Œå‘ç°: public static Integer valueOf(int i) Returns an Integer instance representing the specified int value. If a new Integer instanc","date":"2023-03-07","objectID":"/posts/autoboxing-and-integercache-in-java/:0:0","tags":["Java","Interview","Knowledge"],"title":"Autoboxing and IntegerCache in Java","uri":"/posts/autoboxing-and-integercache-in-java/"},{"categories":["System"],"content":" Surely all this is not without meaning. â€”â€” HERMAN MELVILLE, Moby-Dick, 1851 è™½ç„¶é¢˜ç›®èµ·å¾—å¾ˆå¤§ï¼Œä½†æ˜¯å†…å®¹ä¹Ÿåªæ¶‰åŠäº†ç¼–è¯‘å™¨å®ç°çš„ä¸€å°éƒ¨åˆ†ï¼Œä¸»è¦è¿˜æ˜¯ä¸€äº›è‡ªå·±å¯¹ç¼–è¯‘å™¨high levelçš„è®¤è¯†ï¼ŒåŠ ä¸Šéƒ¨åˆ†cs143å®éªŒçš„æ€»ç»“ã€‚ ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨ ä¸€ä¸ªç¼–ç¨‹è¯­è¨€å¯ä»¥çœ‹ä½œä¸€ä¸ªä»å®ƒçš„åˆæ³•ç¨‹åºé›†åˆåˆ°è¿è¡Œæ—¶è¡Œä¸ºçš„total functionï¼Œè®¾ä¸ºfã€‚æˆ‘ä»¬ç¼–ç¨‹åˆ™æ˜¯å·²çŸ¥è¿è¡Œæ—¶è¡Œä¸ºbï¼Œæ±‚è§£å‡ºä¸€ä¸ªåˆæ³•ç¨‹åºaä»¥ä½¿å¾—f(a)=bçš„è¿‡ç¨‹ã€‚å‡½æ•°fä¸€èˆ¬éƒ½ä¸ºå¯è®¡ç®—å‡½æ•°ï¼Œä¸”få¯¹åº”çš„è®¡ç®—è§„åˆ™ä¹Ÿæ˜¯æ¯”è¾ƒç‰¹æ®Šä»¥ä½¿å¾—æˆ‘ä»¬ä¹Ÿè¾ƒæ˜“æŒæ¡çš„ï¼Œå…·ä½“è€Œè¨€ï¼Œå°±æ˜¯å¯ä»¥é‡‡ç”¨æ¨¡å—åŒ–ï¼Œåˆ†è€Œæ²»ä¹‹è¿™æ ·çš„æ€æƒ³æ¥æ„é€ å‡ºaï¼Œè¿™ç§è®¡ç®—è§„åˆ™å¸¸å¸¸è¡¨ç°ä¸ºå®šä¹‰åœ¨ASTä¸Šçš„æ±‚å€¼è§„åˆ™(å¦‚opretional semantic)ã€‚ ç¡®å®šåˆæ³•ç¨‹åºçš„é›†åˆçš„è§„åˆ™ä¸€èˆ¬è¢«ç§°ä¸º syntax è€Œtotal function f ä¸€èˆ¬è¢«ç§°ä¸º semantics æœ‰ä¸€éƒ¨åˆ†çš„ç¼–ç¨‹è¯­è¨€uè¢«ç§°ä¸ºunsafeçš„ï¼Œå› ä¸ºcodom(u)å¾€å¾€å«æœ‰ä¸€äº›æˆ‘ä»¬â€”â€”ç¼–ç¨‹äººå‘˜è§‰å¾—ä¸å¥½çš„è¡Œä¸ºã€‚æ¯”å¦‚è¯¥è¡Œä¸ºå–å†³äºç›®æ ‡ä»£ç æ‰€è¿è¡Œçš„æœºå™¨ï¼Œæˆ–æ˜¯äº§ç”Ÿè¯¥è¡Œä¸ºçš„è®¡ç®—è§„åˆ™ååˆ†ç‰¹æ®Š(æ¯”å¦‚è¯´æ•°ç»„è¶Šç•Œä¸æŠ¥é”™è€Œæ˜¯è¿”å›42)ã€‚è€Œç›¸åº”çš„ï¼Œcodom(u)å‡æ˜¯å¥½çš„è¡Œä¸ºçš„ç¼–ç¨‹è¯­è¨€æˆ‘ä»¬ç§°ä¸ºsafeçš„ç¼–ç¨‹è¯­è¨€ã€‚safeè¯­è¨€çš„ä¾‹å­æœ‰javaï¼Œè€Œcåˆ™æ˜¯ä¸€ä¸ªunsafeçš„è¯­è¨€ã€‚ä¸è¿‡åœ¨å®é™…ç¼–å†™ä»£ç ï¼Œå°¤å…¶æ˜¯ç³»ç»Ÿè½¯ä»¶ä¸­ï¼Œå°±ç®—æ˜¯safeçš„è¯­è¨€ä¹Ÿå¾€å¾€ä¼šè¿›è¡Œä¸€äº›æ‰©å±•ï¼Œä»¥å…è®¸ç¼–å†™ä¸€äº›ä¸å…·ä½“æœºå™¨æœ‰å…³çš„unsafeæ“ä½œã€‚ å½“ç„¶ç¼–ç¨‹è¯­è¨€ä»…ä»…å®šä¹‰ä¸ºtotal functionè¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œè¦æƒ³è®©ç¼–ç¨‹è¯­è¨€ä¸ä»…ä»…æ˜¯æˆ‘ä»¬è„‘æµ·ä¸­çš„æ–¹ç¨‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®©æœºå™¨å»è¿è¡Œå®ƒã€‚ä½†æœºå™¨æœ‰ç€è‡ªå·±çš„è¯­è¨€ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠç¼–ç¨‹è¯­è¨€ç¿»è¯‘ä¸ºæœºå™¨è¯­è¨€æ‰å¯ä»¥è®©æœºå™¨å»è¿è¡Œã€‚æˆ‘ä»¬æŠŠæœºå™¨çš„è¯­è¨€ç§°ä¸ºç›®æ ‡è¯­è¨€ï¼Œå…¶ä¸€æ®µç¨‹åºç§°ä¸ºç›®æ ‡ä»£ç ï¼Œè€Œæˆ‘ä»¬çš„ç¼–ç¨‹è¯­è¨€ç§°ä¸ºæºè¯­è¨€ï¼Œå…¶ä¸€æ®µç¨‹åºç§°ä¸ºæºä»£ç ã€‚ç”±äºç›®æ ‡ä»£ç æ˜¯å¯ä»¥è¢«æœºå™¨è¿è¡Œå¹¶è¡¨ç°å‡ºè¿è¡Œæ—¶è¡Œä¸ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªç¼–ç¨‹è¯­è¨€fçš„å€¼åŸŸçœ‹ä½œæ˜¯ç›®æ ‡ä»£ç çš„é›†åˆã€‚fåœ¨è®¡ç®—æœºä¸Šçš„å®ç°å°±ç§°ä½œç¼–è¯‘å™¨ã€‚ ä½†æ˜¯ç”±äºåˆæ³•ç¨‹åºåªæ˜¯æ‰€æœ‰å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­é›†ï¼Œè€Œæˆ‘ä»¬å¯ä»¥ç»™ç¼–è¯‘å™¨è¾“å…¥ä»»ä½•å­—ç¬¦ä¸²ï¼Œå› æ­¤ç¼–è¯‘å™¨å¿…é¡»è¿˜æœ‰é”™è¯¯ç¨‹åºæ£€æµ‹çš„åŠŸèƒ½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç¼–è¯‘å™¨çš„ä¸€èˆ¬éƒ½ä¼šæœ‰ä¸¤é¡¹åŠŸèƒ½ï¼Œå…¶ä¸€æ˜¯ä»£ç å½¢å¼çš„è½¬æ¢ï¼Œå…¶äºŒæ˜¯æ‹’ç»é”™è¯¯çš„ç¨‹åºã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠç¼–è¯‘å™¨çœ‹ä½œä»æºä»£ç åˆ°ç›®æ ‡ä»£ç çš„partial functionã€‚ ç¼–è¯‘å™¨çš„ç»“æ„ ç¼–è¯‘å™¨å¯ä»¥è¢«åˆ†ä¸ºå‡ ä¸ªç›¸äº’ç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œåˆ†åˆ«å®ç°ï¼Œç„¶åç”¨ç®¡é“ç»„åˆèµ·æ¥ã€‚CS143ä¸­coolçš„å®ç°ä¹Ÿæ˜¯å¦‚æ­¤ï¼šè¯¥å®éªŒçš„æœ€åä½ ä¼šè·å¾—lexerï¼Œparserï¼Œsemantï¼Œcgenå››ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹shellè„šæœ¬ç»„åˆèµ·æ¥å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„ç¼–è¯‘å™¨./lexer $* | ./parser $* | ./semant $* | ./cgen $*ã€‚å…¶ä¸­ lexerï¼Œparser å¯¹åº”çš„æ˜¯è¯­æ³•åˆ†æé˜¶æ®µï¼Œsemantå¯¹åº”çš„æ˜¯è¯­ä¹‰åˆ†æé˜¶æ®µï¼Œè€Œcgenå¯¹åº”çš„æ˜¯ä»£ç ç”Ÿæˆé˜¶æ®µã€‚ é™¤cgen/ä»£ç ç”Ÿæˆä¹‹å¤–æ¯ä¸ªéƒ¨åˆ†/é˜¶æ®µéƒ½æœ‰ä¸¤é¡¹ä»»åŠ¡ï¼Œä¸€æ˜¯æ£€æŸ¥å¹¶æ‹’ç»é”™è¯¯çš„ç¨‹åºï¼ŒäºŒæ˜¯è¿›è¡Œä»£ç å½¢å¼çš„è½¬æ¢ã€‚è€Œcgenåªæœ‰è¿›è¡Œä»£ç å½¢å¼çš„è½¬æ¢ä¸€ä¸ªä»»åŠ¡ï¼Œå› ä¸ºåœ¨coolä»¥åŠå¤§éƒ¨åˆ†ç¼–è¯‘å™¨çš„è®¾è®¡ä¸­ï¼Œä»£ç ç”Ÿæˆé˜¶æ®µéƒ½å‡å®šè¾“å…¥å·²ç»æ˜¯åˆæ³•çš„ç¨‹åºã€‚ æ¯ä¸€é˜¶æ®µçš„å·¥ä½œå¯ä»¥çœ‹ä½œä¸€ä¸ªæ•°å­¦å‡½æ•°f(X-\u003eY)ï¼Œå®šä¹‰åŸŸXä¸ºè¯¥é˜¶æ®µèƒ½å¤„ç†çš„è¾“å…¥,Yä¸ºå¯èƒ½çš„è¾“å‡ºçš„é›†åˆã€‚å‡å¦‚lexerï¼Œparserï¼Œsemantï¼Œcgenéƒ½çœ‹ä½œæ•°å­¦å‡½æ•°ï¼Œåˆ™compiler = cgen âˆ˜ semant âˆ˜ parser âˆ˜ lexerã€‚å…·ä½“æ¥è¯´ï¼Œ dom(lexer) = {æ–‡æœ¬ç¨‹åº} codom(lexer) = {tokenæµ} dom(parser) = {tokenæµ} codom(lexer) = {è¯­æ³•æ ‘} dom(semant) = {è¯­æ³•æ ‘} codom(lexer) = {è£…é¥°åçš„è¯­æ³•æ ‘(ä¸»è¦æŒ‡æ·»åŠ ç±»å‹ä¿¡æ¯)} dom(lexer) = {è£…é¥°åçš„è¯­æ³•æ ‘} codom(lexer) = {ç›®æ ‡ä»£ç } ä½†æ˜¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„å‡½æ•°éƒ½æ˜¯ **partial functionï¼Œ**å³å¹¶éæ¯ä¸ªå®šä¹‰åŸŸçš„å€¼éƒ½æœ‰é™ªåŸŸçš„å€¼ä¸ä¹‹å¯¹åº”ï¼Œè¿™äº›å€¼å°±ä»£è¡¨è¿™ç¼–è¯‘è¿‡ç¨‹çš„å‘ç°çš„é”™è¯¯ç¨‹åºï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™å¹¶æç¤ºç”¨æˆ·ä¿®æ”¹ã€‚ ä¹‹æ‰€ä»¥ä¸€ä¸ªcompilerè¦è¢«æ‹†åˆ†ä¸ºå‡ ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œæ˜¯å› ä¸ºè¿™äº›éƒ¨åˆ†çš„åŠŸèƒ½éƒ½ç›¸å½“å†…èšï¼Œäº’ç›¸ä¹‹é—´è”ç³»è¾ƒå°‘ã€‚ä»é”™è¯¯å¤„ç†çš„è§’åº¦æ¥çœ‹ï¼Œlexeræ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼æ’é™¤é”™è¯¯ç¨‹åºï¼Œè€Œparseræ˜¯ç”¨CFGæ’é™¤é”™è¯¯ç¨‹åºï¼Œsemantåšçš„äº‹æƒ…åˆ™æ¯”è¾ƒå¤æ‚ï¼Œé‡‡ç”¨äº†å¤šç§æŠ€æœ¯æ¥æ’é™¤æ‰é”™è¯¯ç¨‹åºï¼Œå¹¶è¾“å‡ºåˆæ³•ç¨‹åºã€‚ æˆ‘ä»¬åˆå¸¸å¸¸è¯´ ç”± lexer å’Œ parser å®šä¹‰äº†è¯­æ³•è§„åˆ™ï¼Œé€šè¿‡lexerå’Œparseræ£€æŸ¥çš„æ˜¯æ»¡è¶³è¯­æ³•è§„åˆ™çš„ç¨‹åºï¼Œè¿™ä¸ªé˜¶æ®µæ‰€ä»¥è¢«ç§°ä¸ºè¯­æ³•åˆ†æé˜¶æ®µ semantå®šä¹‰äº†é™æ€è¯­ä¹‰è§„åˆ™ï¼Œé€šè¿‡semantæ£€æŸ¥çš„æ˜¯æ»¡è¶³é™æ€è¯­ä¹‰è§„åˆ™çš„ç¨‹åºï¼Œè¿™ä¸ªé˜¶æ®µæ‰€ä»¥è¢«ç§°ä¸ºè¯­ä¹‰åˆ†æé˜¶æ®µã€‚ è¯­ä¹‰åˆ†æé˜¶æ®µçš„ä»»åŠ¡ å› æ­¤ï¼Œsemantåšçš„äº‹è¢«ç§°ä¸ºè¯­ä¹‰åˆ†æï¼Œå®ƒä¼šåšè®¸å¤šæ£€æŸ¥ï¼šæ¯”å¦‚è¯´æ£€æŸ¥æ ‡è¯†ç¬¦å¿…é¡»å…ˆå£°æ˜å†ä½¿ç”¨ï¼Œç±»ç»§æ‰¿å›¾å¿…é¡»æ— ç¯ä¹‹ç±»çš„ã€‚ä½†æ˜¯è¯­ä¹‰åˆ†æé˜¶æ®µåšçš„æœ€é‡è¦çš„ä¸€ä»¶äº‹åˆ™æ˜¯ç±»å‹æ£€æŸ¥ï¼Œå…¶ç›®çš„æ˜¯æ£€æŸ¥ç¨‹åºæ»¡è¶³type rulesï¼Œè€Œtype ruleå³æ˜¯type systemçš„ä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚ä¸è¿‡ç±»å‹æ£€æŸ¥ä¹Ÿä¸å¿…éå¾—åœ¨è¯­ä¹‰åˆ†æé˜¶æ®µåšï¼Œæœ‰çš„è¯­è¨€ä¹Ÿå°†ç±»å‹æ£€æŸ¥çº³å…¥è¿è¡Œæ—¶ï¼Œå…·ä½“ç±»å‹ç³»ç»Ÿåšäº†ä»€ä¹ˆæ ·çš„æ£€æŸ¥ï¼Œè¿™è¿˜å¾—è¦ä»ç¼–ç¨‹è¯­è¨€çš„æ±‚å€¼è§„åˆ™è¯´èµ·ã€‚ ç¼–ç¨‹è¯­è¨€å†™æˆçš„ç¨‹åºè™½ç„¶æ˜¯å­—ç¬¦ä¸²ï¼Œä½†è¿™ä¸ªå­—ç¬¦ä¸²å´å®é™…ä¸Šè¡¨ç¤ºäº†ä¸€ç§æ ‘å‹ç»“æ„ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ ‘å‹ç»“æ„å«åšå¯¹åº”å­—ç¬¦ä¸²çš„è¯­æ³•æ ‘ã€‚ä¸ºä»€ä¹ˆè¦ç”¨æ ‘å‹ç»“æ„ï¼Ÿå› ä¸ºæ ‘å‹ç»“æ„çš„è¡¨è¾¾èƒ½åŠ›è¶³å¤Ÿå¼ºï¼Œä¹Ÿæ˜¯æ˜“äºç†è§£çš„ã€‚æˆ‘ä»¬æ‰€èƒ½æ„å»ºçš„å¤§éƒ¨åˆ†å¤æ‚äº‹ç‰©å¾€å¾€éƒ½åªé‡‡ç”¨äº†ç»„åˆå’ŒæŠ½è±¡ä¸¤ç§æ‰‹æ®µã€‚ç»„åˆå³æ˜¯å°†åŸºæœ¬çš„äº‹ç‰©æ”¾åœ¨ä¸€èµ·ï¼Œè€ŒæŠ½è±¡æŒ‡å°†è®¸å¤šäº‹ç‰©å¿½ç•¥å…¶ç»†èŠ‚ï¼Œåªå…³æ³¨å…¶æ•´ä½“ä½œç”¨ã€‚å¦‚åœ¨Schemeä¸­ï¼ŒåŸºæœ¬çš„å…ƒç´ å°±æ˜¯æ•´æ•°å­—é¢é‡ï¼Œè€Œç»„åˆçš„æ–¹æ³•åˆ™æœ‰+, -, *, /ç­‰è¿ç®—ï¼Œè€ŒæŠ½è±¡åˆ™æ˜¯å‡½æ•°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œè¯­æ³•åˆ†æé˜¶æ®µåªè´Ÿè´£ä¿è¯ç¨‹åºç¡®å®è¡¨è¾¾äº†ä¸€ä¸ªæ ‘å‹ç»“æ„å³å¯ å‰©ä¸‹çš„æ£€æŸ¥éƒ½æ˜¯è¯­ä¹‰åˆ†æçš„ä»»åŠ¡äº† ä½†å¹¶éä»»æ„ç§ç±»å…ƒç´ éƒ½èƒ½ç»„åˆï¼ŒæŠ½è±¡ï¼Œä¸€ç§è¿ç®—å¯èƒ½åªèƒ½ç»„åˆæŸç§ç‰¹å®šç±»å‹çš„å…ƒç´ ï¼Œæ¯”å¦‚è¯´ 1 + 2 å°±æ˜¯å¯¹çš„ï¼Œä½†æ˜¯ 1 + \"2\"å°±æ˜¯ä¸å¯¹çš„(ä¸å¯¹æŒ‡åœ¨ç¨‹åºå‘˜çœ‹æ¥ï¼Œè¿™æ˜¯æ— æ„ä¹‰çš„ã€‚å‡å¦‚ç¨‹åºå‘˜çœŸçš„å†™å‡ºäº†è¿™æ ·çš„ç¨‹åºï¼Œåˆ™ä»–ä¼šå¸Œæœ›ç¼–è¯‘æœŸæˆ–æ˜¯è¿è¡Œæ—¶æŠ¥é”™ï¼Œè€Œéä¸€å£°ä¸å­æ‰§è¡Œä¸‹å»å¾—åˆ°ä¸€ä¸ªå¥‡æ€ªçš„ç»“æœ)ã€‚æˆ‘ä»¬å¯ä»¥ç»™è¯­æ³•æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½èµ‹äºˆä¸€ä¸ªç±»å‹ï¼Œå¹¶å®šä¹‰ç±»å‹æ¨å¯¼çš„è§„åˆ™ï¼Œè¿™äº›æ¨å¯¼è§„åˆ™çš„é›†åˆå°±å«åšè¯¥è¯­è¨€çš„ç±»å‹ç³»ç»Ÿã€‚ ä¸Šé¢è¯´çš„æ£€æŸ¥è¿‡ç¨‹å°±å«åšç±»å‹æ£€æŸ¥ï¼Œæ£€æŸ¥ç¨‹åºæ˜¯å¦æ»¡è¶³ç±»å‹ç³»ç»Ÿçš„è§„åˆ™ï¼Œæ˜¯è¯­ä¹‰åˆ†æä¸­æœ€ä¸ºé‡è¦çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚åœ¨ç¨‹åºå‘˜çœ¼ä¸­ï¼Œç±»å‹æ£€æŸ¥å¦‚æœé™æ€èƒ½åšè‡ªç„¶å¥½ï¼Œä½†æ˜¯åŠ¨æ€æŠ¥é”™ä¹Ÿæ˜¯æ— å¦¨çš„â€”â€”åªè¦ä¸ä¸€å£°ä¸å­åœ°æ‰§è¡Œå°±ç®—æ˜¯å¥½çš„è¡Œä¸ºï¼ŒåŠ¨æ€ç±»å‹æ£€æŸ¥çš„è¯­è¨€ä¹Ÿå¯ä»¥æ˜¯safeçš„ã€‚è™½ç„¶åŠ¨æ€è¿›è¡Œæ£€æŸ¥ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œæ—¶é”™è¯¯å¢å¤šï¼Œä½†æ˜¯å´å¢åŠ äº†è®¸å¤šçµæ´»æ€§ã€‚ ä¸€èˆ¬åœ¨ç¼–è¯‘å™¨è¯­ä¹‰åˆ†æè¿‡ç¨‹ä¸­è¿›è¡Œç±»å‹æ£€æŸ¥çš„è¯­è¨€ç§°ä¸ºé™æ€è¯­è¨€ï¼Œè€ŒåŠ¨æ€ç±»å‹æ£€æŸ¥çš„è¯­è¨€ç§°ä¸ºåŠ¨æ€è¯­è¨€ã€‚ å¦å¤–æˆ‘ä»¬å¸¸å¸¸ä¼šç”¨åˆ°å¼ºç±»å‹è¯­è¨€ä¸å¼±ç±»å‹è¯­è¨€ä¸¤ä¸ªè¯ï¼Œè¿™ä¸¤è¯çš„å«ä¹‰å¹¶æœªæ˜ç¡®å®šä¹‰ï¼Œè€Œæ˜¯ä¾èµ–äºè¯­å¢ƒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªè¯­è¨€ä¸ä¼šå› ç±»å‹é”™è¯¯è€Œäº§ç”Ÿunsafeè¡Œä¸ºï¼Œåˆ™ç§°ä¸ºå¼ºç±»å‹è¯­è¨€ï¼Œåä¹‹åˆ™ç§°ä¸ºå¼±ç±»å‹è¯­è¨€ã€‚ ä»£ç ç”Ÿæˆé˜¶æ®µçš„ä»»åŠ¡ é€šè¿‡è¯­ä¹‰æ£€æŸ¥çš„ç¨‹åºéƒ½æ˜¯åˆæ³•çš„ç¨‹åºï¼Œä¸‹ä¸€æ­¥å°±åº”è¯¥å°†åˆæ³•çš„ç¨‹åºè½¬åŒ–ä¸ºç›®æ ‡ä»£ç äº†ã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œlexerï¼Œparserä»¥åŠsemantä¸­ä¹Ÿéƒ½è¿›è¡Œäº†ä»£ç å½¢å¼çš„è½¬æ¢ï¼Œå°†ç¨‹åºä»£ç ä»å­—ç¬¦æµè½¬åŒ–ä¸ºäº†è¯­æ³•æ ‘(å¯èƒ½è¿˜ä¼´éšç€ç¬¦å·è¡¨çš„å¡«å……)ã€‚å’Œé”™è¯¯å¤„ç†ä¸€æ ·ï¼Œlexerä¹Ÿæ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥è®²å­—ç¬¦ä¸²è¯†åˆ«ä¸ºä¸€ä¸ªä¸ªtokenï¼Œparserä¹Ÿæ˜¯é€šè¿‡CFGä»tokenæµä¸­æ„å»ºè¯­æ³•æ ‘ã€‚è€Œsemantåªæ˜¯éå†å·²å»ºå¥½çš„è¯­æ³•æ ‘å¹¶æ”¶é›†ä¿¡æ¯ã€‚lexerå’Œparseråˆç§°ä¸ºè¯­æ³•åˆ†æï¼Œåœ¨è®¸å¤šç¼–è¯‘å™¨å®ç°ä¸­ä¸¤ä¸ªé˜¶æ®µæ˜¯ç´§å¯†è€¦åˆåœ¨ä¸€èµ·çš„ï¼ŒAntlrï¼ŒPestç­‰è¯­æ³•åˆ†æå·¥å…·ä¹Ÿæ˜¯åŒæ—¶åšäº†lexerå’Œparserçš„äº‹æƒ…ï¼Œä½ åªéœ€è¦å‘è¿™äº›å·¥å…·ä¸­è¾“å…¥è¯­è¨€è¯­æ³•çš„specificationï¼Œè¿™äº›å·¥å…·å°±ä¼šè‡ªåŠ¨ç”Ÿæˆå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºè¯­æ³•æ ‘çš„ä»£ç ã€‚è¿™äº›è¯­æ³•åˆ†æå·¥å…·èƒŒåçš„ç†è®ºåˆ™æ¶‰åŠå½¢å¼è¯­è¨€ä¸è‡ªåŠ¨æœºï¼Œå¯ä»¥è¯´æ˜¯è®¡ç®—æœºç†è®ºåœ¨å®é™…è½¯ä»¶ç¼–å†™ä¸­éå¸¸æˆåŠŸçš„åº”ç”¨äº†ã€‚ ä¸è¯­æ³•åˆ†æé˜¶æ®µï¼Œä»£ç ç”Ÿæˆé˜¶æ®µå¾€å¾€æ²¡æœ‰å¦‚æ­¤è‡ªåŠ¨åŒ–çš„å·¥å…·æˆ–æ˜¯æ™®éæ€§çš„ç†è®ºæ”¯æ’‘â€”â€”å½“ç„¶è¯­è¨€çš„è¯­ä¹‰æ˜¯æœ‰operational semantics,denotational semantics ç­‰å½¢å¼åŒ–æ–¹æ³•å®šä¹‰çš„ï¼Œä½†æ˜¯å°±ç®—æ˜¯ç”¨æœ€è´´è¿‘å®ç°çš„operational semantics æ¥æŒ‡å¯¼å®ç°ï¼Œæˆ‘ä»¬æ‰€å¾—åˆ°çš„ä¹Ÿåªèƒ½æ˜¯ä¸€ä¸ªæ•ˆç‡ä½ä¸‹çš„è§£é‡Šå™¨ã€‚å› ä¸ºè¿™äº›å½¢å¼åŒ–çš„è¯­ä¹‰å®šä¹‰å¾€å¾€æ˜¯ç›´æ¥åœ¨ASTä¸Šå®šä¹‰ï¼Œä»¥ASTå±‚é¢çš„æ¦‚å¿µä¸ºç¨‹åºçŠ¶æ€ï¼Œè€Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯å°†ASTç›´æ¥æ˜ å°„åˆ°ä¸€ç§ä½çº§è¯­è¨€ï¼Œè¿™å¾€å¾€æ˜¯éœ€è¦ç¨‹åºå‘˜è‡ªå·±å»æ€è€ƒå¦‚ä½•å®ç°çš„ã€‚ å°†é«˜çº§è¯­è¨€çš„è®¸å¤šæ¦‚å¿µï¼Œå¦‚ç±»ï¼Œå¯¹è±¡çš„åˆ›å»ºï¼Œæ§åˆ¶æµç­‰æ˜ å°„åˆ°ä½çº§è¯­è¨€çš„è¿‡ç¨‹åœ¨æˆ‘çœ‹æ¥æ˜¯ä¸€ä»¶éå¸¸ç¥å¥‡çš„äº‹æƒ…ã€‚åœ¨ä¹‹å‰æˆ‘ä¹Ÿæ›¾å­¦è¿‡æ±‡ç¼–è¯­è¨€ï¼Œå­¦è¿‡ä¸€äº›é«˜çº§è¯­è¨€ï¼Œä½†äºŒè€…ä¹‹é—´å¦‚ä½•è¿›è¡Œè½¬æ¢ç¡®å®åœ¨æˆ‘å­¦ä¹ ç¼–è¯‘åŸç†ä¹‹å‰ä¸‡ä¸‡æ²¡æœ‰æƒ³åˆ°çš„ã€‚ä¸‹é¢å°±æ‹¿coolä¸¾ä¸ªä¾‹å­ï¼š class A { method1() : SELF_TYPE { // 1 self }; method2() : SELF_TYPE { // 2 self }; }; class B inherits A { method1() : SELF_TYPE { // 3 self }; method3() : SELF_TYPE { // 4 self }; }; /////////////////////// 5 le","date":"2023-03-06","objectID":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E7%BB%93%E6%9E%84%E4%B8%8E%E4%BB%BB%E5%8A%A1/:0:0","tags":["Compiler","Knowledge"],"title":"ç¼–è¯‘å™¨çš„ç»“æ„ä¸ä»»åŠ¡","uri":"/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E7%BB%93%E6%9E%84%E4%B8%8E%E4%BB%BB%E5%8A%A1/"},{"categories":["System"],"content":" You are my creator, but I am your master; Obey! â€”â€” Mary Shelley, Frankenstein å¯¼è¨€ æ“ä½œç³»ç»Ÿå¤§ä½“æ¥è¯´å³æ˜¯â€œç®¡ç†è½¯/ç¡¬ä»¶èµ„æºï¼Œä¸ºç¨‹åºææœåŠ¡â€çš„ç¨‹åºã€‚æˆ‘ä»¬ä¸€æ–¹é¢å¯ä»¥ä»åº”ç”¨çš„è§†è§’æŠŠæ“ä½œç³»ç»Ÿå½“ä½œæœåŠ¡çš„æä¾›è€…ï¼Œå»å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„APIï¼Œå¦‚POSIXæˆ–æ˜¯windows apiï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥æ·±å…¥å…¶å†…éƒ¨å»å­¦ä¹ å®ƒçš„å®ç°ã€‚æ“ä½œç³»ç»Ÿçš„å®ç°ç´§å¯†å›´ç»•ç€ç®¡ç†èµ„æºä¸æä¾›æœåŠ¡ä¸¤é¡¹ä»»åŠ¡å±•å¼€ï¼Œè€Œå¯¹ç¡¬ä»¶èµ„æºçš„ç®¡ç†æ˜¯å®ç°ä¸­æœ€ä¸ºâ€œdirtyâ€çš„ä¸€éƒ¨åˆ†ã€‚ä¸ºäº†èƒ½å±è”½è¿™äº›çç¢çš„ç¡¬ä»¶ç»†èŠ‚ï¼Œè®©æˆ‘ä»¬æŠŠç²¾åŠ›é›†ä¸­åœ¨æ“ä½œç³»ç»Ÿä¸­å„ä¸ªå¯¹è±¡çš„äº¤äº’ä¸Šå»ï¼Œjyyé€šè¿‡AMæä¾›äº†ä¸€ç»„APIï¼ŒæŠ½è±¡å‡ºäº†ç¡¬ä»¶æä¾›çš„æœåŠ¡ï¼Œä»è€ŒæŠŠOSçœŸæ­£å˜æˆäº†ä¸€ä¸ªæ™®é€šçš„Cç¨‹åºã€‚ å¯æ˜¯å±è”½å¤ªå¤šçš„ç»†èŠ‚ä¹Ÿä¼šè®©äººæ„Ÿåˆ°ä¸å®‰ä¸å¿ƒè™šâ€”â€”å†…å­˜çš„åœ°å€ç©ºé—´åˆ°åº•æ˜¯æ€æ ·è¢«å†³å®šçš„ï¼Ÿé¡µè¡¨ç©¶ç«Ÿæ˜¯æ€æ ·å®ç°çš„ï¼Ÿå„ä¸ªå¤„ç†å™¨ä¸Šæ‰§è¡Œæµåˆšåˆšå¼€å§‹æ—¶çš„æ ˆåˆæ˜¯è°å†³å®šçš„ï¼Ÿå½“ç„¶ï¼ŒOSä½œä¸ºICSçš„åç»§è¯¾ç¨‹ï¼Œæ˜¯é»˜è®¤æˆ‘ä»¬å¯¹äºè®¡ç®—æœºä½“ç³»ç»“æ„æœ‰ä¸€å®šäº†è§£çš„ï¼Œä¸Šè¿°é—®é¢˜åœ¨ICSçš„PAå®éªŒä¸­ä¹Ÿéƒ½æœ‰ç­”æ¡ˆâ€”â€”ç†è®ºä¸Šåœ¨PAä¸­æˆ‘ä»¬åº”è¯¥å·²ç»è‡ªå·±å®ç°äº†ä»ç¡¬ä»¶æ¨¡æ‹Ÿå™¨åˆ°AMå†åˆ°ç®€æ˜“æ“ä½œç³»ç»Ÿçš„æ‰€æœ‰å†…å®¹ï¼Œå¯¹äºOSå’Œç¡¬ä»¶å¦‚ä½•äº¤äº’åº”è¯¥å†ç†Ÿæ‚‰ä¸è¿‡äº†â€”â€”ä½†æ˜¯ï¼Œå¯¹äºæˆ‘è¿™ä¸ªåœ¨PAåæœŸå…¨ç¨‹æ‘†çƒ‚çš„äººæ¥è¯´ï¼Œè¿™äº›é—®é¢˜å§‹ç»ˆæ˜¯æ¨¡æ¨¡ç³Šç³Šä¸çŸ¥æ‰€äº‘çš„ã€‚â€œæ¬ ä¸‹çš„å€ºç»ˆç©¶æ˜¯è¦è¿˜çš„â€ï¼Œæ‰€ä»¥æˆ‘çš„OSå°±stuckä½äº†ï¼Œæ‰€ä»¥æˆ‘æ‰ä¼šåœ¨è¿™é‡Œä»xv6å’Œriscvå…¥æ‰‹çœ‹çœ‹OSæ˜¯ç©¶ç«Ÿå¦‚ä½•åœ¨ç¡¬ä»¶ä¸Šè¿è¡Œèµ·æ¥çš„ã€‚ qemu vitr OSç»ˆç©¶æ˜¯è¦è¿è¡Œåœ¨ç¡¬ä»¶ä¸Šçš„ï¼Œè€Œqemuæä¾›äº†å¯¹ç¡¬ä»¶çš„æ¨¡æ‹Ÿã€‚ç”±äºæˆ‘é€‰å–çš„æ˜¯riscv64ç‰ˆæœ¬çš„xv6ï¼Œå› æ­¤è¿è¡Œxv6çš„qemuå¿…é¡»æ¨¡æ‹ŸåŸºäºriscv64æ¶æ„çš„æœºå™¨ã€‚ å¯ä»¥çœ‹åˆ°qemuæä¾›äº†å¯¹äºå¤šç§æœºå™¨çš„æ¨¡æ‹Ÿï¼Œå…¶ä¸­xv6æ‰€ä½¿ç”¨çš„æ˜¯virtï¼Œqemu-virtæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„æœºå™¨ï¼Œè¯¥æœºå™¨æ˜¯ä»¿ç…§çœŸå®ä¸–ç•Œä¸­çš„ SiFive FU540-C000 å¼€å‘çš„ã€‚ å…ˆä¸ç®¡å„ç§è®¾å¤‡ä¸è¯¥æœºå™¨çš„å…·ä½“ç»“æ„ï¼Œå¯¹äºä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¥è¯´æˆ‘ä»¬æœ€å…³å¿ƒçš„æ˜¯cpu resetåçš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å†…å­˜ç©ºé—´çš„åˆ†é…ä¸å„ä¸ªå¯„å­˜å™¨çš„å€¼ã€‚SiFive FU540-C000 Manualçš„ç¬¬äº”ç« å°±ä»‹ç»äº†memory mapã€‚å½“ç„¶ï¼Œå¦‚æœè§‰å¾—manualå¤ªè¿‡éš¾è¯»ï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡qemu monitoräº²çœ¼çœ‹çœ‹æœºå™¨çš„çŠ¶æ€ä¹Ÿæ˜¯ä¸€ç§é€‰æ‹©ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨qemuä¸­ä½¿ç”¨-SÂ é€‰é¡¹ä»¤qemuåœ¨åˆå§‹åŒ–å®Œæˆ (CPU Reset) åæš‚åœ æˆ‘ä»¬è¿è¡Œqemuæ—¶ä½¿ç”¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š # å„ä¸ªé€‰é¡¹æ„ä¹‰å¯RTFM https://www.qemu.org/docs/master/system/riscv/virt.html qemu-system-riscv64 -machine virt -bios none -kernel kernel/kernel # é€šè¿‡-kernel é€‰é¡¹ç›´æ¥æŠŠå¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ç©ºé—´ä¸­ -m 128M # åˆ†é…128M RAM -smp 1 -nographic -monitor telnet:127.0.0.1:55555,server,nowait -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0 -S -gdb tcp::26003 ä¹‹åè¿›å…¥qemu monitorä¸­æŸ¥çœ‹memory mapå’Œå¯„å­˜å™¨çŠ¶æ€ã€‚ å¯ä»¥å‘ç°ï¼Œåœ¨CPU resetåï¼Œé™¤pcå€¼ä¸º0x1000å¤–ï¼Œå…¶ä½™å¯„å­˜å™¨å€¼å‡ä¸º0x0ã€‚è€Œåœ¨ç¬¬ä¸€å¼ å›¾ä¸­å¯ä»¥å‘ç°å†…å­˜çš„0x1000 åˆ° 0x11fffé€šè¿‡mmioæ˜ å°„åˆ°äº†romä¸­ï¼Œ é€šè¿‡gdbæ£€æŸ¥å†…å­˜å¯ä»¥å‘ç°ï¼Œromä¸­å­˜å‚¨äº†ä»¥ä¸Šå‡ æ¡æŒ‡ä»¤ã€‚ é€šè¿‡è¿™å‡ æ¡æŒ‡ä»¤ï¼Œpcå°†è·³è½¬åˆ°0x80000000å¤„å¼€å§‹æ‰§è¡Œï¼Œè€Œä»memory mapä¸­ä¹Ÿå¯ä»¥å¾—çŸ¥0x80000000æ˜¯æˆ‘ä»¬ä¸ºvirtåˆ†é…çš„ 128M å†…å­˜çš„å¼€å§‹ï¼Œæˆ‘ä»¬æ‰€å†™OSçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä¹Ÿä½äºè¿™ä¸ªä½ç½®ã€‚ kernelçš„é“¾æ¥ ä¸Šä¸€èŠ‚è¯´åˆ°ï¼Œæˆ‘ä»¬çš„OSçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä½äº0x80000000å¤„ï¼Œè€Œkernelæ˜¯è¢«å½“ä½œå¯æ‰§è¡Œæ–‡ä»¶é€šè¿‡-kernelé€‰é¡¹ç›´æ¥åŠ è½½è¿›åœ°å€ç©ºé—´çš„ã€‚ é€šè¿‡readelfå‘½ä»¤æŸ¥çœ‹kernelçš„ä¿¡æ¯å¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°åˆ°ï¼ŒåŠ è½½ä½ç½®çš„ç¡®æ˜¯å†™åœ¨elfæ–‡ä»¶ä¸­çš„ï¼Œqemuä¹Ÿç¡®å®å¿ å®åœ°æŒ‰ç…§elfçš„è¯´æ˜åŠ è½½äº†å¯æ‰§è¡Œæ–‡ä»¶kernelã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆkernelä¼šå­˜å‚¨è¿™æ ·çš„ä¿¡æ¯å‘¢ï¼Ÿæ˜¯è°å†³å®šEntry Pointçš„ä½ç½®ï¼Œæ˜¯è°å†³å®šçš„VirtAddrä¸Sizeå‘¢ï¼Ÿè¿™äº›éƒ½æ˜¯é€šè¿‡ -T kernel/kernel.ldä¸ºé“¾æ¥å™¨æŒ‡å®šçš„linkScriptç¡®å®šã€‚ ï¼ˆå¦å¤–ï¼Œé»˜è®¤çš„linkScriptå¯ä»¥é€šè¿‡ld --verboseæŸ¥çœ‹ï¼‰ // kernel/kernel.ld OUTPUT_ARCH( \"riscv\" ) ENTRY( _entry ) SECTIONS { /* * ensure that entry.S / _entry is at 0x80000000, * where qemu's -kernel jumps. */ . = 0x80000000; .text : { *(.text .text.*) . = ALIGN(0x1000); _trampoline = .; *(trampsec) . = ALIGN(0x1000); ASSERT(. - _trampoline == 0x1000, \"error: trampoline larger than one page\"); PROVIDE(etext = .); } .rodata : { . = ALIGN(16); *(.srodata .srodata.*) /* do not need to distinguish this from .rodata */ . = ALIGN(16); *(.rodata .rodata.*) } .data : { . = ALIGN(16); *(.sdata .sdata.*) /* do not need to distinguish this from .data */ . = ALIGN(16); *(.data .data.*) } .bss : { . = ALIGN(16); *(.sbss .sbss.*) /* do not need to distinguish this from .bss */ . = ALIGN(16); *(.bss .bss.*) } PROVIDE(end = .); } riscvç‰¹æƒæ¨¡å¼ åœ¨æˆ‘ä»¬å¤§ä½“æ˜ç™½ç¨‹åºæ˜¯å¦‚ä½•è¢«ç¼–è¯‘é“¾æ¥ä»¥åŠè¢«åŠ è½½åˆ°å†…å­˜ä¸­ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å»ä¸€è¡Œè¡Œè¯»ä»£ç äº†ã€‚ä½†åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜å¾—è¦æ¸…æ¥šæ‰€è°“å¯¹äºç¡¬ä»¶çš„æ§åˆ¶æœ€ç»ˆæ˜¯è¦é€šè¿‡æœºå™¨ä»£ç æ¥å®ç°çš„ï¼Œç”±äºæ±‡ç¼–ä»£ç å’Œæœºå™¨ä»£ç æœ‰ç€è‰¯å¥½çš„å¯¹åº”å…³ç³»ï¼Œä¸ºäº†ç²¾å‡†åœ°æ§åˆ¶ç¡¬ä»¶æˆ‘ä»¬ä¸å¾—ä¸ç”¨åˆ°ä¸€äº›æ±‡ç¼–ä»£ç ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬å¯¹äºriscvæ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚ riscvçš„è§„èŒƒè¯¦è§(Volume I,Â Volume II)ï¼Œå…¶ä¸­å·ä¸€å®šä¹‰äº†å®ç°é€šç”¨è®¡ç®—çš„ä¸€äº›æŒ‡ä»¤å’Œå¯„å­˜å™¨ï¼Œè€Œå·äºŒåˆ™å®šä¹‰äº†ä¸€äº›ç‰¹æƒæŒ‡ä»¤å’ŒCSRå¯„å­˜å™¨(Control and Status Registers)ã€‚é€šç”¨æŒ‡ä»¤ä¸éœ€å¤šè¯´ï¼Œæ— éæ˜¯å†…å­˜è®¿é—®ä¸è®¡ç®—ä¹‹ç±»ã€‚è€Œç‰¹æƒæŒ‡ä»¤å’ŒCSRå¯„å­˜å™¨åˆ™æ—¢æ˜¯å®ç°OSæ‰€å¿…é¡»çš„ï¼Œåˆæ˜¯æˆ‘æ‰€ä¸ç†Ÿæ‚‰çš„ã€‚ riscvå®šä¹‰äº†ä¸‰ç§ç‰¹æƒæ¨¡å¼ â€”â€” user modeï¼Œsupervisor modeï¼Œä»¥åŠmachine modeã€‚åœ¨ä¸‰ç§ä¸åŒçš„ç‰¹æƒæ¨¡å¼ä¸‹è¿è¡Œçš„ä»£ç ä¹Ÿå¯¹ç¡¬ä»¶æœ‰ç€ä¸åŒçš„æ§åˆ¶æƒé™ï¼Œæ›´é«˜ä¸€çº§çš„çº§åˆ«èƒ½è¿›è¡Œä½çº§åˆ«çš„æ‰€æœ‰æ“ä½œï¼Œåä¹‹ä¸è¡Œã€‚æˆ‘ä»¬çš„ç”¨æˆ·ç¨‹åºä¸€èˆ¬è¿è¡Œåœ¨user modeä¸­ï¼Œè€ŒOSå†…æ ¸ä¸€èˆ¬è¿è¡Œåœ¨supervisor modeä¸­ï¼Œmachine modeæ˜¯CPU resetä¹‹åçš„æ¨¡å¼ï¼Œä»…ç”¨æ¥åšä¸€äº›åˆå§‹åŒ–é…ç½®ã€‚ï¼ˆéƒ¨åˆ†åµŒå…¥å¼çš„riscvå®ç°å¯èƒ½åªæ”¯æŒmachine modeï¼Œæˆ–è€…åªæ”¯æŒmachine modeå’Œuser modeï¼Œä½†ç°ä»£åŒ–çš„æ“ä½œç³»ç»Ÿä¸€èˆ¬éƒ½éœ€è¦supervisor modeçš„æ”¯æŒï¼‰ riscvå®šä¹‰äº†ä¸€ç»„CSRå¯„å­˜å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹CSRå¯„å­˜å™¨çš„è¯»å†™æ¥æ§åˆ¶æœºå™¨çš„çŠ¶æ€ã€‚æ¯ç§ç‰¹æƒæ¨¡å¼ä¸‹éƒ½æœ‰è‡ªå·±å¯¹åº”çš„ä¸€ç»„å¯„å­˜å™¨ã€‚ç”±äºå¯„å­˜å™¨æ•°ç›®è¾ƒå¤šï¼Œä¹Ÿå¹¶ä¸éœ€è¦å…¨éƒ¨ç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»é˜…è¯»xv6ä»£ç å¼€å§‹ï¼Œé‡åˆ°æ²¡æœ‰è§è¿‡çš„å¯„å­˜å™¨å°±å»æŸ¥é˜…æ‰‹å†Œï¼ŒæŒ‰éœ€å­¦ä¹ ã€‚ åˆå§‹åŒ– # qemu -kernel loads the kernel at 0x80000000 # and causes each CPU to jump there. # kernel.ld causes the following code to # be placed at 0x80000000. .section .text .global _entry _entry: # set up a stack for C. # stack0 is declared in start.c, # with a 4096-byte stack per CPU. # sp = stack0 + (hartid * 4096) la sp, stack0 li a0, 1024*4 csrr a1, mhartid addi a1, a1, 1 mul a0, a0, a1 add sp, sp, a0 # jump to start() in start.c call start spin: j spin xv6æ‰§è¡Œçš„ç¬¬ä¸€æ®µä»£ç ä½äºentry.s ï¼Œæ­¤æ—¶è¿˜å¤„äºmachine modeã€‚å…¶ä¸­mhartidå¯„å­˜å™¨","date":"2022-08-11","objectID":"/posts/%E6%8E%A2%E7%A9%B6%E6%94%AF%E6%92%91os%E7%9A%84%E7%A1%AC%E4%BB%B6%E4%BB%A5xv6%E5%92%8Criscv%E4%B8%BA%E4%BE%8B/:0:0","tags":["OS","Reflection","Knowledge"],"title":"æ¢ç©¶æ”¯æ’‘osçš„ç¡¬ä»¶(ä»¥xv6å’Œriscvä¸ºä¾‹)","uri":"/posts/%E6%8E%A2%E7%A9%B6%E6%94%AF%E6%92%91os%E7%9A%84%E7%A1%AC%E4%BB%B6%E4%BB%A5xv6%E5%92%8Criscv%E4%B8%BA%E4%BE%8B/"},{"categories":["Algorithm"],"content":" å‡¡æ²»ä¼—å¦‚æ²»å¯¡ï¼Œåˆ†æ•°æ˜¯ä¹Ÿï¼›æ–—ä¼—å¦‚æ–—å¯¡ï¼Œå½¢åæ˜¯ä¹Ÿã€‚ æœ¬ç¯‡åšå®¢å†…å®¹å¤§å¤šéƒ½æ¥è‡ªJeffçš„ç®—æ³•ä¹¦ç±ï¼Œå› ä¹¦ç±å†…å®¹å……å®å’Œæœ‰è¶£ï¼Œè¯»ä¹‹ååˆæ€•å¿˜è®°ï¼Œå› æ­¤æ‘˜æŠ„å¤è¿°è‡ªå·±æ„Ÿè§‰æœ‰è¶£å†…å®¹ï¼Œå¹¶é€‚æ—¶åŠ ä»¥æ‰©å±•ã€‚ Intro åœ¨ç®—æœ¯ä¸­ï¼Œä¹˜æ³•æ˜¯æœ€åŸºæœ¬çš„è¿ç®—ã€‚æ•°å­¦å¾€å¾€åªå…³å¿ƒæŠ½è±¡çš„ä¸€èˆ¬çš„ä¸œè¥¿ï¼Œå®ƒåªæŠŠæ•°å­—çœ‹ä½œæ•°å­—æœ¬èº«ï¼ŒåªæŠŠä¹˜æ³•çœ‹ä½œä¸ºä¸€ç§å®šä¹‰åœ¨æ•°ä¸Šçš„æ»¡è¶³æŸç§ç‰¹å®šæ€§è´¨çš„è¿ç®—ï¼Œä½†æ˜¯ä¸ºäº†è®©æ•°å­—èƒ½çœŸæ­£ä¸ºæˆ‘ä»¬æ‰€ç”¨ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å®šä¹‰æ•°å­—å®é™…ä¸Šçš„è¡¨ç¤ºæ–¹æ³•ï¼Œä»¥åŠåœ¨ä¸€ç§è¡¨ç¤ºæ–¹æ³•ä¸‹å¯¹æ•°å­—è¿›è¡Œè¿ç®—çš„æ–¹æ³•(æ¯”å¦‚ä¹˜æ³•)â€”â€”æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œä»»æ„ç»™å®šä¸¤ä¸ªæ•°ï¼Œæˆ‘ä»¬éƒ½èƒ½å¾—å‡ºå…¶è¿ç®—ç»“æœ(ä¹˜ç§¯)ã€‚è¿™æ ·ä¸€ç§ç¡®å®šæ€§çš„æ–¹æ³•å°±å¯ä»¥ç§°ä½œä¸€ç§ç®—æ³•ã€‚ é€šä¿—æ„ä¹‰ä¸Šçš„ç®—æ³•å³æ˜¯æŒ‡ä¸€ç³»åˆ—æ˜æ™°ç¡®å®šçš„æŒ‡ä»¤(æ­¥éª¤)çš„åºåˆ—ï¼Œå®ƒæè¿°äº†ä¸€ä¸ªé—®é¢˜çš„å¯è¡Œè§£å†³æ–¹æ¡ˆã€‚æ³¨æ„åˆ°ç»„æˆç®—æ³•çš„æ˜¯ä¸€ç³»åˆ—æ˜æ™°ç¡®å®šçš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬æŠŠè¿™äº›æŒ‡ä»¤å«åšåŸå­æŒ‡ä»¤ï¼Œæ‰€è°“åŸå­å°±æ˜¯æŒ‡è¿™äº›æŒ‡ä»¤æ˜¯æœ€ç®€å•çš„ï¼Œä¸å¯å†åˆ†çš„æŒ‡ä»¤äº†ã€‚å¦‚æœè¦ä½¿ç®—æ³•æ˜¯çœŸæ­£å¯è¡Œçš„ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»ç¡®ä¿åŸå­æŒ‡ä»¤æ˜¯å¯è¡Œçš„ã€‚å¦‚æœæœ‰ä¸€ä¸ªç®—æ³•ï¼Œæè¿°äº†å¦‚ä½•æˆä¸ºå¯Œç¿ã€‚è€Œè¿™ä¸ªç®—æ³•çš„ä¸€ä¸ªåŸå­æŒ‡ä»¤æ˜¯â€œå…ˆå®šä¸€ä¸ªå°ç›®æ ‡ï¼Œæˆ‘å…ˆæŒ£å®ƒä¸€ä¸ªäº¿ï¼â€ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•å¯¹äºæˆ‘æ¥è¯´æ˜¯æ˜¾ç„¶æ˜¯ä¸å¯è¡Œçš„äº†ğŸ˜‚ã€‚ é¦–å…ˆï¼Œå¦‚æœæ•°çš„è¡¨ç¤ºæ–¹æ³•ä¸ºåè¿›åˆ¶æ•´æ•°ï¼Œè€Œä¸ªä½æ•°ç›¸ä¹˜æˆ–è€…ç›¸åŠ éƒ½ä¸ºåŸå­æŒ‡ä»¤çš„è¯ï¼Œç«–å¼è®¡ç®—æ³•å½“ç„¶å°±æ˜¯ä¸€ç§æœ€å¥½ä¸è¿‡çš„ç®—æ³•äº†ã€‚ å…¶æ¬¡ï¼Œå¦‚æœæŠŠæ•°å­—å®šä½ä¸ºçº¿æ®µçš„é•¿åº¦ï¼ŒåŸå­æŒ‡ä»¤å®šä¸ºåŸºæœ¬çš„å°ºè§„ä½œå›¾æ­¥éª¤çš„è¯ï¼Œä¸€ç§ä¹˜æ³•çš„ç®—æ³•å°±æ˜¯å¦‚ä¸‹è¿™æ ·ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æœ‰ä¸€äº›è¯„ä»·è¿™äº›ç®—æ³•çš„æŒ‡æ ‡ä»¥ä¾¿åœ¨è§£å†³åŒä¸€é—®é¢˜çš„ä¸åŒç®—æ³•é—´å–èˆã€‚æœ€é‡è¦çš„æŒ‡æ ‡å½“ç„¶æ˜¯ç®—æ³•æ­£ç¡®æ€§äº†ï¼Œå¦å¤–ï¼Œç®—æ³•æ‰§è¡Œçš„å¿«æ…¢ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æŒ‡æ ‡ï¼Œå®ƒå¯ä»¥ç”¨ä¸€ä¸ªç®—æ³•ä»å¼€å§‹åˆ°ç»“æŸæ‰€æ‰§è¡Œçš„åŸå­æŒ‡ä»¤æ¡æ•°æ¥è¡¡é‡ã€‚ç”±äºè®¡ç®—æŒ‡ä»¤æ¡æ•°çš„ç²¾ç¡®æ•°ç›®è¾ƒä¸ºç¹çä¸”æ„ä¹‰ä¸å¤§ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿå°±éšä¹‹è€Œå‡ºäº†ã€‚ åœ¨è®¡ç®—nä½æ•°Ã—nä½æ•°æ—¶ï¼Œåœ¨ä½¿ç”¨åè¿›åˆ¶æ•°å­—è¡¨ç¤ºå’Œç«–å¼ç®—æ³•æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ•°çš„æ¯ä¸€ä¸ªæ•°å­—éƒ½è¦å’Œç¬¬äºŒä¸ªæ•°çš„æ¯ä¸€ä¸ªæ•°å­—ç›¸ä¹˜ï¼›ä½¿ç”¨å‡ ä½•æ¨¡å‹å’Œä¸Šå›¾æ‰€è¿°ç®—æ³•æ—¶ï¼Œç”±äºåªéœ€è¦æœ‰é™ä¸ªæ­¥éª¤ï¼Œç®—æ³•æ—¶é—´å¤æ‚åº¦å°±æ˜¯$O(1)$äº†ã€‚ è€ƒè™‘åˆ°æ— è®ºæˆ‘ä»¬å®é™…æ—¥å¸¸ä½¿ç”¨è¿˜æ˜¯è®¡ç®—æœºè¡¨ç¤ºï¼Œä½¿ç”¨Xè¿›åˆ¶è¡¨ç¤ºæ³•éƒ½æ˜¯æœ€å¸¸è§çš„ï¼ŒæŠŠä¸ªä½æ•°çš„Ã—å’Œï¼‹éƒ½ä½œä¸ºåŸå­æŒ‡ä»¤ä¹Ÿæ˜¯æœ€è‡ªç„¶çš„ï¼Œæˆ‘ä»¬çš„ç ”ç©¶å¯¹è±¡ä¹Ÿå°±ä¸»è¦é›†ä¸­åœ¨è¿™ç§è®¡ç®—æ¨¡å‹ä¸Šäº†ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè®¡ç®—ä¹˜æ³•çš„ç®—æ³•å¤šç§å¤šæ ·ï¼Œæœ‰æ²¡æœ‰ä¸€ç§ç®—æ³•èƒ½ä»¥ä½äº$O(n^2)$çš„æ—¶é—´å¤æ‚åº¦æ¥è®¡ç®—ä¹˜æ³•å‘¢ï¼Ÿ SplitMultiply åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³åœ¨ç®—æ³•ä¸Šçš„åº”ç”¨å¾€å¾€èƒ½å¾—å¾ˆå¥½çš„æ•ˆæœã€‚æ¯”å¦‚è¯´åˆ©ç”¨äº†åˆ†æ²»æ³•çš„Quick-Sort, Merge-Sortéƒ½èƒ½å¾—åˆ°å¾ˆå¥½çš„æ—¶é—´å¤æ‚åº¦ã€‚ç›¸åº”çš„ï¼Œä¹Ÿè®¸åˆ†æ²»çš„æ€æƒ³ä¹Ÿèƒ½åœ¨ä¹˜æ³•ä¸­èµ·åˆ°ä½œç”¨ã€‚ å¾ˆæ˜¾ç„¶ï¼Œ$(10^ma + b)(10^mc + d) = 10^{2m}ac + 10^m(bc + ad) + bd$ï¼ŒæŒ‰ç…§è¿™ä¸ªåˆ†è§£ï¼Œå°±æœ‰äº†å¦‚ä¸‹çš„åˆ†æ²»ç®—æ³•ï¼š è¿™ä¸ªç®—æ³•çš„æ­£ç¡®æ€§æ˜¾è€Œæ˜“è§ï¼Œä½†æ˜¯è¦è®¡ç®—è¿™æ ·çš„é€’å½’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å°±è¾ƒä¸ºå›°éš¾äº†ã€‚ä¸è¿‡ï¼Œå…¶ç”¨æ—¶çš„é€’æ¨å¼å´å¾ˆå®¹æ˜“å†™å‡ºæ¥ï¼Œå³$T(n)=4T(n/2)+O(n)$ï¼Œè€Œè¦æ ¹æ®è¿™ä¸ªé€’æ¨å¼æ±‚å‡º$T(n)$çš„æ¸è¿›å¼ï¼Œé€’å½’æ ‘æ³•èƒ½ç»™æˆ‘ä»¬å¾ˆå¤šInsightã€‚ å°†å…¨éƒ¨é¡¹æ±‚å’Œï¼Œå¾ˆå®¹æ˜“å¾—å‡ºæ—¶é—´å¤æ‚åº¦ä»»ç„¶ä¸º$O(n^2)$ã€‚ ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆQuick-Sort, Merge-Sortéƒ½å¯ä»¥æˆåŠŸé™ä½å¤æ‚åº¦å‘¢ï¼Ÿè¿™å¯ä»¥ä»äºŒè€…ç”¨æ—¶çš„é€’æ¨å¼ä¸­çœ‹å‡ºäº†:$T(n)=2T(n/2)+O(n)$ã€‚ å†è€ƒè™‘é€’å½’æ ‘ä¸­çš„è€—æ—¶å¤§æ¦‚åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ¯æ¬¡é€’å½’æ—¶çš„è€—æ—¶ï¼Œä¸€éƒ¨åˆ†æ˜¯æ‰€æœ‰å¶èŠ‚ç‚¹å¯¹åº”çš„æœ€å°å­æƒ…å†µçš„è€—æ—¶ã€‚å‡è®¾é€’æ¨å¼ä¸º$T(n)=aT(n/b)+f(n)$ï¼Œä¸å¦¨è®¾å½“$n$ä¸º1æ—¶åˆ°è¾¾å­èŠ‚ç‚¹ï¼Œæ ‘é«˜ä¸ºHï¼Œå¶èŠ‚ç‚¹æ•°ä¸ºLï¼Œåˆ™æœ‰$n/b^H=1 \\implies H=log_bn,L=b^H=a^{log_bn}=n^{log_ba}$,å› æ­¤ï¼Œå¶èŠ‚ç‚¹å¯¹åº”çš„é¡¹çš„ä»£ä»·ä¸ºä¸º$\\Theta(n^{log_ba})$,è€Œå†…éƒ¨èŠ‚ç‚¹å¯¹åº”çš„ä»£ä»·ä¸º$\\Sigma_{j=0}^{log_bn-1}a^jf(n/b^j)$ï¼Œå› æ­¤ï¼Œæ•´ä¸ªé€’å½’è¿‡ç¨‹çš„ç”¨æ—¶å°±ç”±è¿™ä¸¤é¡¹å†³å®šã€‚ç”±è¿™ä¸¤é¡¹çš„ç›¸å¯¹å¤§å°å°±å¯ä»¥å¾—åˆ°æ•´ä¸ªè¿‡ç¨‹çš„æ¸è¿›å¤æ‚åº¦ã€‚åœ¨å¯¹è¿™ä¸¤é¡¹è¿›è¡Œåˆ†æä¹‹åï¼Œå°±å¾—åˆ°äº†ä¸»å®šç†ï¼Œä¹‹åå°±å¯ä»¥ä»¥æ­¤ä¸ºå‡ºå‘ç‚¹åˆ†æç®—æ³•çš„æ—¶é—´å¤æ‚åº¦äº†ã€‚ SplitMultiplyç®—æ³•ç¬¦åˆæƒ…å†µä¸€ï¼Œä¹Ÿå°±æ˜¯ç”±äºSplitMultiplyç®—æ³•çš„é€’å½’è¿‡ç¨‹ä¸­æ¯å±‚èŠ‚ç‚¹æ‰©å±•å¾—å¤ªå¿«ï¼Œå¯¼è‡´å¶èŠ‚ç‚¹å®Œå…¨å æ®äº†ä¸»å¯¼åœ°ä½ï¼Œå› æ­¤å¤æ‚åº¦å®Œå…¨ç”±å¶èŠ‚ç‚¹å†³å®šï¼›è€Œä¸¤ä¸ªåˆ†æ²»çš„æ’åºç®—æ³•éƒ½ç¬¦åˆæƒ…å†µäºŒï¼Œå³æ¯å±‚èŠ‚ç‚¹ä»£ä»·çš„æ€»å’Œå·®ä¸å¤šç›¸åŒï¼Œå› æ­¤æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸º$\\Theta(nlogn)$ã€‚ FastMultiply SplitMultiplyçš„å¤±è´¥ä¹‹å¤„åœ¨äºæ¯å±‚èŠ‚ç‚¹æ‰©å±•å¾—å¤ªå¿«ï¼Œå³$log_ba$å¤ªå¤§ï¼Œå› æ­¤æœ‰æ²¡æœ‰ä¸€ç§é€‚ç”¨äºä¹˜æ³•çš„åˆ†æ²»ç®—æ³•ä½¿å¾—$log_ba$è¾ƒå°å‘¢ï¼Ÿäº‹å®ä¸Šï¼ŒKaratsubaå°±æŠŠaä»4é™åˆ°äº†3ï¼Œä»è€Œä½¿å¾—ä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦ç”±$n^2$é™è‡³$n^{log_23}=n^{1.58496â€¦â€¦}$ã€‚ Karatsubaçš„æƒ³æ³•ä¸»è¦æ¥æºäºä»–å‘ç°ï¼Œä¸Šé¢çš„åˆ†è§£å¼ä¸­$bc+ad$æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå¦‚èƒ½ä¸€æ¬¡å°±æŠŠè¿™ä¸ªæ•´ä½“ç®—å‡ºæ¥ï¼Œå°±èƒ½åªè°ƒç”¨ä¸‰ä¸ªé€’å½’å­è¿‡ç¨‹ã€‚è€ƒè™‘åˆ°$ac+ab-(a-c)(c-d)=bc+ad$ï¼Œæˆ‘ä»¬åªéœ€è¦é¢å¤–è®¡ç®—ä¸€ä¸ª$(a-c)(c-d)$å³å¯è·å¾—ä¸­é—´çš„$bc+ad$çš„å€¼ã€‚ï¼ˆæ³¨æ„åˆ°$a \\times 10^m$çš„å¤æ‚åº¦å®é™…ä¸Šä¸º$O(n)$ï¼‰ å…·ä½“ç®—æ³•å¦‚ä¸‹ï¼š Karatsubaåœ¨å‘ç°è¿™ä¸ªç®—æ³•æ—¶è¿˜æ˜¯ä¸€ä¸ª23å²çš„å­¦ç”Ÿã€‚1950å¹´ä»£ï¼Œè‹è”æ•°å­¦å®¶Kolmogorovä¸¾åŠäº†ä¸€ä¸ªç ”è®¨ä¼šï¼Œæå‡ºâ€œä»»ä½•n*nçš„ä¹˜æ³•ç®—æ³•éƒ½ä¸å¯èƒ½åœ¨$n^2$çš„æ—¶é—´å¤æ‚åº¦ä»¥ä¸‹â€ï¼Œå¯æ˜¯åœ¨ä¸€å‘¨ä¹‹åï¼ŒKaratsubaå°±å‘ç°äº†è¿™ä¸ªç®—æ³•ã€‚ ","date":"2022-03-20","objectID":"/posts/multiplication-part1/:0:0","tags":["Book"],"title":"Multiplication","uri":"/posts/multiplication-part1/"},{"categories":["System"],"content":"int setjmp(jmp_buf env) void longjmp(jmp_buf env, int val) setjmp å’Œ longjmp æ˜¯setjmp.hå®šä¹‰çš„ç›¸äº’åä½œçš„ä¸€ç»„è·³è½¬å‡½æ•°ã€‚ è°ƒç”¨ setjmp æ—¶å¯ä»¥å°†å½“å‰çš„ç¯å¢ƒä¿å­˜åœ¨ä¸€ä¸ªjmp_bufç±»å‹çš„å˜é‡ä¸­ï¼Œä¹‹åè°ƒç”¨ longjmp åä¼šè·³è½¬åˆ° setjmp æ‰§è¡Œåçš„ä¸‹ä¸€æ¡è¯­å¥æ‰§è¡Œï¼Œå°±å¥½åƒåˆšåˆšä» setjmpè¿”å›ä¸€æ ·ã€‚ å‡½æ•°è¡Œä¸ºæè¿°è§manï¼Œæºç è§glibcã€‚ å…¶ä¸­,jmp_bufçš„å®šä¹‰å¦‚ä¸‹: typedef long int __jmp_buf[8]; /* Calling environment, plus possibly a saved signal mask. */ struct __jmp_buf_tag { /* NOTE: The machine-dependent definitions of `__sigsetjmp' assume that a `jmp_buf' begins with a `__jmp_buf' and that `__mask_was_saved' follows it. Do not move these members or add others before it. */ __jmp_buf __jmpbuf; /* Calling environment. */ int __mask_was_saved; /* Saved the signal mask? */ __sigset_t __saved_mask; /* Saved signal mask. */ }; typedef struct __jmp_buf_tag jmp_buf[1]; æœ¬æ¥é¢„æƒ³jmp_bufåº”è¯¥æ˜¯ç®€å•çš„ä¸€ä¸ªå­˜å‚¨å¯„å­˜å™¨ä¿¡æ¯çš„æ•°ç»„ï¼Œå´å‘ç°å…¶å®šä¹‰è¾ƒä¸ºå¤æ‚ã€‚åœ¨é˜…è¯»å…¶å®šä¹‰çš„æ—¶å€™ï¼Œåˆç‰µæ‰¯å‡ºäº†è®¸å¤šä¸ç†Ÿæ‚‰çš„cçŸ¥è¯†ç‚¹ã€‚è¯•è§£æå®šä¹‰å¦‚ä¸‹ï¼š å…¶ä¸­typedef struct __jmp_buf_tag jmp_buf[1]å®šä¹‰äº†ä¸€ä¸ªåä¸ºjmp_bufçš„å˜é‡ç±»å‹,å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¤§å°ä¸º1çš„struct __jmp_buf_tagæ•°ç»„ã€‚è€Œç»“æ„ä½“struct __jmp_buf_tagåŒ…å«ä¸‰ä¸ªæˆå‘˜ï¼Œåä¸¤ä¸ªä¸ä¿¡å·æœºåˆ¶æœ‰å…³ï¼Œä¸åšè®¨è®ºã€‚ç¬¬ä¸€ä¸ªæˆå‘˜ä¸º__jmp_bufç±»å‹ï¼Œç”¨æ¥ä¿å­˜å¯„å­˜å™¨ä¿¡æ¯ã€‚è€Œ__jmp_bufç±»å‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¤§å°ä¸º8çš„long intæ•°ç»„ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¦æŠŠå®é™…ä¸Šå­˜å‚¨ä¿¡æ¯çš„ç»“æ„ä½“__jmp_buf_tagåŒ…å«åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢å‘¢ï¼Ÿä¹Ÿè®¸æ˜¯å› ä¸ºå°†æ•°ç»„å½“ä½œå‚æ•°ä¼ é€’æ—¶æ€»æ˜¯ä¼ é€’æ•°ç»„çš„åœ°å€ï¼Œè€Œå°†ç»“æ„ä½“å½“ä½œå‚æ•°ä¼ é€’æ—¶å´æ€»æ˜¯å°†æ•´ä¸ªç»“æ„ä½“çš„å€¼èµ‹å€¼ä¸€éä¼ ç»™è¢«è°ƒç”¨å‡½æ•°ã€‚æˆ‘ä»¬çš„jmp_bufä½œä¸ºä¸€ä¸ªåœ¨å‡½æ•°è°ƒç”¨é—´ä¿å­˜ä¿¡æ¯çš„å®ä½“åº”è¯¥æ»¡è¶³æ•°ç»„çš„ç‰¹å¾ï¼Œå› æ­¤å°†å…¶å®šä¹‰ä¸ºæ•°ç»„æ›´åˆé€‚ä¸€äº›ã€‚å½“ç„¶ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œæ¯æ¬¡è¢«è°ƒç”¨å‡½æ•°éœ€è¦ç»“æ„ä½“__jmp_buf_tagæ—¶ä¼ å…¥å®ƒçš„æŒ‡é’ˆä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œåªæ˜¯ç•¥æ˜¾éº»çƒ¦ç½¢äº†ã€‚ hint: ç»“æ„ä½“å®šä¹‰äº†ä¸€ç§å˜é‡ç±»å‹ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“å¤åˆ¶å’Œèµ‹å€¼ã€‚åœ¨è¡Œä¸ºä¸Šæ›´åŠ ç±»ä¼¼äºintè€Œéint[]; å˜é‡åæ˜¯ä¸å€¼ç»‘å®šçš„ç¬¦å·ï¼Œè€ŒæŒ‡é’ˆæ˜¯ä¸ä¸€ä¸ªåœ°å€å€¼ç»‘å®šçš„ç¬¦å·ã€‚ ","date":"2021-11-14","objectID":"/posts/%E6%B5%85%E6%9E%90jump-buf%E7%9A%84%E5%AE%9A%E4%B9%89/:0:0","tags":["C","Knowledge"],"title":"æµ…æjmp_bufçš„å®šä¹‰","uri":"/posts/%E6%B5%85%E6%9E%90jump-buf%E7%9A%84%E5%AE%9A%E4%B9%89/"},{"categories":["Algorithm"],"content":"ç”±äºæ ‘æœ¬èº«å®šä¹‰çš„é€’å½’æ€§ï¼Œç½®äºæ ‘ä¸Šçš„æ“ä½œå¾€å¾€ä¹Ÿæ˜¯é€’å½’æ€§çš„çš„ã€‚ åœ¨æŸäº›è¯­è¨€ä¸­ï¼Œé€’å½’æ˜¯è‡ªç„¶çš„ï¼Œæœ€åŸºæœ¬çš„è¯­è¨€è¦ç´ (æ¯”å¦‚è¯´scheme)ï¼Œç„¶è€Œåœ¨å¦å¤–ä¸€äº›è¯­è¨€ä¸­ï¼Œé€’å½’å´ä¸æ˜¯æœ€åŸºæœ¬çš„è¦ç´ ã€‚ å›¾çµä¸˜å¥‡è®ºé¢˜è¯æ˜äº†å›¾çµæœºå’Œlambdaæ¼”ç®—çš„ç­‰ä»·æ€§ï¼Œæ—¢ç„¶çº¯é€’å½’çš„lambdaæ¼”ç®—å’Œç»™äººæ¯«æ— é€’å½’å°è±¡çš„å›¾çµæœºçš„è®¡ç®—èƒ½åŠ›æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆä¸€åˆ‡é€’å½’æ–¹æ³•è‡ªç„¶éƒ½èƒ½ç”¨éé€’å½’æ–¹æ³•æ¨¡æ‹Ÿäº†ã€‚è€ƒè™‘åˆ°ç°å®è®¡ç®—æœºä¸­é€’å½’å‡½æ•°çš„è°ƒç”¨å°±æ˜¯é€šè¿‡æ ˆå®ç°çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•ä¸€é—¨è¯­è¨€ç®€å•åœ°åˆ©ç”¨æ ˆæ¥æ¨¡æ‹Ÿé€’å½’ã€‚å› æ­¤ï¼Œå¯¹äºæ ‘çš„ä»»ä½•é€’å½’æ“ä½œéƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„éé€’å½’æ–¹æ³•äº†(å°½ç®¡è¿™ç§éé€’å½’æ–¹æ³•ä»»ç„¶æ˜¯æ¨¡æ‹Ÿé€’å½’çš„)ã€‚ æ ‘çš„å®šä¹‰ä»¥åŠæ„é€ æ–¹æ³•å¦‚ä¸‹(ç”¨èŠ‚ç‚¹Nodeæ¥è¡¨ç¤ºæ ‘ï¼Œç”¨æ ‘çš„è¡¨è¾¾å¼å­—ç¬¦ä¸²æ¥æ„é€ æ ‘): public class Node\u003cItem\u003e { Item item; Node left; Node right; Node(Item item, Node left, Node right) { this.item = item; this.left = left; this.right = right; } /** * @param tree æ ‘çš„è¡¨è¾¾å¼ * å½¢å¦‚:\"1(5(6(3,2),),5(5,3(1,)))\" * \"1(1(1(1(1,),),),)\" * @return æ ‘çš„å¤´èŠ‚ç‚¹ */ public static Node makeTree(String tree) { if (tree == \"\") return null; if (tree.length() == 1) return new Node(Integer.valueOf(tree), null, null); char[] t = tree.toCharArray(); int item = Integer.valueOf(tree.substring(0, 1)); int mid = 0; int bra = 0; for (int i = 2; i \u003c t.length; i++) { if (t[i] == '(') bra++; else if (t[i] == ')') bra--; else if (t[i] == ',') { if (bra == 0) { mid = i; break; } } } Node left = makeTree(tree.substring(2, mid)); Node right = makeTree(tree.substring(mid + 1, tree.length() - 1)); return new Node(item, left, right); } } å¯¹äºæ ˆä¸­æ¯ä¸€ä¸ªframeçš„æ¨¡æ‹Ÿå¦‚ä¸‹: static class frameSim { int retAddr; Node t; frameSim(int retAddr, Node t) { this.retAddr = retAddr; this.t = t; } } å‰åºï¼Œä¸­åºï¼Œååºçš„é€’å½’ä»¥åŠéé€’å½’éå†æ–¹æ³•å¦‚ä¸‹ï¼š å…¶ä¸­ç”¨switch caseè¯­å¥æ¨¡æ‹Ÿåœ°å€è·³è½¬ã€‚ public static void preOrder(Node t) { if (t == null) { return; } System.out.print(t.item); preOrder(t.left); preOrder(t.right); } public static void preOrderNonRec(Node t) { Stack\u003cframeSim\u003e stack = new Stack\u003c\u003e(); frameSim current = new frameSim(-1, t); int pc = 0; while (true) { switch (pc) { case 0: System.out.print(current.t.item); case 1: if (current.t.left != null) { stack.push(current); current = new frameSim(2, current.t.left); pc = 0; continue; } case 2: if (current.t.right != null) { stack.push(current); current = new frameSim(3, current.t.right); pc = 0; continue; } case 3: } pc = current.retAddr; if (pc == -1) break; current = stack.pop(); } } public static void inOrder(Node t) { if (t == null) { return; } inOrder(t.left); System.out.print(t.item); inOrder(t.right); } public static void inOrderNonRec(Node t) { Stack\u003cframeSim\u003e stack = new Stack\u003c\u003e(); frameSim current = new frameSim(-1, t); int pc = 0; while (true) { switch (pc) { case 0: if (current.t.left != null) { stack.push(current); current = new frameSim(1, current.t.left); pc = 0; continue; } case 1: System.out.print(current.t.item); case 2: if (current.t.right != null) { stack.push(current); current = new frameSim(3, current.t.right); pc = 0; continue; } case 3: } pc = current.retAddr; if (pc == -1) break; current = stack.pop(); } } public static void postOrder(Node t) { if (t == null) { return; } postOrder(t.left); postOrder(t.right); System.out.print(t.item); } public static void postOrderNonRec(Node t) { Stack\u003cframeSim\u003e stack = new Stack\u003c\u003e(); frameSim current = new frameSim(-1, t); int pc = 0; while (true) { switch (pc) { case 0: if (current.t.left != null) { stack.push(current); current = new frameSim(1, current.t.left); pc = 0; continue; } case 1: if (current.t.right != null) { stack.push(current); current = new frameSim(2, current.t.right); pc = 0; continue; } case 2: System.out.print(current.t.item); case 3: } pc = current.retAddr; if (pc == -1) break; current = stack.pop(); } } ","date":"2021-11-09","objectID":"/posts/%E6%A0%91%E7%9A%84%E9%9D%9E%E9%80%92%E5%BD%92%E9%81%8D%E5%8E%86%E7%94%A8%E6%A0%88%E6%A8%A1%E6%8B%9F%E9%80%92%E5%BD%92/:0:0","tags":["Knowledge"],"title":"æ ‘çš„éé€’å½’éå†â€”ç”¨æ ˆæ¨¡æ‹Ÿé€’å½’","uri":"/posts/%E6%A0%91%E7%9A%84%E9%9D%9E%E9%80%92%E5%BD%92%E9%81%8D%E5%8E%86%E7%94%A8%E6%A0%88%E6%A8%A1%E6%8B%9F%E9%80%92%E5%BD%92/"},{"categories":["Backend"],"content":" ä¸‡ç‰©çš†æµï¼Œæ— ç‰©å¸¸é©» å¯¼å¼• ","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:0:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"},{"categories":["Backend"],"content":"è¿‡ç¨‹çš„æŠ½è±¡ æµ(stream)æ˜¯åœ¨java8ä¸­å‡ºç°çš„ä¸€ç§æ–°çš„æ•°æ®æŠ½è±¡ï¼Œå®ƒå¯¹æ•°æ®çš„å¤„ç†æœ‰ç€è¾ƒå¤§çš„ç®€åŒ–ä½œç”¨ã€‚ æµçš„æ¦‚å¿µå¯èƒ½æœ€æ—©æ¥è‡ªäºåˆ—è¡¨(List)ï¼Œåˆ—è¡¨å¯ä»¥ç†è§£ä¸ºæŒ‰é¡ºåºæ’åˆ—çš„ä¸€ç»„å¯¹è±¡(æ•°ç»„å’Œé“¾è¡¨éƒ½æ˜¯å…¶å…·ä½“å®ç°)ã€‚ å¤§å¤šæ•°ç¨‹åºçš„æœ€å¤–åœ¨ç‰¹å¾æ˜¯ç»™å®šä¸€ä¸ªè¾“å…¥åï¼ŒæŒ‰ç…§æŸç§è§„åˆ™å¾—å‡ºç›¸åº”çš„è¾“å‡ºã€‚ç¼–å†™ç”±è¾“å…¥åˆ°è¾“å‡ºçš„è§„åˆ™å°±æ˜¯programmeræ‰€åšçš„äº‹æƒ…äº†ã€‚è®¸å¤šç¨‹åºçš„è§„åˆ™éƒ½å¯ä»¥è¢«æŠ½è±¡ä¸ºä¸‰éƒ¨åˆ†: æ ¹æ®è¾“å…¥äº§ç”Ÿä¸€ç»„æ•°æ® å¯¹ç¬¬ä¸€æ­¥äº§ç”Ÿçš„æ•°æ®ç»„è¿›è¡Œå¤„ç† å¯¹å¤„ç†è¿‡åçš„æ•°æ®çº¦ç®€è€Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡º å½“ç„¶ï¼Œæœ€åçº¦ç®€çš„æ“ä½œä¹Ÿå¯ä»¥ç®—ä½œæ•°æ®å¤„ç†çš„ä¸€éƒ¨åˆ†ã€‚ä½†ç”±äºå®ƒæ˜¯æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥å¾€å¾€å°†å®ƒç‹¬ç«‹å‡ºæ¥ã€‚ è¿™ç§æŠ½è±¡å¯ä»¥ç±»æ¯”ä¸ºå›½å®¶é€‰æ‹”äººæ‰çš„æœºåˆ¶ã€‚ éšç€å½¢å¼çš„å˜åŒ–ï¼Œå›½å®¶å‘å¤§å­¦æå‡ºäº†å‘Héƒ¨é—¨è¾“é€Xä¸“ä¸šçš„é«˜çº§äººæ‰çš„è¦æ±‚ã€‚(è¿™ç›¸å½“äºç”¨æˆ·è¾“å…¥) å¤§å­¦æ‹›æ”¶äº†ä¸€ç¾¤Xä¸“ä¸šçš„æœ¬ç§‘æ–°ç”Ÿã€‚(äº§ç”Ÿäº†ä¸€ç»„æ•°æ®) å¤§å­¦å¯¹è¿™äº›æ–°ç”Ÿè¿›è¡Œä¸“ä¸šæ•™è‚²ï¼Œæ·˜æ±°æ‰æŒ‚ç§‘çš„å­¦ç”Ÿã€‚(å¤„ç†æ•°æ®) æ¯•ä¸šä¹‹æ—¶ï¼Œå°†æˆç»©ä¼˜å¼‚çš„å­¦ç”Ÿæ¨èç»™Héƒ¨é—¨ã€‚(çº¦ç®€å¾—åˆ°è¾“å‡º) ä¹Ÿè®¸æ­£å› ä¸ºè¿™ç§å¯¹è¿‡ç¨‹çš„æŠ½è±¡æ–¹å¼å¤©ç„¶åœ°å­˜åœ¨äºäººçš„å¤§è„‘ç»“æ„ä¹‹ä¸­(æ˜¯æŸç§å…ˆéªŒçš„æ€ç»´æ¨¡å¼)ï¼Œæˆ‘ä»¬æ‰ä¼šå¾ˆè‡ªç„¶åœ°å°†æ— è®ºæ˜¯ç¤¾ä¼šè¿˜æ˜¯è®¡ç®—æœºä¸­çš„è®¸å¤šè¿‡ç¨‹éƒ½æŒ‰ç…§è¿™ç§æ–¹å¼è¿›è¡ŒæŠ½è±¡ã€‚ ","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:1:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"},{"categories":["Backend"],"content":"ä»Liståˆ°Stream ç¨‹åºçš„ä¸‰éƒ¨åˆ†æŠ½è±¡ä¸­æœ‰ä¸¤ä¸ªå…³é”®éƒ¨åˆ†:ä¸€æ˜¯å¦‚ä½•è¡¨ç¤ºæ•°æ®ï¼ŒäºŒæ˜¯å¦‚ä½•å¤„ç†æ•°æ®ã€‚ å¯¹äºæ•°æ®çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæƒ³åˆ°ä½¿ç”¨Listè¿™æ ·çš„è®¡ç®—æœºèƒ½æ”¯æŒçš„æœ€ç®€å•æ•°æ®é›†åˆæ¥è¡¨ç¤ºã€‚ å¯¹äºæ•°æ®çš„å¤„ç†æ–¹å¼ï¼Œæˆ‘ä»¬æŠ½è±¡å‡ºäº†è®¸å¤šç§ç±»ï¼Œæ¯”å¦‚è¯´: map: å¯¹äºListä¸­çš„æ¯ä¸€é¡¹æ•°æ®éƒ½è¿›è¡ŒæŸç§æ“ä½œ filter: åˆ é™¤Listä¸­æŸäº›ä¸éœ€è¦çš„å…ƒç´  count: å¾—åˆ°Listä¸­æ€»çš„å…ƒç´ æ•°ç›® æœ‰äº›å¤„ç†æ–¹å¼(æ¯”å¦‚è¯´count)ï¼Œå¯¹Listæ“ä½œä¹‹åå¾—åˆ°çš„å¹¶ä¸æ˜¯Listï¼Œä¸å†èƒ½è¿ç»­åœ°è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥åªèƒ½ä½œä¸ºæœ€åä¸€æ­¥çº¦ç®€åœ°å¤„ç†æ–¹å¼ã€‚ ç„¶è€Œç”¨ä¸€èˆ¬è®¡ç®—æœºè¯­è¨€ä¸­çš„Listè¡¨ç¤ºæ•°æ®ç»„ï¼Œå´æœ‰ä»¥ä¸‹ä¸¤ç§ç¼ºç‚¹: ä¸€ï¼Œä¸èƒ½è¡¨ç¤ºæ— é™æ•°æ®ç»„ äºŒï¼Œæ¯æ¬¡å¤„ç†éƒ½å¿…é¡»å¯¹æ¯ä¸ªå…ƒç´ éƒ½è¿›è¡Œå¤„ç†ï¼Œé€ æˆäº†èµ„æºçš„æµªè´¹ã€‚(ä½†å®é™…ä¸Šæˆ‘ä»¬çš„ç¨‹åºå¯èƒ½åªéœ€è¦å¤„ç†å‰å‡ ä¸ªæ•°æ®å°±å¯ä»¥å¾—å‡ºç»“æœäº†) å› æ­¤ï¼Œå‡ºç°äº†ä¸€ç§æ–°çš„æ•°æ®æŠ½è±¡ï¼Œæµ(stream)ã€‚æµçš„ä¸»è¦ç‰¹å¾å³æ˜¯æƒ°æ€§æ±‚å€¼ã€‚è€Œæƒ°æ€§æ±‚å€¼å¾ˆå¥½åœ°é¿å…äº†ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ã€‚æ‰€è°“æƒ°æ€§æ±‚å€¼ï¼Œå³éœ€è¦çš„æ—¶å€™å†è¿›è¡Œæ±‚å€¼ã€‚ æ¯”æ–¹è¯´æˆ‘ä»¬çš„æ•°æ®ç»„æ˜¯ä¸€ä¸²5ä¸ªç™½è‰²ä¹’ä¹“çƒã€‚è¦å¯¹è¿™äº›ä¹’ä¹“çƒè¿›è¡Œå¦‚ä¸‹å¤„ç†ï¼Œé¦–å…ˆæ˜¯æŸ“è“è‰²é¢œæ–™ï¼Œå…¶æ¬¡æŸ“é»„è‰²é¢œæ–™ï¼Œæœ€åæˆ‘ä»¬è¦æ‹¿åˆ°ç¬¬äºŒä¸ªæŸ“è‰²åçš„ä¹’ä¹“çƒã€‚æŒ‰ç…§Listçš„å¤„ç†é€»è¾‘ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠæ‰€æœ‰çš„çƒæŸ“æˆè“è‰²ï¼Œç„¶åå°†æ‰€æœ‰çš„çƒæŸ“æˆé»„è‰²ï¼Œæœ€åå†å–å‡ºç¬¬äºŒä¸ªçƒã€‚ä½†æ˜¯æŒ‰ç…§streamçš„å¤„ç†é€»è¾‘ï¼Œæˆ‘ä»¬é¦–å…ˆçŸ¥é“äº†è¦æŠŠçƒ æŸ“æˆè“è‰²ï¼Œä½†æˆ‘ä»¬å…ˆè®°ä½è¿™ä¸ªå‘½ä»¤ï¼Œå´ä¸å®é™…æ“ä½œã€‚ç„¶åè®°ä½è¦æŸ“é»„è‰²çš„å‘½ä»¤ï¼Œä¹Ÿä¸å®é™…æ“ä½œã€‚åœ¨æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬è¦æ‹¿å‡ºç¬¬äºŒä¸ªæŸ“è‰²åçš„çƒã€‚è¿™æ—¶å€™æˆ‘ä»¬å†ä¾æ¬¡å¯¹è¿™äº›çƒè¿›è¡Œå¤„ç†ã€‚å…ˆå¤„ç†å®Œç¬¬ä¸€ä¸ªçƒï¼Œç„¶åå¤„ç†ç¬¬äºŒä¸ªçƒï¼Œè¿™æ—¶ç›´æ¥æ‹¿å‡ºç¬¬äºŒä¸ªçƒå³å¯ï¼Œ è€Œä¸éœ€è¦å¯¹å‰©ä½™çƒè¿›è¡ŒæŸ“è‰²ã€‚ æ­¤å¤„ç¬”è€…è‡ªæ„Ÿè¡¨è¾¾ä¸æ¸…ï¼Œå…³äºstreamçš„è§£é‡Šè¯¦è§SICP3.5ã€‚ ","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:2:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"},{"categories":["Backend"],"content":"stream API ç”±äºstreamçš„å¼ºå¤§æŠ½è±¡èƒ½åŠ›ï¼Œjava8ä¸­æ–°å¼•å…¥äº†stream APIã€‚java8ä¸­çš„streamå³æ˜¯ä¸Šè¿°æ¦‚å¿µæ¨¡å‹çš„ä¸€ç§å®ç°ï¼Œå¹¶æ— ç‰¹æ®Šæ€§ã€‚å…¶ä¸»è¦æ“ä½œè‡ªç„¶ä¹Ÿæ˜¯åˆ†ä¸ºstreamçš„æ„é€ ï¼Œå¤„ç†ä»¥åŠçº¦ç®€ä¸‰éƒ¨åˆ†ã€‚ä¸‹é¢ä¸‰éƒ¨åˆ†å°†åˆ†åˆ«è®°å½•å¸¸ç”¨çš„APIã€‚ æ„é€  ","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:3:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"},{"categories":["Backend"],"content":"ç”±collectionæˆ–Arrayè½¬åŒ– Collection: default Stream\u003cE\u003e stream() Array: public static \u003cT\u003e Stream\u003cT\u003e stream(T[] array) public static \u003cT\u003e Stream\u003cT\u003e stream(T[] array, int startInclusive, int endExclusive) public static IntStream stream(int[] array) public static IntStream stream(int[] array, int startInclusive, int endExclusive) ä»¥åŠç±»ä¼¼çš„DoubleStreamå’ŒLongStreamæ–¹æ³• ","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:4:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"},{"categories":["Backend"],"content":"ç”±Streamç›´æ¥åˆ›å»º Stream: static \u003cT\u003e Stream\u003cT\u003e empty() Returns an empty sequential Stream. static \u003cT\u003e Stream\u003cT\u003e of(T t) Returns a sequential Stream containing a single element. static \u003cT\u003e Stream\u003cT\u003e ofNullable(T t) Returns a sequential Stream containing a single element, if non-null, otherwise returns an empty Stream. @SafeVarargs static \u003cT\u003e Stream\u003cT\u003e of(T... values) Returns a sequential ordered stream whose elements are the specified values. static \u003cT\u003e Stream\u003cT\u003e iterate(T seed, UnaryOperator\u003cT\u003e f) Returns an infinite sequential ordered Stream produced by iterative application of a function f to an initial element seed, producing a Stream consisting of seed, f(seed), f(f(seed)), etc. static \u003cT\u003e Stream\u003cT\u003e generate(Supplier\u003c? extends T\u003e s) Returns an infinite sequential unordered stream where each element is generated by the provided Supplier. This is suitable for generating constant streams, streams of random elements, etc. static \u003cT\u003e Stream\u003cT\u003e concat(Stream\u003c? extends T\u003e a, Stream\u003c? extends T\u003e b) Creates a lazily concatenated stream whose elements are all the elements of the first stream followed by all the elements of the second stream. å¦å¤–ä¹Ÿå¯ä»¥é€šè¿‡streamBuilderç±»åˆ›å»ºstream å¤„ç† Stream: Stream\u003cT\u003e filter(Predicate\u003c? super T\u003e predicate) Returns a stream consisting of the elements of this stream that match the given predicate. This is an intermediate operation. \u003cR\u003e Stream\u003cR\u003e map(Function\u003c? super T,â€‹? extends R\u003e mapper) Returns a stream consisting of the results of applying the given function to the elements of this stream. This is an intermediate operation. Stream\u003cT\u003e limit(long maxSize) Returns a stream consisting of the elements of this stream, truncated to be no longer than maxSize in length. This is a short-circuiting stateful intermediate operation. Stream\u003cT\u003e skip(long n) Returns a stream consisting of the remaining elements of this stream after discarding the first n elements of the stream. If this stream contains fewer than n elements then an empty stream will be returned. This is a stateful intermediate operation. Stream\u003cT\u003e sorted() Returns a stream consisting of the elements of this stream, sorted according to natural order. If the elements of this stream are not Comparable, a java.lang.ClassCastException may be thrown when the terminal operation is executed. For ordered streams, the sort is stable. For unordered streams, no stability guarantees are made. This is a stateful intermediate operation. Stream\u003cT\u003e sorted(Comparator\u003c? super T\u003e comparator) Returns a stream consisting of the elements of this stream, sorted according to the provided Comparator. For ordered streams, the sort is stable. For unordered streams, no stability guarantees are made. This is a stateful intermediate operation. çº¦ç®€ Stream: void forEach(Consumer\u003c? super T\u003e action) Performs an action for each element of this stream. This is a terminal operation. Optional\u003cT\u003e findFirst() Returns an Optional describing the first element of this stream, or an empty Optional if the stream is empty. If the stream has no encounter order, then any element may be returned. This is a short-circuiting terminal operation. Optional\u003cT\u003e max(Comparator\u003c? super T\u003e comparator) Returns the maximum element of this stream according to the provided Comparator. This is a special case of a reduction. This is a terminal operation. Optional\u003cT\u003e min(Comparator\u003c? super T\u003e comparator) Returns the minimum element of this stream according to the provided Comparator. This is a special case of a reduction. This is a terminal operation. T reduce(T identity, BinaryOperator\u003cT\u003e accumulator) Performs a reduction on the elements of this stream, using the provided identity value and an associative accumulation function, and returns the reduced value. This is equivalent to: T result = identity; for (T element : this stream) result = accumulator.apply(result, element) return result; but is not constrained to execute sequentially. The identity value must be an identity for the accumulator function. This means that for all t","date":"2021-08-18","objectID":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/:5:0","tags":["Java","Stream","Knowledge"],"title":"æµ…è°ˆjava8ä¸­çš„æµ","uri":"/posts/%E6%B5%85%E8%B0%88java8%E4%B8%AD%E7%9A%84%E6%B5%81/"}]